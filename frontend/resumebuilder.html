<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0, minimum-scale=0.3">
    <title>Resume Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="icon" href="/assets/img/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#1e40af',
                    }
                }
            }
        }
    </script>

<style>
    :root {
        --primary-color: #2563eb;
        --secondary-color: #1e40af;
        --text-color: #334155;
        --light-gray: #f1f5f9;
        --white: #ffffff;
        --border-color: #e2e8f0;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
        background-color: var(--light-gray);
        color: var(--text-color);
        line-height: 1.6;
    }
    #loader {
        transition: opacity 0.5s ease;
    }


    div.w-\[210mm\] {
        width: 210mm;               
    }
    @media (max-width: 1024px) {
        div.w-\[210mm\] {
            transform: scale(0.4);    
            transform-origin: top left;
        }
    }

   

    .user-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        margin-top: 8px;
        background: var(--white);
        border: 1px solid var(--border-color);
        border-radius: 4px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        min-width: 200px;
        display: none;
    }

    .user-dropdown.active {
        display: block;
    }

    .user-dropdown a {
        display: block;
        padding: 12px 16px;
        color: var(--text-color);
        text-decoration: none;
        transition: background-color 0.3s;
    }

    .user-dropdown a:hover {
        background-color: var(--light-gray);
    }

    .user-dropdown .divider {
        height: 1px;
        background: var(--border-color);
        margin: 8px 0;
    }

    /* Language and Hobby sections styling */
    .language-item, .hobby-item {
        position: relative;
        margin-bottom: 1rem;
    }

    .remove-language-btn, .remove-hobby-btn {
        transition: all 0.2s ease;
    }

    .remove-language-btn:hover, .remove-hobby-btn:hover {
        background-color: #dc2626 !important;
        transform: scale(1.05);
    }

    .add-language-btn, .add-hobby-btn {
        transition: all 0.2s ease;
    }

    .add-language-btn:hover, .add-hobby-btn:hover {
        background-color: #1d4ed8 !important;
        transform: scale(1.02);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .nav-links {
            display: none;
        }

        .user-button span {
            display: none;
        }
    }

    /* Two-Panel Layout */
    .main-container {
        display: flex;
        height: calc(100vh - 70px);
    }

    .left-panel {
        width: 50%;
        overflow-y: auto;
        padding: 2rem;
        background-color: var(--light-gray);
    }

    .right-panel {
        width: 50%;
        background-color: var(--white);
        overflow: auto;
        color: var(--text-color);
        padding: 2rem;
        position: sticky;
        top: 70px;
        height: calc(100vh - 70px);
    }

    /* Preview Toggle Button */
    .preview-toggle {
        display: none;
        position: fixed;
        bottom: 19px;
        left: 60%;
        transform: translateX(-50%);
        background: var(--primary-color);
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        border: none;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        z-index: 1000;
        font-weight: 600;
        /* Prevent text selection and improve touch handling */
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        /* Improve touch handling on mobile */
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
    }

    .preview-toggle:hover {
        background: var(--secondary-color);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .main-container {
            flex-direction: column;
            height: auto;
        }

        .left-panel {
            width: 100%;
            height: auto;
        }

        .right-panel {
            width: 100%;
            height: auto;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 999;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }

        .right-panel.active {
            transform: translateX(0);
        }

        .preview-toggle {
            display: block;
        }

            .preview-toggle.active {
        background: var(--secondary-color);
    }
    
   
    @media (max-width: 768px) {
        .preview-toggle {
            min-height: 44px; 
            min-width: 44px;
            padding: 12px 24px;
            font-size: 16px; 
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
           
            pointer-events: auto;
           
            isolation: isolate;
        }
    }
    }

    /* Section Styling */
    .section-block {
        margin-bottom: 3rem;
    }

    .section-header {
        font-size: 1.5rem;
        margin-bottom: 1rem;
        color: var(--text-color);
    }
    
    .form-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
        margin-top: 1rem;
    }

    .input-group {
        display: flex;
        flex-direction: column;
    }

    .input-group label {
        margin-bottom: 0.5rem;
        font-weight: 500;
        color: var(--text-color);
    }

    .input-group input,
    .input-group textarea {
        padding: 0.75rem 1rem;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        font-size: 1rem;
        width: 100%;
        background-color: var(--white);
    }

    .input-group input:focus,
    .input-group textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
    }

    .input-group textarea {
        resize: vertical;
        font-family: inherit;
        min-height: 100px;
        max-height: 300px;
        overflow-y: auto;
        word-wrap: break-word;
        white-space: pre-wrap;
        line-height: 1.5;
    }

    .full-width {
        grid-column: span 2;
    }

    /* Responsive Form Styles */
    @media (max-width: 768px) {
        .form-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .full-width {
            grid-column: span 1;
        }

        .input-group {
            margin-bottom: 0.5rem;
        }

        .input-group input,
        .input-group textarea {
            font-size: 16px; /* Prevents zoom on iOS */
            padding: 0.875rem 1rem;
        }

        .section-block {
            margin-bottom: 2rem;
            padding: 0 1rem;
        }

        .section-header {
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
        }

        .left-panel {
            padding: 1rem 0;
        }

      
        button, 
        .btn {
            min-height: 44px;
            padding: 0.75rem 1.5rem;
        }

       
        .tech-skills-grid {
            grid-template-columns: 1fr;
        }

     
        .cert-grid {
            grid-template-columns: 1fr;
        }

        /* Make project items more mobile-friendly */
        .project-item {
            margin-bottom: 1rem;
        }

      

       
    }

    /* Small mobile devices */
    @media (max-width: 480px) {
        .section-block {
            padding: 0 0.75rem;
        }

        .input-group input,
        .input-group textarea {
            padding: 0.75rem;
        }

        .section-header {
            font-size: 1.125rem;
        }
    }

    /* Template-specific styles */
    .it-template {
        --tech-skill-bg: #e2e8f0;
        --cert-bg: #f8fafc;
        --project-bg: #ffffff;
    }

    .tech-skills-section {
        background: var(--tech-skill-bg);
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .tech-skills-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
    }

    .skill-category {
        margin-bottom: 1rem;
    }

    .skill-category h4 {
        color: inherit;
        margin-bottom: 0.5rem;
    }

    .certifications-section {
        background: var(--cert-bg);
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }

    .cert-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 1rem;
    }

    .cert-item {
        background: white;
        padding: 1rem;
        border-radius: 6px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }

    .projects-section {
        background: var(--project-bg);
        padding: 1.5rem;
        border-radius: 8px;
        margin-bottom: 2rem;
    }


 
    /* Template content containers */
    .template-content {
        display: none;
    }

    .template-content.active {
        display: block;
    }

    /* IT Template 1 Styles */
    .resume-container {
        max-width: 210mm;
        margin: 0 auto;
        background: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        padding: 2rem;
        font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        color: #1f2937;
        line-height: 1.6;
    }

    .header {
        background: #2563eb;
        color: white;
        padding: 3rem 2rem;
        text-align: center;
        position: relative;
    }

    .header h1 {
        font-size: 2.5rem;
        margin-bottom: 0.5rem;
    }

    .header h2 {
        color: #1e40af;
        font-size: 1.5rem;
        font-weight: 500;
        margin-bottom: 1.5rem;
    }

    .contact-info {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .contact-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: #1f2937;
    }

    .section {
        margin-bottom: 2rem;
    }

    .section-title {
        color: #2563eb;
        font-size: 1.5rem;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #e5e7eb;
    }

    .tech-skills {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .skill-category {
        
        padding: 1rem;
        border-radius: 6px;
    }

    .skill-category h4 {
        color: inherit;
        margin-bottom: 0.5rem;
    }

    .skill-list {
        list-style: none;
    }

    .skill-list li {
        margin-bottom: 0.25rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .skill-list li::before {
        content: "•";
        color: inherit;
    }

    .experience-item {
        margin-bottom: 1.5rem;
    }

    .experience-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
    }

    .experience-title {
        font-weight: 600;
        color: #1e40af;
    }

    .experience-date {
        color: #666;
    }

    .experience-company {
        font-weight: 500;
        margin-bottom: 0.5rem;
    }

    .experience-description {
        margin-left: 1rem;
    }

    .projects {
        display: grid;
        gap: 1.5rem;
    }


    .project-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
    }


    .tech-stack {
        display: flex;
        flex-wrap: wrap;
        gap: 5px;
        
    }


    

    /* Responsive preview styles */
    @media (max-width: 768px) {
        .it-template-1-preview,
        .default-template-preview,
        .resume-container {
            padding: 1rem;
        }

        .it-template-1-preview h1,
        .header h1 {
            font-size: 2rem;
        }

        .it-template-1-preview h2,
        .header h2 {
            font-size: 1.25rem;
        }

        .it-template-1-preview .contact-info,
        .contact-info {
            flex-direction: column;
            gap: 0.5rem;
            align-items: center;
        }

        .default-template-preview .contact-info {
            flex-direction: column;
            gap: 0.5rem;
        }

        .tech-skills {
            grid-template-columns: 1fr;
        }

        .experience-header,
        .project-header {
            flex-direction: column;
            gap: 0.5rem;
        }


        /* Ensure textareas don't overflow on mobile */
        .input-group textarea {
            font-size: 16px; /* Prevents zoom on iOS */
            min-height: 80px;
            max-height: 200px;
        }
    }

    /* Add profile picture styles */
    .profile-upload {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .profile-preview {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        overflow: hidden;
        background: #fff;
        border: 3px solid #2563eb;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .profile-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    .profile-preview .placeholder {
        color: #64748b;
        font-size: 3rem;
    }

    .profile-upload input[type="file"] {
        display: none;
    }

    .profile-upload label {
        background: var(--primary-color);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .profile-upload label:hover {
        background: var(--secondary-color);
    }

    .profile-upload .remove-photo {
        color: #ef4444;
        cursor: pointer;
        font-size: 0.875rem;
        display: none;
    }

    .profile-upload .remove-photo.active {
        display: block;
    }

    /* Update preview styles for profile picture */
    .it-template-1-preview .profile-picture {
        width: 120px;
        height: 120px;
        border-radius: 50%;
        margin: 0 auto 1rem;
        overflow: hidden;
        border: 3px solid #2563eb;
    }

    .it-template-1-preview .profile-picture img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .profile-picture {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        border: 4px solid white;
        margin: 0 auto 1.5rem;
        overflow: hidden;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .profile-picture img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .default-template-preview .profile-picture {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-bottom: 1rem;
        overflow: hidden;
        border: 2px solid #e2e8f0;
    }

    .default-template-preview .profile-picture img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

  
    .ai-enhance-btn {
        position: absolute;
        right: 10px;
        top: 10px;
        background: #4CAF50;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .ai-enhance-btn:hover {
        background: #45a049;
    }

    .ai-enhance-btn.loading {
        background: #666;
        cursor: not-allowed;
    }

    /* Mobile responsive AI assistant button */
    @media (max-width: 768px) {
        .ai-enhance-btn {
            font-size: 10px;
            padding: 4px 8px;
            right: 5px;
            top: 5px;
            gap: 3px;
            white-space: nowrap;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    }

    @media (max-width: 480px) {
        .ai-enhance-btn {
            font-size: 9px;
            padding: 3px 6px;
            right: 3px;
            top: 3px;
            max-width: 100px;
        }
    }

    @media (min-width: 769px) {
  .preview-toggle {
    display: none !important;
  }
}

    .ai-enhance-popup {
        display: none;
        position: absolute;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        width: 300px;
        z-index: 1000;
        right: 0;
        top: 100%;
        margin-top: 5px;
    }

    .regenerate-btn {
        background: #4CAF50;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 12px;
        margin-top: 10px;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 5px;
    }

    .regenerate-btn:hover {
        background: #45a049;
    }

    .regenerate-btn.loading {
        background: #666;
        cursor: not-allowed;
    }

    .ai-suggestion {
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 8px;
        font-size: 14px;
    }

    .ai-suggestion:hover {
        background: #f5f5f5;
        border-color: #4CAF50;
    }

    .ai-suggestion:last-child {
        margin-bottom: 0;
    }

    .ai-loading {
        text-align: center;
        color: #666;
        padding: 10px;
    }

    .ai-loading::after {
        content: '...';
        animation: loading 1.5s infinite;
    }

    @keyframes loading {
        0% { content: '.'; }
        33% { content: '..'; }
        66% { content: '...'; }
    }

    /* Add these styles for the skill badges */
    .skill-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background-color: #e5e7eb;
        color: #374151;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s;
    }

    .skill-badge:hover {
        background-color: #d1d5db;
    }

    .remove-skill-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 1.25rem;
        height: 1.25rem;
        border-radius: 9999px;
        background-color: #9ca3af;
        color: white;
        font-size: 0.75rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
    }

    .remove-skill-btn:hover {
        background-color: #6b7280;
    }

    /* Animation for adding/removing skills */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .skill-badge {
        animation: fadeIn 0.2s ease-out;
    }

    /* --- Grammar Checker Styles (from reference) --- */
    .grammar-checker-container {
        margin-top: 10px;
        background: #f8fafc;
        border-radius: 10px;
        border: 1px solid #e5e7eb;
        padding: 12px 16px 8px 16px;
        font-size: 0.97em;
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.04);
        animation: fadeIn 0.3s ease;
    }
    .grammar-checker-title {
        font-weight: 600;
        color: #2563eb;
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 1em;
    }
    .grammar-checker-icon {
        width: 18px;
        height: 18px;
        background: #e74c3c;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 11px;
        font-weight: bold;
    }
    .grammar-checker-list {
        margin: 0;
        padding: 0;
        list-style: none;
        max-height: 120px;
        overflow-y: auto;
    }
    .grammar-checker-item {
        padding: 7px 0 7px 0;
        border-bottom: 1px solid #e5e7eb;
        display: flex;
        align-items: flex-start;
        gap: 10px;
    }
    .grammar-checker-item:last-child {
        border-bottom: none;
    }
    .grammar-checker-type {
        background: #e74c3c;
        color: white;
        padding: 2px 8px;
        border-radius: 20px;
        font-size: 0.8em;
        font-weight: bold;
        min-width: 70px;
        text-align: center;
    }
    .grammar-checker-message {
        flex: 1;
        color: #333;
        font-size: 0.97em;
    }
    .grammar-checker-no-errors {
        text-align: left;
        color: #27ae60;
        font-size: 0.97em;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 0 0 0;
    }
    .grammar-checker-success-icon {
        width: 18px;
        height: 18px;
        background: #27ae60;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 12px;
    }

    /* Success Modal Check Animation */
    .check-animation-container {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .check-circle {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        background-color: #10b981;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        animation: scaleIn 0.5s ease-out;
    }

    .check-mark {
        width: 30px;
        height: 15px;
        border: 4px solid white;
        border-top: none;
        border-right: none;
        transform: rotate(-45deg);
        animation: checkDraw 0.5s ease-out 0.3s both;
        opacity: 0;
    }

    @keyframes scaleIn {
        0% {
            transform: scale(0);
            opacity: 0;
        }
        50% {
            transform: scale(1.1);
        }
        100% {
            transform: scale(1);
            opacity: 1;
        }
    }

    @keyframes checkDraw {
        0% {
            opacity: 0;
            transform: rotate(-45deg) scale(0);
        }
        100% {
            opacity: 1;
            transform: rotate(-45deg) scale(1);
        }
    }

    /* Success Modal Button Hover Effect */
    #successModal button:hover {
        background: #059669 !important;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
    }

    /* Touch-friendly styles for profile editor */
    #profileEditorModal {
        touch-action: manipulation;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    #previewCanvas {
        touch-action: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
    }

    /* Mobile-responsive profile editor */
    @media (max-width: 1024px) {
        #profileEditorModal {
            padding: 0;
        }
        
        #profileEditorModal > div {
            margin: 0;
            width: 100%;
            height: 100%;
            border-radius: 0;
            max-width: none;
        }
        
        #previewWrapper {
            width: 100% !important;
            max-width: 300px !important;
            height: 300px !important;
        }
        
        .suit-option img {
            width: 80px !important;
            height: 80px !important;
        }
        
        #profileEditorModal .flex.flex-col.lg\\:flex-row {
            gap: 2rem;
        }
    }

    @media (max-width: 768px) {
        #profileEditorModal > div {
            padding: 1rem;
        }
        
        #profileEditorModal h2 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }
        
        #profileEditorModal p {
            font-size: 0.875rem;
        }
        
        .suit-option img {
            width: 60px !important;
            height: 60px !important;
        }
        
        #previewWrapper {
            max-width: 250px !important;
            height: 250px !important;
        }
        
        #profileEditorModal .flex.flex-col.lg\\:flex-row {
            gap: 1.5rem;
        }
    }

    @media (max-width: 480px) {
        #profileEditorModal > div {
            padding: 0.75rem;
        }
        
        #previewWrapper {
            max-width: 200px !important;
            height: 200px !important;
        }
        
        .suit-option img {
            width: 50px !important;
            height: 50px !important;
        }
        
        #profileEditorModal .flex.flex-col.lg\\:flex-row {
            gap: 1rem;
        }
    }

   
    #profileEditorModal {
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
    }

    
    @media (max-width: 768px) {
        #profileEditorModal button,
        #profileEditorModal .suit-option {
            min-height: 44px;
            min-width: 44px;
        }
        
        #profileEditorModal input[type="range"] {
            min-height: 44px;
        }
    }

    
    
</style>

</head>

<body>
    <div id="loader" class="fixed inset-0 flex items-center justify-center bg-white z-[9999]">
        <img src="/assets/img/logo.png" alt="ResumeGo Logo" class="h-20 w-auto animate-pulse" />
    </div>
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <nav class="bg-white border-b border-gray-200">
            <div class="max-w-7xl mx-auto flex flex-wrap items-center justify-between px-4 py-3">
                <a href="dashboard.html" class="flex items-center space-x-3">
                    <img src="/assets/img/logo.png" class="h-8" alt="ResumeGo Logo" />
                    <span class="self-center text-2xl font-bold text-primary">ResumeGo!</span>
                </a>
                <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200" aria-controls="navbar-default" aria-expanded="false">
                    <span class="sr-only">Open main menu</span>
                    <svg class="w-5 h-5 text-primary" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
                    </svg>
                </button>
                <div class="hidden w-full md:block md:w-auto" id="navbar-default">
                    <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-white md:flex-row md:space-x-8 md:mt-0 md:border-0">
                        <li>
                        <a href="dashboard.html" class="block py-2 px-3 text-gray-700 font-semibold rounded md:bg-transparent md:p-0" aria-current="page">Dashboard</a>
                        </li>
                        <li>
                        <a href="templates.html" class="block py-2 px-3 text-gray-700 hover:text-primary rounded md:p-0">Templates</a>
                        </li>
                        <li>
                        <a href="resumebuilder.html?template=generic-1" class="block py-2 px-3 text-primary hover:text-primary rounded md:p-0">Create Resume</a>
                        </li>
                        <li>
                        <a href="ats-checker.html" class="block py-2 px-3 text-gray-700 hover:text-primary rounded md:p-0">Mini ATS Engine</a>
                        </li>
                    </ul>
                </div>
          
                <div class="flex items-center">
                    <div class="relative">
                        <button id="userMenuButton" class="flex items-center space-x-2 px-4 py-2 border border-gray-200 rounded-md hover:border-primary transition-colors">
                        <div id="userAvatar" class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center font-semibold">U</div>
                        <span id="userName" class="hidden md:inline">User Name</span>
                        </button>
                        <div id="userDropdown" class="user-dropdown absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border border-gray-200">
                        <a href="profile.html" class="block px-4 py-3 text-gray-700 hover:bg-gray-50">Profile Settings</a>
                        <div class="border-t border-gray-200 my-1"></div>
                        
                        <a href="#" id="logoutButton" class="block px-4 py-3 text-gray-700 hover:bg-gray-50">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
            <script>
            // Responsive nav toggle for Flowbite-style nav
            const menuBtn = document.querySelector('[data-collapse-toggle="navbar-default"]');
            const navLinks = document.getElementById('navbar-default');
            if (menuBtn && navLinks) {
            menuBtn.addEventListener('click', () => {
                navLinks.classList.toggle('hidden');
            });
            }
            </script>
    </header>

    <main class="main-container">
        <button id="saveResumeBtn" class="fixed bottom-5 right-8 bg-primary text-white px-5 py-2 rounded shadow-md text-sm font-semibold hover:bg-secondary transition-all z-50">Save</button>
    <div class="left-panel">
            <!-- Profile Picture Upload -->
            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="personal-section">
                <h2 class="section-header">Profile Picture</h2>
                <div class="profile-upload">
                    <div class="profile-preview" style="width: 150px; height: 150px; border-radius: 50%; overflow: hidden; background: #fff; border: 3px solid #2563eb; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <img src="" alt="Profile Picture" style="width: 100%; height: 100%; object-fit: cover; display: block;">
                    </div>
                    <button type="button" onclick="openModal()" class="cursor-pointer bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Upload Photo</button>
                    <input type="file" id="profile-upload" accept="image/*" style="display: none;">
                    <span class="remove-photo">Remove Photo</span>
                </div>
            </div>

            <!-- Profile Editor Modal -->
            <div id="profileEditorModal" class="hidden fixed inset-0 w-full h-full bg-black/50 z-50 overflow-y-auto">
                <div class="bg-white w-11/12 max-w-4xl mx-auto my-4 p-5 rounded-lg relative min-h-fit">
                    <!-- Close Button -->
                    <button onclick="closeModal()" class="absolute top-3 right-3 md:top-5 md:right-5 bg-gray-100 md:bg-transparent border-none cursor-pointer text-2xl p-1 hover:text-gray-700 transition-colors rounded-full md:rounded-none w-10 h-10 md:w-auto md:h-auto flex items-center justify-center" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">×</button>
                    
                    <!-- Header -->
                    <div class="mb-5 mt-8 md:mt-0">
                        <h2 class="text-xl md:text-2xl lg:text-3xl font-semibold text-gray-800">Profile Photo Editor</h2>
                        <p class="text-gray-600 text-sm md:text-base">Crop and apply professional suit overlay for your resume</p>
                    </div>

                    <div class="flex flex-col lg:flex-row gap-5">
                        
                        <!-- Left: Canvas Preview -->
                        <div class="flex flex-col items-center w-full lg:w-1/2 order-2 lg:order-1 space-y-4">
                            <!-- Canvas Preview Container -->
                            <div id="previewWrapper" class="border-2 border-gray-300 w-full max-w-75 h-75 flex items-center justify-center bg-gray-50 rounded-lg mx-auto">
                                <canvas id="previewCanvas" width="300" height="300" class="max-w-full max-h-full cursor-grab" style="touch-action: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;"></canvas>
                            </div>

                            <!-- Download Button -->
                            <a id="downloadImageBtn" 
                                class="bg-blue-600 text-white px-4 py-2 rounded-md mt-3 text-decoration-none hidden hover:bg-blue-700 transition-colors"
                                download="resume-photo.png">
                                Download Image
                            </a>

                            <!-- Hidden Upload Control -->
                            <input type="file" id="uploadInput" accept="image/*" class="hidden" />

                            <!-- Image Sizer -->
                            <div class="mt-6">
                                <p class="font-semibold mb-1 text-gray-700">Image Sizer</p>
                                <div class="flex items-center w-75">
                                    <button id="zoomOutBtn" class="text-xl px-2 py-1 bg-gray-100 border-none rounded cursor-pointer hover:bg-gray-200 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px; min-width: 44px;">−</button>
                                    <input type="range" min="50" max="300" value="100" id="zoomSlider" class="flex-1 mx-2" style="touch-action: manipulation;" />
                                    <button id="zoomInBtn" class="text-xl px-2 py-1 bg-gray-100 border-none rounded cursor-pointer hover:bg-gray-200 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px; min-width: 44px;">+</button>
                                </div>
                            </div>

                            <!-- Suit Sizer (hidden by default) -->
                            <div id="suitSizerWrapper" class="mt-6 hidden">
                                <p class="font-semibold mb-1 text-gray-700">Suit Sizer</p>
                                <div class="flex items-center w-75">
                                    <button id="suitZoomOut" class="text-xl px-2 py-1 bg-gray-100 border-none rounded cursor-pointer hover:bg-gray-200 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px; min-width: 44px;">−</button>
                                    <input type="range" min="50" max="200" value="100" id="suitZoomSlider" class="flex-1 mx-2" style="touch-action: manipulation;" />
                                    <button id="suitZoomIn" class="text-xl px-2 py-1 bg-gray-100 border-none rounded cursor-pointer hover:bg-gray-200 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px; min-width: 44px;">+</button>
                                </div>
                            </div>
                        </div>

                        <!-- Right Side Controls -->
                        <div class="w-full lg:w-1/2 flex flex-col gap-4 order-1 lg:order-2 space-y-4">

                            <!-- Suit Selection -->
                            <div>
                                <p class="text-sm font-medium mb-2 text-gray-700">Select Suit Overlay</p>
                                <div class="space-y-3" id="suitOptions">
                                    <p class="text-sm font-medium mb-2 text-gray-700">Male Suit</p>
                                    <!-- Top Row - 3 suits -->
                                    <div class="flex gap-3">
                                        <div class="border-2 border-blue-500 rounded-md p-1 suit-option cursor-pointer hover:border-blue-600 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-1.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-1.png" alt="Business" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-4.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-4.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-6.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-6.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                    </div>
                                    <!-- Top Row - 3 suits -->
                                    <div class="flex gap-3">
                                        <div class="border-2 border-blue-500 rounded-md p-1 suit-option cursor-pointer hover:border-blue-600 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-10.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-10.png" alt="Business" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-11.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-11.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-12.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-12.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                    </div>
                                    <p class="text-sm font-medium mb-2 text-gray-700">Female Suit</p>
                                    <!-- Bottom Row - 3 suits -->
                                    <div class="flex gap-3" id="suitOptions">
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-2.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-2.png" alt="Executive" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-5.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-5.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-3.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-3.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        
                                    </div>
                                    <div class="flex gap-3" id="suitOptions">
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-7.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-7.png" alt="Executive" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-8.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-8.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div>
                                        <div class="border border-gray-300 rounded-md p-1 suit-option cursor-pointer hover:border-gray-400 transition-colors" data-suit="/assets/img/suit-overlay/suit-overlay-9.png" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent;">
                                            <img src="/assets/img/suit-overlay/suit-overlay-9.png" alt="Formal" class="w-24 h-24 object-cover rounded" />
                                        </div> 
                                    </div>
                                </div>
                            </div>
                            

                            <!-- Upload Options -->
                            <div class="flex flex-col gap-2">
                                <!-- Use device -->
                                <button id="triggerUploadBtn" class="w-full bg-blue-600 text-white py-3 border-none rounded-md cursor-pointer text-sm hover:bg-blue-700 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px;">
                                    Select Photo from Device
                                </button>

                                <!-- Take a selfie -->
                                <button id="startCameraBtn" class="w-full bg-gray-100 text-gray-700 py-3 border border-gray-300 rounded-md cursor-pointer text-sm hover:bg-gray-200 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px;">
                                    Take a Selfie
                                </button>

                                <!-- Webcam view -->
                                <div id="cameraWrapper" class="hidden flex flex-col gap-2">
                                    <video id="cameraFeed" autoplay class="rounded-md w-full h-48 object-cover border border-gray-300"></video>
                                    <button id="captureBtn" class="w-full bg-green-600 text-white py-3 border-none rounded-md cursor-pointer text-sm hover:bg-green-700 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px;">
                                        Capture Selfie
                                    </button>
                                </div>
                            </div>

                            <!-- Advanced Settings -->
                            <div class="flex flex-col gap-2">
                                <p class="text-sm font-medium text-gray-700">Advanced Settings</p>
                                <label class="flex items-center gap-2 text-sm text-gray-700">
                                    <input type="checkbox" id="autoBgCheckbox" class="form-checkbox" />
                                    Automatic background removal
                                </label>
                                <label class="flex items-center gap-2 text-sm text-gray-700">
                                    <input type="checkbox" id="suitCheckbox" class="form-checkbox" />
                                    Add suit overlay to my photo
                                </label>
                            </div>
                            <div class="flex flex-col gap-2 mt-4">
                            <p class="text-sm font-medium text-gray-700">Background Color</p>
                            <div class="flex gap-2 flex-wrap">
                                <button class="bg-white border w-8 h-8 rounded color-btn" data-color="#ffffff"></button>
                                <button class="bg-gray-200 border w-8 h-8 rounded color-btn" data-color="#e5e7eb"></button>
                                <button class="bg-blue-500 border w-8 h-8 rounded color-btn" data-color="#3b82f6"></button>
                                <button class="bg-green-500 border w-8 h-8 rounded color-btn" data-color="#10b981"></button>
                                <button class="bg-yellow-400 border w-8 h-8 rounded color-btn" data-color="#facc15"></button>
                                <button class="bg-red-500 border w-8 h-8 rounded color-btn" data-color="#ef4444"></button>
                                <!-- Optional: allow custom color -->
                                <input type="color" id="customBgColor" class="w-10 h-8 border rounded" value="#ffffff">
                            </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer Buttons -->
                    <div class="flex justify-end mt-6 gap-3">
                        <button onclick="closeModal()" class="px-6 py-3 bg-gray-100 text-gray-700 border-none rounded-md cursor-pointer text-sm hover:bg-gray-200 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px;">Cancel</button>
                        <button id="applyToResumeBtn" class="px-6 py-3 bg-blue-600 text-white border-none rounded-md cursor-pointer text-sm hover:bg-blue-700 transition-colors" style="touch-action: manipulation; -webkit-tap-highlight-color: transparent; min-height: 44px;">Apply to Resume</button>
                    </div>
                </div>
            </div>

            <!-- Success Modal -->
            <div id="successModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1100; overflow-y: auto;">
                <div style="background: white; width: 90%; max-width: 400px; margin: 20% auto; padding: 40px 20px; border-radius: 12px; position: relative; text-align: center; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);">
                    <!-- Check Animation Container -->
                    <div class="check-animation-container" style="margin-bottom: 20px;">
                        <div class="check-circle">
                            <div class="check-mark"></div>
                        </div>
                    </div>
                    
                    <!-- Success Message -->
                    <h2 style="font-size: 24px; font-weight: 600; color: #065f46; margin-bottom: 12px;">Success!</h2>
                    <p id="successMessage" style="color: #374151; font-size: 16px; margin-bottom: 30px;">Resume saved successfully!</p>
                    
                    <!-- Action Button -->
                    <button onclick="closeSuccessModal()" style="padding: 12px 32px; background: #10b981; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 500; transition: all 0.2s ease;">
                        Continue
                    </button>
                </div>
            </div>

            <!-- Personal Information -->
            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6">
                <h2 class="section-header">Personal Information</h2>
                <div class="form-grid">
                    <div class="input-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" placeholder="John Doe">
                    </div>
                    <div class="input-group">
                        <label for="title">Professional Title</label>
                        <input type="text" id="title" placeholder="e.g., Software Engineer">
                    </div>
                    <div class="input-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" placeholder="john.doe@example.com">
                    </div>
                    <div class="input-group">
                        <label for="phone">Phone</label>
                        <input type="tel" id="phone" placeholder="+1 234 567 890">
                    </div>
                    <div class="input-group">
                        <label for="address">Address</label>
                        <input type="text" id="address" placeholder="123 Main St, City, State">
                    </div>
                    <div class="input-group full-width">
                        <label for="summary">Professional Summary</label>
                        <textarea id="summary" placeholder="Write a brief summary of your professional background..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Education -->
            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="education-section">
                <h2 class="section-header">Education</h2>
                <div id="education-container">
                    <div class="education-item">
                        <div class="form-grid">
                            <div class="input-group">
                                <label for="education-degree">Degree/Strand</label>
                                <input type="text" id="education-degree" placeholder="e.g., Bachelor of Information Technology">
                            </div>
                            <div class="input-group">
                                <label for="education-school">School/University</label>
                                <input type="text" id="education-school" placeholder="e.g., University Name">
                            </div>
                            <div class="input-group">
                                <label for="education-year">Year</label>
                                <input type="text" id="education-year" placeholder="e.g., 2022-2025">
                            </div>
                            <div class="input-group">
                                <label for="education-gpa">GPA (Optional)</label>
                                <input type="text" id="education-gpa" placeholder="e.g., 3.8/4.0">
                            </div>
                            <div class="input-group full-width">
                                <label for="education-description">Description (Optional)</label>
                                <textarea id="education-description" placeholder="Relevant coursework, achievements, or activities..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="add-education-btn" style="margin-top: 1rem; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Another Education</button>
            </div>

            <!-- Technical Skills -->
            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="skills-section">
                <h2 class="text-2xl font-bold text-gray-900 mb-6" id="skills-section-title">Listed Skills</h2>
                <div class="space-y-8">
                    <!-- Category 1 -->
                    <div class="skill-category" id="skill-cat-1">
                        <h4 class="text-lg font-light text-gray-800 mb-3">Input your skills here</h4>
                        <div class="flex gap-2 mb-3">
                            <input type="text" 
                                   class="skill-input flex-1 px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-primary transition-colors" 
                                   placeholder="e.g., Communication, Java, Python, Excel...">
                            <button class="add-skill-btn px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2">
                                Add
                            </button>
                        </div>
                        <div class="skills-list flex flex-wrap gap-2 min-h-[40px] p-2 bg-gray-50 rounded-md"></div>
                    </div>

                    <!-- Category 2 -->
                    
                </div>
            </div>

            <!-- Work Experience -->
            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="experience-section">
                <h2 class="section-header">Work Experience</h2>
                <div id="work-experience-container">
                    <div class="experience-item">
                            <div class="form-grid">
                                <div class="input-group">
                                    <label for="company">Company</label>
                                    <input type="text" id="company" placeholder="Company Name">
                                </div>
                                <div class="input-group">
                                    <label for="position">Position</label>
                                    <input type="text" id="position" placeholder="Job Title">
                                </div>
                                <div class="input-group">
                                    <label for="start-date">Start Date</label>
                                    <input type="month" id="start-date">
                                </div>
                                <div class="input-group">
                                    <label for="end-date">End Date</label>
                                    <input type="month" id="end-date">
                                </div>
                            <div class="input-group full-width">
                                <label for="description">Description</label>
                                <textarea id="description" placeholder="Describe your responsibilities and achievements..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <button class="add-experience-btn" style="margin-top: 1rem; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Another Experience</button>
            </div>

               <!-- Languages -->
               <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="languages-section" style="display: none;">
                <h2 class="section-header">Languages</h2>
                <div id="languages-container">
                    <div class="language-item">
                        <div class="form-grid">
                            <div class="input-group">
                                <label for="language-1">Language</label>
                                <input type="text" class="language-input" id="language-1" placeholder="e.g., English">
                            </div>
                            <div class="input-group">
                                <label for="proficiency-1">Proficiency Level</label>
                                <select class="proficiency-select" id="proficiency-1">
                                    <option value="Basic">Basic</option>
                                    <option value="Conversational">Conversational</option>
                                    <option value="Fluent">Fluent</option>
                                    <option value="Native">Native</option>
                                </select>
                            </div>
                        </div>
                        <button class="remove-language-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                    </div>
                </div>
                <button class="add-language-btn" style="margin-top: 1rem; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Another Language</button>
            </div>

            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="hobbies-section" style="display: none;">
                <h2 class="section-header">Hobbies & Interests</h2>
                <div id="hobbies-container">
                    <div class="hobby-item">
                        <div class="form-grid">
                            <div class="input-group">
                                <label for="hobby-1">Hobby/Interest</label>
                                <input type="text" class="hobby-input" id="hobby-1" placeholder="e.g., Reading, Traveling, Photography">
                            </div>
                            <div class="input-group">
                                <label for="hobby-description-1">Description (Optional)</label>
                                <input type="text" class="hobby-description-input" id="hobby-description-1" placeholder="Brief description or context">
                            </div>
                        </div>
                        <button class="remove-hobby-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                    </div>
                </div>
                <button class="add-hobby-btn" style="margin-top: 1rem; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Another Hobby</button>
            </div>

            <!-- Projects -->
            <div class="section-block bg-white rounded-lg shadow-sm p-6 mb-6" id="projects-section">
                <h2 class="section-header">Projects</h2>
                    <div id="projects-container">
                        <div class="project-item">
                            <div class="form-grid">
                                <div class="input-group">
                                    <label for="project-title">Project Title</label>
                                    <input type="text" id="project-title" placeholder="Project Name">
                                </div>
                                <div class="input-group">
                                    <label for="project-tech">Technologies Used</label>
                                    <input type="text" id="project-tech" placeholder="e.g., React, Node.js, MongoDB">
                                </div>
                                <div class="input-group full-width">
                                    <label for="project-desc">Project Description</label>
                                    <textarea id="project-desc" placeholder="Describe the project and your role..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                <button class="add-project-btn" style="margin-top: 1rem; padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Another Project</button>
                    </div>
            </div>

         

            <!-- Hobbies -->
           

            <div class="right-panel" id="resume-preview">
                <!-- Resume preview will be generated here -->
            </div>
    </main>

    <button class="preview-toggle" id="previewToggle"><i class="fa-regular fa-eye"></i></button>
    <script>
        window.apiConfig = {
            baseURL: 'https://api.resumego.cloud/api',
            getFullURL: function (endpoint) {
                return this.baseURL + endpoint;
            }

        };
    </script>
    <script src="js/auth.js"></script>
    <script>
        window.addEventListener("load", function () {
            const loader = document.getElementById("loader");
            if (loader) {
            loader.style.opacity = "0";
            setTimeout(() => loader.style.display = "none", 500); // fade out
            }
        });
    </script>
    <script type="module">
    import { resumeAPI } from './js/api.js';
    document.addEventListener('DOMContentLoaded', async function() {
        const urlParams = new URLSearchParams(window.location.search);
        const resumeId = urlParams.get('resumeId');
        const token = localStorage.getItem('token');
        if (resumeId && token) {
            try {
                const resume = await resumeAPI.getOne(resumeId, token);
                if (resume && resume.content) {
                    // Fill basic fields
                    document.getElementById('name').value = resume.content.name || '';
                    document.getElementById('title').value = resume.content.title || '';
                    document.getElementById('email').value = resume.content.email || '';
                    document.getElementById('phone').value = resume.content.phone || '';
                    document.getElementById('address').value = resume.content.address || '';
                    document.getElementById('summary').value = resume.content.summary || '';

                    

                    
                    // Fill skills
                    if (Array.isArray(resume.content.skills)) {
                        const skillCategories = document.querySelectorAll('.skill-category');
                        resume.content.skills.forEach((cat, i) => {
                            if (skillCategories[i]) {
                                const skillsList = skillCategories[i].querySelector('.skills-list');
                                skillsList.innerHTML = '';
                                (cat.items || []).forEach(skill => {
                                    const skillBadge = document.createElement('span');
                                    skillBadge.className = 'skill-badge';
                                    skillBadge.textContent = skill;
                                    const removeBtn = document.createElement('button');
                                    removeBtn.className = 'remove-skill-btn';
                                    removeBtn.textContent = '×';
                                    removeBtn.addEventListener('click', () => {
                                        console.log('Skill badge remove clicked');
                                        skillBadge.remove();
                                        if (isPreviewActive) {
                                            updatePreview();
                                        }
                                    });

                                    skillBadge.appendChild(removeBtn);
                                    skillsList.appendChild(skillBadge);
                                });
                            }
                        });
                    }
                    // Fill experience
                    if (Array.isArray(resume.content.experience)) {
                        const container = document.getElementById('work-experience-container');
                        container.innerHTML = '';
                        resume.content.experience.forEach(exp => {
                            const experienceItem = document.createElement('div');
                            experienceItem.className = 'experience-item';
                            experienceItem.innerHTML = `
                                <div class="form-grid">
                                    <div class="input-group">
                                        <label>Company</label>
                                        <input type="text" placeholder="Company Name" value="${exp.company || ''}">
                                    </div>
                                    <div class="input-group">
                                        <label>Position</label>
                                        <input type="text" placeholder="Job Title" value="${exp.position || ''}">
                                    </div>
                                    <div class="input-group">
                                        <label>Start Date</label>
                                        <input type="month" value="${exp.startDate || ''}">
                                    </div>
                                    <div class="input-group">
                                        <label>End Date</label>
                                        <input type="month" value="${exp.endDate || ''}">
                                    </div>
                                    <div class="input-group full-width">
                                        <label>Description</label>
                                        <textarea placeholder="Describe your responsibilities and achievements...">${exp.description || ''}</textarea>
                                    </div>
                                </div>
                                <button class="remove-experience-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                            `;
                            // Add remove functionality
                            experienceItem.querySelector('.remove-experience-btn').addEventListener('click', () => experienceItem.remove());
                            container.appendChild(experienceItem);
                        });
                    }
                    // Fill education
                    if (Array.isArray(resume.content.education)) {
                        const eduContainer = document.getElementById('education-container');
                        if (eduContainer) {
                            eduContainer.innerHTML = '';
                            resume.content.education.forEach(ed => {
                                const educationItem = document.createElement('div');
                                educationItem.className = 'education-item';
                                educationItem.innerHTML = `
                                    <div class="form-grid">
                                        <div class="input-group">
                                            <label for="education-degree">Degree/Strand</label>
                                            <input type="text" placeholder="e.g., Bachelor of Information Technology" value="${ed.degree || ''}">
                                        </div>
                                        <div class="input-group">
                                            <label for="education-school">School/University</label>
                                            <input type="text" placeholder="e.g., University Name" value="${ed.school || ''}">
                                        </div>
                                        <div class="input-group">
                                            <label for="education-year">Year</label>
                                            <input type="text" placeholder="e.g., 2022-2025" value="${ed.year || ''}">
                                        </div>
                                        <div class="input-group">
                                            <label for="education-gpa">GPA (Optional)</label>
                                            <input type="text" placeholder="e.g., 3.8/4.0" value="${ed.gpa || ''}">
                                        </div>
                                        <div class="input-group full-width">
                                            <label for="education-description">Description (Optional)</label>
                                            <textarea placeholder="Relevant coursework, achievements, or activities...">${ed.description || ''}</textarea>
                                        </div>
                                    </div>
                                    <button class="remove-education-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                                `;
                                // remove handler
                                educationItem.querySelector('.remove-education-btn').addEventListener('click', () => educationItem.remove());
                                // preview updates on input
                                educationItem.querySelectorAll('input, textarea').forEach(el => {
                                    el.addEventListener('input', () => {
                                        if (typeof debouncedUpdatePreview === 'function') {
                                            debouncedUpdatePreview();
                                        }
                                    });
                                });
                                eduContainer.appendChild(educationItem);
                            });
                        }
                    }
                    // Fill projects
                    if (Array.isArray(resume.content.projects) && resume.content.projects.length > 0) {
                        const container = document.getElementById('projects-container');
                        container.innerHTML = '';

                        resume.content.projects.forEach(proj => {
                            // Skip if project is completely empty
                            if (!proj.title && !proj.tech && !proj.description) return;

                            const projectItem = document.createElement('div');
                            projectItem.className = 'project-item';
                            projectItem.innerHTML = `
                                <div class="form-grid">
                                    <div class="input-group">
                                        <label>Project Title</label>
                                        <input type="text" placeholder="Project Name" value="${proj.title || ''}">
                                    </div>
                                    <div class="input-group">
                                        <label>Technologies Used</label>
                                        <input type="text" placeholder="e.g., React, Node.js, MongoDB" value="${proj.tech || ''}">
                                    </div>
                                    <div class="input-group full-width">
                                        <label>Project Description</label>
                                        <textarea placeholder="Describe the project and your role...">${proj.description || ''}</textarea>
                                    </div>
                                </div>
                                <button class="remove-project-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                            `;

                            // Remove functionality
                            projectItem.querySelector('.remove-project-btn').addEventListener('click', () => projectItem.remove());

                            // Input events
                            projectItem.querySelectorAll('input, textarea').forEach(el => {
                                el.addEventListener('input', () => {
                                    if (typeof debouncedUpdatePreview === 'function') debouncedUpdatePreview();
                                });
                            });

                            container.appendChild(projectItem);
                        });
                    } else {
                        // If no projects, ensure container is empty
                        const container = document.getElementById('projects-container');
                        if (container) container.innerHTML = '';
                    }

                    // Fill languages
                    if (Array.isArray(resume.content.languages) && resume.content.languages.length > 0) {
                        // FIRST: Show the languages section
                        const langSection = document.getElementById('languages-section');
                        if (langSection) {
                            langSection.style.display = 'block';
                        }
                        
                        // THEN: Populate the container
                        const container = document.getElementById('languages-container');
                        if (container) {
                            container.innerHTML = '';
                            resume.content.languages.forEach((lang, index) => {
                                const languageItem = document.createElement('div');
                                languageItem.className = 'language-item';
                                languageItem.innerHTML = `
                                    <div class="form-grid">
                                        <div class="input-group">
                                            <label>Language</label>
                                            <input type="text" class="language-input" placeholder="e.g., English" value="${lang.language || ''}">
                                        </div>
                                        <div class="input-group">
                                            <label>Proficiency Level</label>
                                            <select class="proficiency-select">
                                                <option value="Basic" ${lang.proficiency === 'Basic' ? 'selected' : ''}>Basic</option>
                                                <option value="Conversational" ${lang.proficiency === 'Conversational' ? 'selected' : ''}>Conversational</option>
                                                <option value="Fluent" ${lang.proficiency === 'Fluent' ? 'selected' : ''}>Fluent</option>
                                                <option value="Native" ${lang.proficiency === 'Native' ? 'selected' : ''}>Native</option>
                                            </select>
                                        </div>
                                    </div>
                                    <button class="remove-language-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                                `;
                                // Add event listeners for new inputs
                                languageItem.querySelectorAll('input, select').forEach(input => {
                                    input.addEventListener('input', () => {
                                        if (typeof debouncedUpdatePreview === 'function') {
                                            debouncedUpdatePreview();
                                        }
                                    });
                                });
                                // Add remove functionality
                                languageItem.querySelector('.remove-language-btn').addEventListener('click', () => {
                                    languageItem.remove();
                                    if (typeof debouncedUpdatePreview === 'function') {
                                        debouncedUpdatePreview();
                                    }
                                });
                                container.appendChild(languageItem);
                            });
                            
                            // Update preview after loading
                            if (typeof updateLanguagesInPreview === 'function') {
                                setTimeout(() => updateLanguagesInPreview(), 100);
                            }
                        }
                    }

                    // Fill hobbies
                    if (Array.isArray(resume.content.hobbies) && resume.content.hobbies.length > 0) {
                        // FIRST: Show the hobbies section
                        const hobbiesSection = document.getElementById('hobbies-section');
                        if (hobbiesSection) {
                            hobbiesSection.style.display = 'block';
                        }
                        
                        // THEN: Populate the container
                        const container = document.getElementById('hobbies-container');
                        if (container) {
                            container.innerHTML = '';
                            resume.content.hobbies.forEach((hobby, index) => {
                                const hobbyItem = document.createElement('div');
                                hobbyItem.className = 'hobby-item';
                                hobbyItem.innerHTML = `
                                    <div class="form-grid">
                                        <div class="input-group">
                                            <label>Hobby/Interest</label>
                                            <input type="text" class="hobby-input" placeholder="e.g., Reading, Traveling, Photography" value="${hobby.hobby || ''}">
                                        </div>
                                        <div class="input-group">
                                            <label>Description (Optional)</label>
                                            <input type="text" class="hobby-description-input" placeholder="Brief description or context" value="${hobby.description || ''}">
                                        </div>
                                    </div>
                                    <button class="remove-hobby-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
                                `;
                                // Add event listeners for new inputs
                                hobbyItem.querySelectorAll('input').forEach(input => {
                                    input.addEventListener('input', () => {
                                        if (typeof debouncedUpdatePreview === 'function') {
                                            debouncedUpdatePreview();
                                        }
                                    });
                                });
                                // Add remove functionality
                                hobbyItem.querySelector('.remove-hobby-btn').addEventListener('click', () => {
                                    hobbyItem.remove();
                                    if (typeof debouncedUpdatePreview === 'function') {
                                        debouncedUpdatePreview();
                                    }
                                });
                                container.appendChild(hobbyItem);
                            });
                            
                            // Update preview after loading
                            if (typeof updateHobbiesInPreview === 'function') {
                                setTimeout(() => updateHobbiesInPreview(), 100);
                            }
                        }
                    }
                    

                    // Fill template selection if applicable
                    // (Assume you have a way to set the template visually)
                    // Fill profile image if available
                    if (resume.content.profileImage) {
                        window.profileImage = resume.content.profileImage;
                        const profilePreview = document.querySelector('.profile-preview');
                        if (profilePreview) {
                            profilePreview.innerHTML = `<img src="${resume.content.profileImage}" alt="Profile Picture" style="width: 100%; height: 100%; object-fit: cover;">`;
                        }
                    }
                    if (resume.template) {
                        templateId = resume.template;
                    }
                }
            } catch (err) {
                console.error('Failed to load resume for editing:', err);
                alert('Failed to load resume for editing.');
            }
        }
        
        if (typeof updatePreview === 'function') {
            updatePreview();
        }

        // if (resume.content.languages && resume.content.languages.length > 0) {
        //     const langSection = document.getElementById('languages-section');
        //     if (langSection) langSection.style.display = 'block';
        // }

        // if (resume.content.hobbies && resume.content.hobbies.length > 0) {
        //     const hobbiesSection = document.getElementById('hobbies-section');
        //     if (hobbiesSection) hobbiesSection.style.display = 'block';
        // }
        
        // Add event listeners to existing project inputs
        const existingProjectInputs = document.querySelectorAll('#projects-container .project-item input, #projects-container .project-item textarea');
        existingProjectInputs.forEach(input => {
            input.addEventListener('input', () => {
                if (typeof debouncedUpdatePreview === 'function') {
                    debouncedUpdatePreview();
                }
            });
        });
    });

    document.getElementById('saveResumeBtn').addEventListener('click', async function() {
        const token = localStorage.getItem('token');
        if (!token) {
            alert('You must be logged in to save your resume.');
            return;
        }

        updatePreview();
        const title = document.getElementById('title').value || 'Untitled Resume';
        const template = templateId;
        // Gather all content (inputs, skills, experience, projects, etc.)
        function getSkills() {
            const skills = [];
            document.querySelectorAll('.skills-list').forEach((list, i) => {
                const category = list.previousElementSibling.previousElementSibling.textContent;
                const items = Array.from(list.querySelectorAll('.skill-badge')).map(badge => badge.textContent.replace('×', '').trim());
                if (items.length) skills.push({ category, items });
            });
            return skills;
        }

        function getLanguages() {
            const languages = [];
            document.querySelectorAll('.language-item').forEach((item, i) => {
                const language = item.querySelector('.language-input')?.value;
                const proficiency = item.querySelector('.proficiency-select')?.value;
                if (language && language.trim()) {
                    languages.push({ language: language.trim(), proficiency: proficiency || 'Fluent' });
                }
            });
            return languages;
        }

        function getEducation() {
            return Array.from(document.querySelectorAll('.education-item')).map(item => {
                const inputs = item.querySelectorAll('input');
                const textarea = item.querySelector('textarea');
                const degree = inputs[0] ? inputs[0].value : '';
                const school = inputs[1] ? inputs[1].value : '';
                const year = inputs[2] ? inputs[2].value : '';
                const gpa = inputs[3] ? inputs[3].value : '';
                return {
                    degree: degree || '',
                    school: school || '',
                    year: year || '',
                    gpa: gpa || '',
                    description: textarea ? (textarea.value || '') : ''
                };
            }).filter(ed => ed.degree || ed.school || ed.year || ed.gpa || ed.description);
    }


       

        function getHobbies() {
            const hobbies = [];
            document.querySelectorAll('.hobby-item').forEach((item, i) => {
                const hobby = item.querySelector('.hobby-input')?.value;
                const description = item.querySelector('.hobby-description-input')?.value;
                if (hobby && hobby.trim()) {
                    hobbies.push({ hobby: hobby.trim(), description: description || '' });
                }
            });
            return hobbies;
        }
        function getExperience() {
            return Array.from(document.querySelectorAll('.experience-item')).map(item => ({
                company: item.querySelector('input[placeholder="Company Name"]')?.value,
                position: item.querySelector('input[placeholder="Job Title"]')?.value,
                startDate: item.querySelector('input[type="month"]:first-of-type')?.value,
                endDate: item.querySelector('input[type="month"]:last-of-type')?.value,
                description: item.querySelector('textarea')?.value
            }));
        }
        function getProjects() {
            return Array.from(document.querySelectorAll('.project-item')).map(item => {
                const inputs = item.querySelectorAll('input');
                const textarea = item.querySelector('textarea');
                
                if (inputs.length >= 2) {
                    return {
                        title: inputs[0].value || '',
                        tech: inputs[1].value || '',
                        description: textarea ? textarea.value : ''
                    };
                }
                return { title: '', tech: '', description: '' };
            });
        }
        function getEducation() {
            return Array.from(document.querySelectorAll('.education-item')).map(item => {
                const inputs = item.querySelectorAll('input');
                const textarea = item.querySelector('textarea');
                const degree = inputs[0] ? inputs[0].value : '';
                const school = inputs[1] ? inputs[1].value : '';
                const year = inputs[2] ? inputs[2].value : '';
                const gpa = inputs[3] ? inputs[3].value : '';
                return {
                    degree: degree || '',
                    school: school || '',
                    year: year || '',
                    gpa: gpa || '',
                    description: textarea ? (textarea.value || '') : ''
                };
            }).filter(ed => ed.degree || ed.school || ed.year || ed.gpa || ed.description);
        }
        // Compress profile image if it exists to reduce payload size
        // Use profile image directly (server limits have been increased)
        
        const content = {
            name: document.getElementById('name').value,
            title: document.getElementById('title').value,
            email: document.getElementById('email').value,
            phone: document.getElementById('phone').value,
            summary: document.getElementById('summary').value,
            address: document.getElementById('address').value,
            skills: getSkills(),
            education: getEducation(),
            experience: getExperience(),
            projects: getProjects(),
            languages: getLanguages(),
            hobbies: getHobbies(),
            profileImage: window.profileImage || null
        };
        const resumeId = urlParams.get('resumeId');
        try {
            if (resumeId) {
                // Update existing resume
                await resumeAPI.update(resumeId, { title, template, content }, token);
                window.isResumeDirty = false;
                showSuccessModal('Resume updated successfully!', 'dashboard.html');

            } else {
                // Create new resume
                await resumeAPI.create({ title, template, content }, token);
                window.isResumeDirty = false;
                showSuccessModal('Resume saved successfully!', 'dashboard.html');
            }

            
            updateLanguagesInPreview(content.languages);
            updateHobbiesInPreview(content.hobbies);
        } catch (err) {
            console.error('Failed to save resume:', err);
            alert('Failed to save resume.');
            return;
        }
    });
    </script>
    <script>
           if (!Auth.requireAuth()) {
            // This will redirect to index.html if not authenticated
            // No need for additional code here
        }

        // Get user data from localStorage
        const user = JSON.parse(localStorage.getItem('user'));
 
        // Auto-fill name and email if user is logged in
        if (user) {
            if (user.fullName) {
                document.getElementById('name').value = user.fullName;
            }
            if (user.email) {
                document.getElementById('email').value = user.email;
            }
        }

        // Get template ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        let templateId = urlParams.get('template') || 'default';
      

        // Add dynamic form handling specific to this template
        addDynamicFormHandlers(templateId, {
            profileImage: `#profileImg-${templateId}`,
            nameElement: `#name-${templateId}`,
            titleElement: `#title-${templateId}`,
            // Add more selectors specific to this template
        });

        
        window.isResumeDirty = false;
        function markResumeDirty() { window.isResumeDirty = true; }
        document.addEventListener('input', function(e) {
            if (e.target && (e.target.closest('input') || e.target.closest('textarea'))) {
                markResumeDirty();
            }
        }, true);
        document.addEventListener('change', function(e) {
            if (e.target && (e.target.closest('select') || e.target.matches('input[type="file"]'))) {
                markResumeDirty();
            }
        }, true);
        window.addEventListener('beforeunload', function(e) {
            if (window.isResumeDirty) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
        document.addEventListener('click', function(e) {
            const link = e.target && e.target.closest && e.target.closest('a[href]');
            if (!link) return;
            const href = link.getAttribute('href');
            if (!href || href.startsWith('#') || href.startsWith('javascript:')) return;
            if (window.isResumeDirty) {
                const confirmLeave = window.confirm('You have unsaved changes. Leave this page and discard them?');
                if (!confirmLeave) {
                    e.preventDefault();
                } else {
                    window.isResumeDirty = false;
                }
            }
        }, true);

        // Preview functionality
        const previewToggle = document.getElementById('previewToggle');
        const rightPanel = document.querySelector('.right-panel');
        let isPreviewActive = false; 

        function togglePreview() {
          
            isPreviewActive = !isPreviewActive;
            rightPanel.classList.toggle('active');
            previewToggle.classList.toggle('active');
            previewToggle.innerHTML = isPreviewActive ? '<i class="fa-regular fa-eye-slash"></i>' : '<i class="fa-regular fa-eye"></i>';
            
            if (isPreviewActive) {
                updatePreview();
                if (typeof updateLanguagesInPreview === 'function') {
                    
                    try {
                        requestAnimationFrame(() => updateLanguagesInPreview());
                    } catch (_) {
                        updateLanguagesInPreview();
                    }
                }
            }
        }

        // Helper function to generate education preview
        function generateEducationPreview() {
            const educationItems = document.querySelectorAll('.education-item');
            let previewHTML = '';
            
            educationItems.forEach((item, index) => {
                const inputs = item.querySelectorAll('input');
                const textarea = item.querySelector('textarea');
                
                if (inputs.length >= 4) {
                    const degree = inputs[0].value || 'Degree';
                    const school = inputs[1].value || 'School/University';
                    const year = inputs[2].value || 'Year';
                    const gpa = inputs[3].value || '';
                    const description = textarea ? textarea.value : '';

                    if(templateId === 'it-3'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong><br>${school} • ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-4'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong><br>${school} • ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-8'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${school} - ${degree}</strong> <br> ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-9'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong><br>${school} <br> ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-1'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${school}</span>
                                <span class="text-sm mb-1 font-light">${year}</span>
                            </div>
                            <p class="text-sm mb-1">${degree}</p>
                            ${gpa ? `<p class="text-sm mb-1">GPA: ${gpa}</p>` : ''}
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-3'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong><br>${school} <br> ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-5'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong><br>${school} | ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-1'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong> | ${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            <p class="text-sm font-light">${school}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-3'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${year}</strong> <br> ${school}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            <p class="text-sm font-light">${degree}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-4'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong> <br> ${description}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            <p class="text-sm font-light">${school} - ${year}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-5'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong> <br> ${school} - ${year} ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }   
                    else if(templateId === 'business-6'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${year}</strong> <br> ${degree} - ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-7'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${year}</strong> <br> ${school} <br> ${degree} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-8'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${year}</strong> <br> ${school} <br> ${degree} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }    
                    else if(templateId === 'business-10'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${school}</span>
                                <span class="text-sm mb-1 font-light">${year}</span>
                            </div>
                            <p class="text-sm mb-1">${degree}</p>
                            ${gpa ? `<p class="text-sm mb-1">GPA: ${gpa}</p>` : ''}
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'civil-1'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold text-blue-600 font-medium">${degree}</span>
                                <span class="text-sm mb-1">${year}</span>
                            </div>
                            <p class="text-sm mb-1">${school}</p>
                            ${gpa ? `<p class="text-sm mb-1">GPA: ${gpa}</p>` : ''}
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'civil-2'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong class="text-[#2A7F8E]">${year}</strong> <br> ${school} <br> ${degree} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'civil-3'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'civil-4'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }  
                    else if(templateId === 'civil-5'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }  
                    else if(templateId === 'civil-6'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    } 
                    else if(templateId === 'civil-7'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }    
                    else if(templateId === 'civil-8'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'civil-9'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'civil-10'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree} | ${year}</strong> <br> ${school} <br> ${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }        
                    else if(templateId === 'generic-1'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong><br>${school}<br>${year}${gpa ? `<br>GPA: ${gpa}` : ''}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    } 
                    else if(templateId === 'generic-2'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong><br>${year} ${school}${gpa ? `<br>GPA: ${gpa}` : ''}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }  
                    else if(templateId === 'generic-3'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong><br>${year} ${school}${gpa ? `<br>GPA: ${gpa}` : ''}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }         
                    else if(templateId === 'generic-6'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong><br>${year} ${school}${gpa ? `<br>GPA: ${gpa}` : ''}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'generic-7'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong> (${gpa ? `GPA: ${gpa}` : ''}), ${school}, ${year}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'generic-8'){
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <i class="text-sm"><strong>${degree}</strong>,${school} <br> ${year} <br>${gpa ? `<br>GPA: ${gpa}` : ''}</i>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else{
                        previewHTML += `
                        <div class="education-preview-item" style="margin-bottom: ${index < educationItems.length - 1 ? '1rem' : '0'};">
                            <p class="text-sm"><strong>${degree}</strong><br>${school}<br>${year}${gpa ? `<br>GPA: ${gpa}` : ''}</p>
                            ${description ? `<p class="text-sm mt-1">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    
                    
                }
            });
            
            return previewHTML || '<p class="text-sm"><strong>Bachelor of Information Technology</strong><br>Capas Tarlac<br>2022–2025</p>';
        }

        // Helper function to generate experience preview
        function generateExperiencePreview() {
            const experienceItems = document.querySelectorAll('.experience-item');
            let previewHTML = '';
            
            experienceItems.forEach((item, index) => {
                const inputs = item.querySelectorAll('input');
                const textarea = item.querySelector('textarea');
                
                if (inputs.length >= 4) {
                    const company = inputs[0].value || 'Company Name';
                    const position = inputs[1].value || 'Job Title';
                    const startDate = inputs[2].value || '';
                    const endDate = inputs[3].value || '';
                    const description = textarea ? textarea.value : '';
                    
                    const dateRange = startDate && endDate ? `${startDate} - ${endDate}` : 
                                    startDate ? `${startDate} - Present` : 'Date Range';
                    
                    if(templateId === 'it-1'){
                        previewHTML += `
                            <p class="text-sm font-bold">${dateRange}</p>
                            <p class="text-sm mb-1">${position}</p>
                            <p class="text-sm mb-4">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-2'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            <p class="text-sm mb-1">${company}</p>
                            <p class="text-sm">${dateRange}</p>         
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-3'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            <p class="text-sm mb-1">${company} • ${dateRange}  </p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-4'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            <p class="text-sm mb-1">${company} • ${dateRange}  </p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-5'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${company}</span>
                                <span>(${dateRange})</span>
                            </div>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-7'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${company}</span>
                                <span>(${dateRange})</span>
                            </div>
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-8'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${company}</span>
                                <span>(${dateRange})</span>
                            </div>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'it-10'){
                        previewHTML += `
                         <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            <p class="text-sm mb-4">${company}</p>
                            <p class="text-sm">${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }else if(templateId === 'accountant-1'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${position}</span>
                                <span class="text-sm mb-1 font-light">${dateRange}</span>
                            </div>
                            <p class="text-sm mb-4">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-3'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}</p>
                            <p class="text-sm mb-1 font-light">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-4'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}</p>
                            <p class="text-sm mb-1 font-light">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-5'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${company}</span>
                                <span class="text-sm mb-1 font-light">${dateRange}</span>
                            </div>
                            <p class="text-sm mb-4">${position}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-6'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}</p>
                            <p class="text-sm mb-1 font-bold">${company}</p>
                            <p class="text-sm mb-4">${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-7'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${dateRange}</p>
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            <p class="text-sm mb-4">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-8'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}</p>
                            <p class="text-sm mb-1 font-bold">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'accountant-9'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${company}</p>
                            <i class="text-sm mb-1">${position} | ${dateRange}</i>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-1'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}</p>
                            <p class="text-sm mb-1 font-bold">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-2'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${position}</span>
                                <span class="text-sm mb-1 font-light">${dateRange}</span>
                            </div>
                            <p class="text-sm mb-4">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-4'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}</p>
                            <p class="text-sm mb-1 font-light">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'business-5'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position} - ${company}</p>
                            <i class="text-sm mb-1 font-light">${dateRange}</i>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'business-7'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}<br>${company}</p>
                            <i class="text-sm mb-1 font-light">${dateRange}</i>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'business-8'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}<br></p>
                            <i class="text-sm mb-1 font-light">${company}</i><br>
                            <i class="text-sm mb-1 font-light">${dateRange}</i>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'business-9'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}<br>${company}</p>
                           
                            <p class="text-sm mb-1 font-light">${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'business-10'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold">${position}<br>${company}</p>
                           
                            <p class="text-sm mb-1 font-light">${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-1'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold text-blue-600 font-medium">${position}<br></p>
                            <p class="text-sm">${company}</p>
                            <p class="text-sm mb-1 font-light">${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-2'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-3'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-medium">${position}<br></p>
                            <p class="text-sm font-bold">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-4'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-medium">${position}<br></p>
                            <p class="text-sm font-bold">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-5'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-medium">${position}<br></p>
                            <p class="text-sm font-bold">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-6'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position} <span>${dateRange}</span><br></p>
                            <i class="text-sm">${company}</i>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-7'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${dateRange} · <span>${position} / ${company}</span><br></p>
                            <i class="text-sm">${company}</i>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-8'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position} <span>${dateRange}</span><br></p>
                            <p class="text-sm">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-9'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'civil-10'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} | ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-1'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} - ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-3'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} - ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-4'){
                        previewHTML += `
                        <div class="experience-preview-item" 
                            style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            
                            <!-- Left side -->
                            <div class="experience-left" style="flex: 1;">
                                <p class="text-sm font-bold font-medium">${position}<br></p>
                                <p class="text-sm">${company} - ${dateRange}</p>
                            </div>
                            
                            <!-- Right side -->
                            ${description ? `
                            <div class="experience-right" style="flex: 1; text-align: left; padding-left: 1rem;">
                                <p class="text-sm leading-relaxed">${description}</p>
                            </div>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-5'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} - ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-6'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company} - ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                     else if(templateId === 'generic-7'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                             ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                            <p class="text-sm">${company} to ${dateRange}</p>
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-8'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${position}</span>
                                <span class="text-sm mb-1 font-light">${dateRange}</span>
                            </div>
                            <p class="text-sm mb-4">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else if(templateId === 'generic-9'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm font-bold font-medium">${position}<br></p>
                            <p class="text-sm">${company}  ${dateRange}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;  
                    }
                    else if(templateId === 'generic-10'){
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <div class="flex justify-between text-sm font-semibold">
                                <span class="text-sm mb-1 font-bold">${position}</span>
                                <span class="text-sm mb-1 font-light">${dateRange}</span>
                            </div>
                            <p class="text-sm mb-4 font-semibold">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                    else{
                        previewHTML += `
                        <div class="experience-preview-item" style="margin-bottom: ${index < experienceItems.length - 1 ? '2rem' : '0'};">
                            <p class="text-sm">${dateRange}</p>
                            <p class="text-sm mb-1 font-bold">${position}</p>
                            <p class="text-sm mb-4">${company}</p>
                            ${description ? `<p class="text-sm leading-relaxed">${description}</p>` : ''}
                        </div>
                    `;
                    }
                   
                   
                }

            });
            
            return previewHTML || `
                <p class="text-sm font-bold">2019 - 2022</p>
                <p class="text-sm mb-1">Job position here</p>
                <p class="text-sm mb-4">Company Name | Location</p>
                <p class="text-sm leading-relaxed">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam pharetra in lorem at laoreet. Donec hendrerit libero eget est tempor, quis tempus arcu elementum. In elementum elit at dui tristique.
                </p>
            `;
        }

        // Helper function to generate projects preview
        function generateProjectsPreview() {
            const projectItems = document.querySelectorAll('.project-item');
            let previewHTML = '';
            
            projectItems.forEach((item, index) => {
                const inputs = item.querySelectorAll('input');
                const textarea = item.querySelector('textarea');
                
                if (inputs.length >= 2) {
                    const name = inputs[0].value || 'Project Name';
                    const technologies = inputs[1].value || '';
                    const description = textarea ? textarea.value : '';
                    
                    if(templateId === 'it-6'){
                        previewHTML += `
                        <div class="project-preview-item" style="margin-bottom: ${index < projectItems.length - 1 ? '1.5rem' : '0'};">
                            <p class="text-sm text-white font-semibold">${name}</p>
                            ${description ? `<p class="text-sm mb-2 text-white">${description}</p>` : ''}
                            ${technologies ? `<p class="text-sm text-white">Technologies: ${technologies}</p>` : ''}
                        </div>
                    `;
                    }else{
                        previewHTML += `
                        <div class="project-preview-item" style="margin-bottom: ${index < projectItems.length - 1 ? '1.5rem' : '0'};">
                            <p class="text-sm font-semibold">${name}</p>
                            ${description ? `<p class="text-sm mb-2">${description}</p>` : ''}
                            ${technologies ? `<p class="text-sm">Technologies: ${technologies}</p>` : ''}
                        </div>
                    `;
                    }
                  
                }

            });
            
            // Only return content if user actually added any project data
            return previewHTML;
        }

        function updatePreview() {
            const previewContainer = document.getElementById('resume-preview');
            
            // Clear previous preview
            previewContainer.innerHTML = '';
            
            // Create preview based on template
            if (templateId === 'it-1') {
                // IT Template 1 Preview
                const preview = document.createElement('div');
                preview.className = ' max-w-[210mm] w-[210mm] mx-auto bg-[#fdfaf8] shadow-md pb-8';
                preview.innerHTML = `
                    <!-- HEADER -->
                    <div class="flex items-center p-6 bg-[#582b2a] text-white">
                        <div class="shrink-0">
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile Picture" class="w-[110px] h-[110px] object-cover rounded-full border-4 border-white bg-white">
                        </div>
                        <div class="ml-40">
                            <h1 class="text-3xl font-bold leading-tight">${document.getElementById('name')?.value || 'Your Name'}</h1>
                            <p class="text-sm">${document.getElementById('title')?.value || 'Professional Title'}</p>
                        </div>
                    </div>

                    <!-- MAIN -->
                    <div class="flex bg-[#fdfaf8]">
                        
                        <!-- LEFT COLUMN -->
                        <div class="w-[35%] p-8 border-r border-gray-300 flex flex-col items-center text-black">

                            <div class="w-full mb-8">
                                <h2 class="bg-[#9e4644] text-white text-center py-2 text-sm rounded mb-4">Contact</h2>
                                <p class="text-sm mb-2"><strong>Phone</strong><br>${document.getElementById('phone')?.value}</p>
                                <p class="text-sm mb-2"><strong>Email</strong><br>${document.getElementById('email')?.value}</p>
                                <p class="text-sm"><strong>Address</strong><br>${document.getElementById('address')?.value}</p>
                            </div>

                            <div class="w-full mb-8">
                                <h2 class="bg-[#9e4644] text-white text-center py-2 text-sm rounded mb-4">Education</h2>
                                <div id="education-preview-list">
                                    ${generateEducationPreview()}
                                </div>
                            </div>

                            <div class="w-full">
                                <h2 class="bg-[#9e4644] text-white text-center py-2 text-sm rounded mb-4">Skills</h2>
                                <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                                   
                                </ul>
                            </div>

                        </div>

                         <!-- RIGHT COLUMN -->
                        <div class="w-[65%] p-8 text-black">
                            <div class="mb-8">
                            <section class="mb-8">
                                <h2 class="text-lg uppercase border-b-2 border-gray-300 pb-2 mb-4">About</h2>
                                <p class="text-sm leading-relaxed">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </section>
                             <section class="mb-8">
                                <h2 class="text-lg uppercase border-b-2 border-gray-300 pb-2 mb-4">Experience</h2>
                                <div id="experience-preview">
                                    ${generateExperiencePreview()}
                                </div>
                            </section>

                            <section class="mb-8">      
                                <h2 class="text-lg uppercase border-b-2 border-gray-300 pb-2 mb-4">Projects</h2>
                                <div id="projects-preview">
                                    ${generateProjectsPreview()}
                                </div>
                            </section>
                            
                        </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
            } else if(templateId === 'it-2'){
                // IT Template 2 Preview (matches static it-template-2.html)
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto w-full font-sans text-black bg-white shadow-md grid grid-cols-3';
                preview.innerHTML = `
                    <!-- Left Column -->
                    <div class="col-span-1 bg-gray-100 p-6 space-y-6 text-sm">
                        <!-- Image -->
                        <div class="flex justify-center">
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile" class="w-32 h-32 rounded-md border-4 border-slate-700 object-cover" />
                        </div>
                        <!-- Contact -->
                        <div>
                            <h2 class="text-lg font-bold mb-2">Contact</h2>
                            <hr class="border-t-2 border-slate-700 mb-2">
                            <p>📞 ${document.getElementById('phone')?.value}</p>
                            <p>✉️ ${document.getElementById('email')?.value}</p>
                            <p>📍 ${document.getElementById('address')?.value}</p>
                        </div>
                        <!-- About -->
                        <div>
                            <h2 class="text-lg font-bold mb-2">About</h2>
                            <hr class="border-t-2 border-slate-700 mb-2">
                            <p>
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>
                        <!-- Skills -->
                        <div>
                            <h2 class="text-lg font-bold mb-2">Skills</h2>
                            <hr class="border-t-2 border-slate-700 mb-2">
                            <ul class="list-disc list-inside space-y-1" id="skills-preview">
                              
                            </ul>
                        </div>
                    </div>
                    <!-- Right Column -->
                    <div class="col-span-2 bg-slate-700 text-white p-8 space-y-8">
                        <!-- Header -->
                        <div>
                            <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                            <p class="text-lg">${document.getElementById('title')?.value || 'IT Professional'}</p>
                        </div>
                        <!-- Work Experience -->
                        <div>
                            <h2 class="bg-white text-slate-700 inline-block px-4 py-1 rounded-full font-bold mb-4">Work Experience</h2>
                            <div class="space-y-4 border-l-2 border-white pl-4" id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                        <!-- Projects -->
                        <div>
                            <h2 class="bg-white text-slate-700 inline-block px-4 py-1 rounded-full font-bold mb-4">Projects</h2>
                            <div class="space-y-4 border-l-2 border-white pl-4" id="projects-preview">
                                ${generateProjectsPreview()}
                            </div>
                        </div>
                        <!-- Education -->
                        <div>
                            <h2 class="bg-white text-slate-700 inline-block px-4 py-1 rounded-full font-bold mb-4">Education</h2>
                            <div class="space-y-4 border-l-2 border-white pl-4" id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                        </div>
                       
                        <!-- Language -->
                        <div>
                            <h2 class="bg-white text-slate-700 inline-block px-4 py-1 rounded-full font-bold mb-4">Language</h2>
                            <ul class="list-disc list-inside text-sm space-y-1 border-l-2 border-white pl-4" id="languages-preview">
                                
                            </ul>
                        </div>
                    </div>
                `;
                previewContainer.appendChild(preview);
            } else if(templateId === 'it-3'){
                // IT Template 3 Preview (matches static it-template-3.html)
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] w-full font-sans text-black bg-white shadow-md';
                preview.innerHTML = `
                    <!-- Header -->
                    <div class="bg-slate-800 text-white px-8 py-6 flex items-center gap-6">
                        <!-- Profile Image -->
                        <div>
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile" class="w-24 h-24 rounded-full object-cover border-4 border-blue-500" />
                        </div>
                        <!-- Name and Title -->
                        <div>
                            <h1 class="text-3xl font-bold leading-tight">${(document.getElementById('name')?.value)}</h1>
                            <p class="text-blue-300 text-lg">${document.getElementById('title')?.value}</p>
                        </div>
                    </div>
                    <!-- Main Content -->
                    <div class="grid grid-cols-10">
                        <!-- Left Column -->
                        <div class="col-span-3 bg-gray-100 p-6 space-y-6 text-sm">
                            <!-- Contact -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">Contact</h2>
                                <hr class="border-t-2 border-blue-700 mb-2" />
                                <p>📞 ${document.getElementById('phone')?.value}</p>
                                <p>✉️ ${document.getElementById('email')?.value}</p>
                                <p>📍 ${document.getElementById('address')?.value}</p>
                            </div>
                            <!-- Skills -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">Skills</h2>
                                <hr class="border-t-2 border-blue-700 mb-2" />
                                <ul class="list-disc list-inside space-y-1" id="skills-preview">
                                   
                                </ul>
                            </div>
                            <!-- Languages -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">Languages</h2>
                                <hr class="border-t-2 border-blue-700 mb-2" />
                                <ul class="list-disc list-inside space-y-1" id="languages-preview">
                                    
                                </ul>
                            </div>
                        </div>
                        <!-- Right Column -->
                        <div class="col-span-7 p-8 space-y-8">
                            <!-- About -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">About Me</h2>
                                <hr class="border-t-2 border-blue-700 mb-2" />
                                <p class="text-sm">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>
                            <!-- Work Experience -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">Work Experience</h2>
                                <hr class="border-t-2 border-blue-700 mb-4" />
                                <div class="space-y-4" id="experience-preview"></div>
                            </div>

                             <!-- Projects -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">Projects</h2>
                                <hr class="border-t-2 border-blue-700 mb-4" />
                                <div class="space-y-4" id="projects-preview">
                                    ${generateProjectsPreview()}
                                </div>
                            </div>
                            
                            <!-- Education -->
                            <div>
                                <h2 class="text-blue-700 font-bold text-lg mb-2">Education</h2>
                                <hr class="border-t-2 border-blue-700 mb-4" />
                                <div class="space-y-4" id="education-preview-list">
                                    ${generateEducationPreview()}
                                </div>
                            </div>
                           
                        </div>
                    </div>
                `;
                previewContainer.appendChild(preview);
            }
            else if(templateId === 'it-4'){

                
                // IT Template 4 Preview (matches static it-template-4.html)
                const preview = document.createElement('div');
                preview.className = 'font-sans text-black bg-white shadow-md grid grid-cols-3 min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto';
                preview.innerHTML = `
                    <!-- Header -->
                    <div class="col-span-1 bg-slate-700 text-white p-6 space-y-6 text-sm shadow-lg">
                        <!-- Image -->
                        <div class="flex justify-center">
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile" class="w-32 h-32 rounded-md object-cover border-4 border-slate-500" />
                        </div>

                        <!-- Contact -->
                        <div>
                            <h2 class="text-lg font-bold mb-2">Contact</h2>
                            <hr class="border-t-2 border-slate-500 mb-2" />
                            <p class="text-gray-300">📞 ${document.getElementById('phone')?.value}</p>
                            <p class="text-gray-300">✉️ ${document.getElementById('email')?.value}</p>
                            <p class="text-gray-300">📍 ${document.getElementById('address')?.value}</p>
                        </div>

                        <!-- Skills -->
                        <div>
                            <h2 class="text-lg font-bold mb-2">Skills</h2>
                            <hr class="border-t-2 border-slate-500 mb-2" />
                            <ul class="list-disc list-inside space-y-1 text-gray-200" id="skills-preview">
                               
                            </ul>
                        </div>

                        <!-- Languages -->
                        <div>
                            <h2 class="text-lg font-bold mb-2">Languages</h2>
                            <hr class="border-t-2 border-slate-500 mb-2" />
                            <ul class="list-disc list-inside space-y-1 text-gray-200" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>


                    <!-- Right Column -->
                    <div class="col-span-2 bg-white p-8 space-y-8">
                        <!-- Header -->
                        <div class="text-center">
                            <br>
                            <h1 class="text-3xl font-bold text-slate-800">${document.getElementById('name')?.value}</h1>
                            <p class="text-lg text-gray-600">${document.getElementById('title')?.value}</p>
                        </div>

                        <!-- About Section -->
                        <div class="bg-slate-700 text-white p-6 shadow-lg">
                            <h2 class="text-xl font-bold mb-2">About Me</h2>
                            <p>
                            ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Work Experience -->
                        <div class="bg-slate-700 text-white p-6 shadow-lg">
                            <h2 class="text-xl font-bold mb-2">Work Experience</h2>
                            <div class="mt-4 space-y-4" id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                        <!-- Education -->
                        <div class="bg-slate-700 text-white p-6 shadow-lg">
                            <h2 class="text-xl font-bold mb-2">Education</h2>
                            <div class="mt-4 space-y-4" id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                        </div>
                        <!-- Projects -->
                        <div class="bg-slate-700 text-white p-6 shadow-lg">
                            <h2 class="text-xl font-bold mb-2">Projects</h2>
                            <div class="mt-4 space-y-4" id="projects-preview">
                                ${generateProjectsPreview()}
                            </div>
                        </div>
                    </div>
                `;
                previewContainer.appendChild(preview);
                } else if(templateId === 'it-5'){

                    // IT Template 5 Preview (matches static it-template-5.html)
                    const preview = document.createElement('div');
                    preview.className = 'font-sans text-black bg-white shadow-m min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto';
                    preview.innerHTML = `
                        <!-- Red Bar -->
                        <div class="bg-red-700 h-6 w-full"></div>

                        <!-- Content: Two Columns -->
                        <div class="grid grid-cols-3 gap-0">

                            <!-- Left Column (Gray Background) -->
                            <div class="col-span-1 bg-gray-100 p-6 flex flex-col items-center space-y-8">
                                
                                <!-- Profile Image -->
                                <img src="${window.profileImage || profileImage || ''}" alt="Profile" 
                                    class="w-32 h-32 rounded-full border-4 border-red-700 object-cover">

                                <!-- Contact -->
                                <div class="w-full">
                                    <h3 class="font-bold text-gray-700 mb-3">CONTACT</h3>
                                    <p class="flex items-center gap-2 text-sm"><span>📞</span> ${document.getElementById('phone')?.value}</p>
                                    <p class="flex items-center gap-2 text-sm"><span>✉️</span> ${document.getElementById('email')?.value}</p>
                                    <p class="flex items-center gap-2 text-sm"><span>📍</span> ${document.getElementById('address')?.value}</p>
                                </div>

                                <!-- Education -->
                                <div class="w-full">
                                    <h3 class="font-bold text-gray-700 mb-3">EDUCATION</h3>
                                    <div id="education-preview-list">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>

                                <!-- Skills -->
                                <div class="w-full">
                                    <h3 class="font-bold text-gray-700 mb-3">SKILLS</h3>
                                    <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                                        
                                    </ul>
                                </div>

                                <!-- Languages -->
                                <div class="w-full">
                                    <h3 class="font-bold text-gray-700 mb-3">LANGUAGES</h3>
                                    <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                                      
                                    </ul>
                                </div>
                            </div>

                            <!-- Right Column -->
                            <div class="col-span-2 p-8 space-y-8">
                                
                                <!-- Name -->
                                <div class="border-b border-gray-300 pb-4">
                                    <br>
                                    <h2 class="text-4xl font-bold tracking-wide">${document.getElementById('name')?.value}</h2>
                                    <br>
                                </div>

                                <!-- About -->
                                <div>
                                    <h3 class="font-bold text-gray-700 border-b-2 border-gray-400 inline-block pb-1 mb-3">
                                        ABOUT
                                    </h3>
                                    <p class="text-sm leading-relaxed text-gray-600">
                                        ${document.getElementById('summary')?.value}
                                    </p>
                                </div>

                                <!-- Experience -->
                                <div>
                                    <h3 class="font-bold text-gray-700 border-b-2 border-gray-400 inline-block pb-1 mb-3">
                                        EXPERIENCE
                                    </h3>
                                    <div id="experience-preview">
                                        ${generateExperiencePreview()}
                                    </div>
                                </div>
                                <!-- Projects -->
                                <div>
                                    <h3 class="font-bold text-gray-700 border-b-2 border-gray-400 inline-block pb-1 mb-3">
                                        PROJECTS
                                    </h3>
                                    <div id="projects-preview">
                                        ${generateProjectsPreview()}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Red Bar -->
                        <div class="bg-red-700 h-6 w-full"></div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'it-6'){

                    // IT Template 6 Preview (matches static it-template-6.html)
                    const preview = document.createElement('div');
                    preview.className = 'font-sans text-black bg-white shadow-m min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto';
                    preview.innerHTML = `
                        <!-- Main Grid -->
                        <div class="grid grid-cols-3">
                        <!-- Left Sidebar -->
                        <div class="col-span-1 bg-red-400 p-6 flex flex-col space-y-8">
                            <!-- Profile Image -->
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile"
                                class="w-32 h-32 object-cover border-2 border-black mx-auto">

                            <!-- About -->
                            <div>
                            <h3 class="text-white font-bold border-b border-white pb-1 mb-3">ABOUT</h3>
                            <p class="text-sm text-white">
                                ${document.getElementById('summary')?.value}
                            </p>
                            </div>

                            <!-- Skills -->
                            <div>
                            <h3 class="text-white font-bold border-b border-white pb-1 mb-3">SKILLS</h3>
                            <ul class="list-disc list-inside text-white text-sm space-y-1" id="skills-preview">
                               
                            </ul>
                            </div>

                            <!-- Language -->
                            <div>
                            <h3 class="text-white font-bold border-b border-white pb-1 mb-3">LANGUAGE</h3>
                            <ul class="list-disc list-inside text-white text-sm space-y-1" id="languages-preview">
                               
                            </ul>
                            </div>
                            <!-- Projects -->
                            <div>
                                <h3 class="text-white font-bold border-b border-white pb-1 mb-3">Project</h3>
                                <div id="projects-preview">
                                    ${generateProjectsPreview()}
                                </div>
                            </div>                        
                        </div>

                        <!-- Right Content -->
                        <div class="col-span-2 flex flex-col">
                            <!-- Header -->
                            <div class="bg-gray-50 p-8">
                            <br>
                            <h1 class="text-4xl font-bold">${document.getElementById('name')?.value}</h1>
                            <h2 class="text-lg text-gray-500 tracking-wide">${document.getElementById('title')?.value}</h2>
                            </div>

                            <!-- Main Content -->
                            <div class="p-8 space-y-10">
                            <!-- Work Experience -->
                            <div>
                                <h3 class="text-gray-700 font-bold text-lg border-b border-gray-300 pb-1 mb-4">WORK EXPERIENCE</h3>
                                <div id="experience-preview">
                                    ${generateExperiencePreview()}
                                </div>
                            </div>

                            <!-- Education -->
                            <div>
                                <h3 class="text-gray-700 font-bold text-lg border-b border-gray-300 pb-1 mb-4">EDUCATION</h3>
                                <div id="education-preview-list" class="text-white">
                                    
                                    ${generateEducationPreview()}
                                </div>
                            </div>
                        
                            </div>
                        </div>
                        </div>

                        <!-- Footer Contact (outside grid) -->
                        <div class="bg-gray-100 p-6 flex justify-around text-sm text-gray-700">
                        <p>${document.getElementById('phone')?.value}</p>
                        <p>${document.getElementById('email')?.value}</p>
                        <p>${document.getElementById('address')?.value}</p>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'it-7'){

                    // IT Template 7 Preview (matches static it-template-7.html)
                    const preview = document.createElement('div');
                    preview.className = 'font-sans text-black bg-white shadow-md flex text-[0.9rem] leading-relaxed min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto';
                    preview.innerHTML = `
                        <!-- Left Red Bar (5%) -->
                        <div class="w-[0%]   border-r-2 border-black"></div>

                        <!-- Middle Gray Column (30%) -->
                        <div class="w-[30%] bg-gray-200 border-r-2 border-black p-5">
                        <!-- Profile Image -->
                        <div class="flex justify-center mb-5">
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile Photo" class="w-28 h-28 rounded-full border-4 border-white">
                        </div>

                        <!-- Skills -->
                        <div class="mb-5">
                            <h2 class="text-l font-bold text-center border border-black rounded-full py-1.5 mb-3">SKILLS</h2>
                            <ul class="space-y-1.5" id="skills-preview">
                           
                            </ul>
                        </div>

                        <!-- Language -->
                        <div class="mb-5">
                            <h2 class="text-l font-bold text-center border border-black rounded-full py-1.5 mb-3">LANGUAGE</h2>
                            <ul class="space-y-1.5" id="languages-preview">
                            
                            </ul>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="text-l font-bold text-center border border-black rounded-full py-1.5 mb-3">EDUCATION</h2>
                            <div id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                        </div>
                        </div>

                        <!-- Right Main Column (65%) -->
                        <div class="w-[65%]  p-7">
                        <!-- Header -->
                        <br>
                        <h1 class="text-4xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-base text-gray-800 mb-4 pl-12">${document.getElementById('title')?.value}</p>
                        <br>
                        <!-- Contact -->
                        <div class="mb-6 space-y-1 pl-12">
                            <p>${document.getElementById('phone')?.value}</p>
                            <p>${document.getElementById('email')?.value}</p>
                            <p>${document.getElementById('address')?.value}</p>
                        </div>
                        <hr>
                        <br>
                        <!-- About -->
                        <div class="mb-7">
                            <h2 class="text-l font-bold border border-black rounded-full py-1.5 px-4 inline-block mb-3">ABOUT</h2>
                            <p>
                            ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Experience -->
                        <div>
                            <h2 class="text-l font-bold border border-black rounded-full py-1.5 px-4 inline-block mb-3">EXPERIENCE</h2>
                            <div id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                        </div>
                        <!-- Projects -->
                        <div>
                            <h2 class="text-l font-bold border border-black rounded-full py-1.5 px-4 inline-block mb-3">PROJECTS</h2>
                            <div id="projects-preview">
                                ${generateProjectsPreview()}
                            </div>
                        </div>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'it-8'){

                    // IT Template 8 Preview (matches static it-template-8.html)
                    const preview = document.createElement('div');
                    preview.className = 'font-sans text-black shadow-md flex overflow-hidden flex-col min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto';
                    preview.innerHTML = `
                         <!-- Header -->
                        <div class="flex justify-between bg-gray-100 px-10 py-6 items-center">
                            <div>
                            <h1 class="text-4xl font-bold leading-none">${document.getElementById('name')?.value}</h1>
                            <div class="mt-4 text-sm text-gray-600">
                                <p>${document.getElementById('phone')?.value}</p>
                                <p>${document.getElementById('email')?.value}</p>
                                <p>${document.getElementById('address')?.value}</p>
                            </div>
                            </div>
                            <div>
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile" class="w-36 h-36 rounded-full border-4 border-black object-cover" />
                            </div>
                        </div>

                        <!-- Professional Title -->
                        <div class="bg-black text-white font-bold text-center py-2 text-lg tracking-widest">
                            ${document.getElementById('title')?.value}
                        </div>

                        <!-- Main Content -->
                        <div class="flex">

                            <!-- Left Column -->
                            <div class="w-[60%] bg-gray-100 px-10 py-6">
                                
                            <!-- Experiences -->
                            <div class="mb-6">
                            <div class="inline-block border border-black rounded-full px-4 py-1 font-bold mb-4">
                                EXPERIENCES
                            </div>
                            <div id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                            </div>
                             <!-- Projects -->
                            <div>
                                <div class="inline-block border border-black rounded-full px-4 py-1 font-bold mb-4">
                                PROJECTS
                                </div>
                                <div id="projects-preview">
                                    ${generateProjectsPreview()}
                                </div>
                            </div>

                            <!-- Education -->
                            <div>
                                <div class="inline-block border border-black rounded-full px-4 py-1 font-bold mb-4">
                                EDUCATION
                                </div>
                                <div id="education-preview-list">
                                    ${generateEducationPreview()}
                                </div>
                            </div>
                           
                            </div>

                            <!-- Right Column -->
                            <div class="w-[40%] bg-white px-10 py-6">
                            <!-- Summary -->
                            <p class="text-sm text-gray-700 mb-6">
                                ${document.getElementById('summary')?.value}
                            </p>

                            <!-- Skills -->
                            <div class="mb-6">
                                <div class="inline-block border border-black rounded-full px-4 py-1 font-bold mb-4">
                                SKILLS
                                </div>
                                <ul class="list-disc list-inside text-sm space-y-2" id="skills-preview">
                               
                                </ul>
                            </div>

                            <!-- Languages -->
                            <div>
                                <div class="inline-block border border-black rounded-full px-4 py-1 font-bold mb-4">
                                LANGUAGES
                                </div>
                                <ul class="gap-10 text-sm text-gray-800 list-disc ml-5" id="languages-preview">
                                   
                                </ul>
                            </div>
                            </div>

                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'it-9'){

                    // IT Template 9 Preview (matches static it-template-9.html)
                    const preview = document.createElement('div');
                    preview.className = 'font-sans text-black shadow-md flex overflow-hidden flex-col min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto';
                    preview.innerHTML = `
                        <!-- Header -->
                        <div class="flex items-center px-10 pt-6">
                        <img src="${window.profileImage || profileImage || ''}" class="w-32 h-32 rounded-full border-4 border-white object-cover z-10" alt="Profile">
                        <div class="relative -ml-8 w-full">
                            <div class="bg-slate-700 text-white pl-16 py-4 clip-path-diagonal">
                            <h1 class="text-4xl font-serif font-bold ">${document.getElementById('name')?.value}</h1>
                            <p class=" text-sm font-semibold tracking-wide">${document.getElementById('title')?.value}</p>
                            </div>
                        </div>
                        </div>

                        <!-- Body -->
                        <div class="flex divide-x divide-black mt-6">

                        <!-- Left Sidebar -->
                        <div class="w-[40%] bg-gray-200 px-6 py-8 space-y-8">

                            <!-- About -->
                            <div>
                            <div class="border border-black rounded-full px-4 py-1 font-semibold text-center mb-2">ABOUT</div>
                            <p class="text-sm">${document.getElementById('summary')?.value}</p>
                            </div>

                            <!-- Education -->
                            <div>
                            <div class="border border-black rounded-full px-4 py-1 font-semibold text-center mb-2">EDUCATION</div>
                            <div id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                            </div>

                            <!-- Language -->
                            <div>
                            <div class="border border-black rounded-full px-4 py-1 font-semibold text-center mb-2">LANGUAGE</div>
                            <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                               
                            </ul>
                            </div>

                        </div>

                        <!-- Right Content -->
                        <div class="w-[60%] px-6 py-8 space-y-8">

                            <!-- Experience -->
                            <div>
                            <div class="border border-black rounded-full px-4 py-1 font-semibold text-center mb-4 w-fit">EXPERIENCE</div>
                            <div id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                            <hr class="border-gray-400">
                            </div>
                            <!-- Projects -->
                            <div>
                                <div class="border border-black rounded-full px-4 py-1 font-semibold text-center mb-4 w-fit">PROJECTS</div>
                                    <div id="projects-preview">
                                        ${generateProjectsPreview()}
                                    </div>
                                <hr class="border-gray-400">
                                </div>

                            <!-- Skills -->
                            <div>
                                <div class="font-bold mb-4 text-base">SKILLS</div>
                                <ul class="list-disc list-inside space-y-2 text-sm" id="skills-preview">
                                    
                                </ul>
                            </div>

                        </div>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'it-10'){

                    // IT Template 10 Preview (matches static it-template-10.html)
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto flex min-h-screen bg-[#fdfaf8] shadow-md';
                    preview.innerHTML = `
                         <!-- Left Column -->
                        <div class="w-1/2 p-8 bg-white border-r-2 border-gray-300">
                        <div class="mb-8">
                            <h1 class="text-3xl font-bold text-[#000] mb-1">${document.getElementById('name')?.value}</h1>
                            <p class="text-gray-500 text-lg mb-6">${document.getElementById('title')?.value}</p>
                        </div>

                        <div class="mb-8">
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">Work Experience</h2>
                            <div id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                        <div class="mb-8">
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">Projects</h2>
                            <div id="projects-preview">
                                ${generateProjectsPreview()}
                            </div>
                        </div>


                        <div class="mb-8">
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">Education</h2>
                            <div id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                        </div>

                        <div>
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">Language</h2>
                            <ul class="list-disc list-inside" id="languages-preview">
                              
                            </ul>
                        </div>
                        </div>

                        <!-- Right Column -->
                        <div class="w-1/2 p-8 bg-[#f3dcdc]">
                        <div class="flex justify-center mb-8">
                            <img src="${window.profileImage || profileImage || ''}" alt="Profile Picture" class="w-[130px] h-[130px] object-cover rounded-full border-[4px] border-[#582b2a]">
                        </div>

                        <div class="mb-8">
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">Contact</h2>
                            <p class="mb-1">Phone: ${document.getElementById('phone')?.value}</p>
                            <p class="mb-1">Email: ${document.getElementById('email')?.value}</p>
                            <p>Location: ${document.getElementById('address')?.value}</p>
                        </div>

                        <div class="mb-8">
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">About</h2>
                            <p>${document.getElementById('summary')?.value}</p>
                        </div>

                        <div>
                            <h2 class="text-xl uppercase border-b-2 border-[#582b2a] pb-2 mb-4">Skills</h2>
                            <ul class="list-disc list-inside" id="skills-preview">
                               
                            </ul>
                        </div>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-1'){

                    // Accountant Template 1 Preview 
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto flex min-h-screen bg-[#fdfaf8] shadow-mdresume-container mx-auto flex border border-gray-300 h-[297mm] overflow-hidden';
                    preview.innerHTML = `
                         <!-- Left Sidebar -->
                        <div class="w-[200px] bg-[#8E735B] text-white flex flex-col items-center py-8 px-4 space-y-8">
                            <!-- Profile Image -->
                            <div class="w-40 h-40 rounded-full border-[3px] border-[#F7F2EA] overflow-hidden">
                                <img src="${window.profileImage || profileImage || 'assets/img/profile.png'}" alt="Profile" class="w-full h-full object-cover" />
                            </div>

                            <!-- Skills -->
                            <div class="text-center">
                                <h2 class="text-white text-lg font-bold mb-2 tracking-wide">SKILLS</h2>
                                <ul class="text-sm space-y-1 list-disc list-inside" id="skills-preview">
                                    
                                </ul>
                            </div>

                            <div class="text-center">
                                <h2 class="text-white text-lg font-bold mb-2 tracking-wide">Language</h2>
                                <ul class="text-sm space-y-1 list-disc list-inside" id="languages-preview">
                                    
                                </ul>
                            </div>

                            <!-- Contact Info -->
                            <div class="text-center">
                                <h2 class="text-white text-lg font-bold mb-2 tracking-wide">CONTACT</h2>
                                <div class="space-y-4 text-sm">
                                    <p>📞 ${document.getElementById('phone')?.value}</p>
                                    <p>✉️ ${document.getElementById('email')?.value}</p>
                                    <p>📍 ${document.getElementById('address')?.value}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Right Content -->
                        <div class="flex-1 bg-white p-10">
                        <!-- Header Name -->
                            <div class="relative mb-10">
                                <div class="bg-[#8E735B] h-28 flex items-center pl-4">
                                    <h1 class="text-2xl tracking-wide text-white">
                                        <span class="block font-bold justify-center">${document.getElementById('name')?.value}</span>
                                    </h1>     
                                </div>
                            </div>

                            <!-- Education -->
                            <div class="mb-8">
                                <div class="flex items-center gap-2 mb-2">
                                    <div class="w-3 h-3 bg-[#8E735B]"></div>
                                    <h2 class="uppercase text-sm font-semibold tracking-wide">Education</h2>
                                    </div>
                                <div class="border-t border-[#F7F2EA] pt-4 text-sm" id="education-preview-list">
                                    ${generateEducationPreview()}
                                </div>
                            </div>

                            <!-- About -->
                            <div class="mb-8">
                                <div class="flex items-center gap-2 mb-2">
                                    <div class="w-3 h-3 bg-[#8E735B]"></div>
                                    <h2 class="uppercase text-sm font-semibold tracking-wide">About</h2>
                                    </div>
                                <div class="border-t border-[#F7F2EA] pt-4 text-sm">
                                    <p>
                                        ${document.getElementById('summary')?.value}
                                    </p>
                                </div>
                            </div>

                            <!-- Experience -->
                            <div>
                                <div class="flex items-center gap-2 mb-2">
                                    <div class="w-3 h-3 bg-[#8E735B]"></div>
                                    <h2 class="uppercase text-sm font-semibold tracking-wide">Experience</h2>
                                    </div>
                                <div class="border-t border-[#F7F2EA] pt-4 text-sm" id="experience-preview">
                                    ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }
                else if(templateId === 'accountant-2'){

                    // Accountant Template 2 
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] mx-auto flex min-h-screen w-full font-sans text-black bg-white shadow-md mx-auto p-8 grid grid-cols-3 gap-8';
                    preview.innerHTML = `
                        <!-- Left Column -->
                        <div class="col-span-1 space-y-8">
                        <!-- Profile Photo -->
                            <div class="flex justify-center">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-32 h-32 object-cover border-4 border-gray-700" />
                            </div>

                            <!-- Contact -->
                            <div>
                                <h2 class="text-lg font-bold flex items-center gap-2">
                                    <span class="w-3 h-3 bg-gray-700 rounded-full inline-block"></span>
                                    Contact
                                </h2>
                                <div class="mt-2 space-y-2 border-l-2 border-gray-600 pl-4 text-sm">
                                    <p>${document.getElementById('phone')?.value}</p>
                                    <p>${document.getElementById('email')?.value}</p>
                                    <p>${document.getElementById('address')?.value}</p>
                                </div>
                            </div>

                            <!-- Education -->
                            <div>
                                <h2 class="text-lg font-bold flex items-center gap-2">
                                    <span class="w-3 h-3 bg-gray-700 rounded-full inline-block"></span>
                                    Education
                                </h2>
                                <div class="mt-2 space-y-2 border-l-2 border-gray-600 pl-4 text-sm" id="education-preview-list">
                                    ${generateEducationPreview()}
                                </div>
                            </div>

                            <!-- Skills -->
                            <div>
                                <h2 class="text-lg font-bold flex items-center gap-2">
                                    <span class="w-3 h-3 bg-gray-700 rounded-full inline-block"></span>
                                    Skills
                                </h2>
                                <div class="mt-2 space-y-2 border-l-2 border-gray-600 pl-4 text-sm">
                                    <ul class="list-disc list-inside" id="skills-preview">
                                    
                                    </ul>
                                </div>
                            </div>
                             <div>
                                <h2 class="text-lg font-bold flex items-center gap-2">
                                    <span class="w-3 h-3 bg-gray-700 rounded-full inline-block"></span>
                                    Language
                                </h2>
                                <div class="mt-2 space-y-2 border-l-2 border-gray-600 pl-4 text-sm">
                                    <ul class="list-disc list-inside" id="languages-preview">
                                        
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="col-span-2 space-y-6">
                            <!-- Header -->
                            <br>
                            <div class="text-left">
                                <h1 class="text-4xl font-bold leading-none">${document.getElementById('name')?.value}</h1>
                                <p class="text-sm text-gray-600">Accountant</p>
                            </div>
                            <br>
                            <!-- About -->
                            <div class="bg-blue-100 p-6 rounded shadow">
                                <h2 class="text-lg font-bold border-b border-gray-400 mb-2">ABOUT</h2>
                                <p class="text-sm text-gray-800">
                                ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                        <!-- Experience -->
                        <div class="bg-blue-100 p-6 rounded shadow">
                            <h2 class="text-lg font-bold border-b border-gray-400 mb-4">EXPERIENCE</h2>
                            <div id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                    </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-3'){

                    // Accountant Template 3
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                        <!-- Header -->
                        <div class="grid grid-cols-3 gap-6 p-8 items-center bg-gray-800 text-white font-sans">
                            <!-- Left: Image -->
                            <div class="flex justify-center">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-32 h-32 object-cover border-4 border-bg-blue-100 shadow-md" />
                            </div>

                        <!-- Right: Name, Title, About -->
                            <div class="col-span-2">
                                <h1 class="text-4xl font-bold">${document.getElementById('name')?.value}</h1>
                                <p class="text-lg text-gray-300 mb-2">Accountant</p>
                                <p class="text-sm text-gray-200">
                                ${document.getElementById('summary')?.value}
                                </p>
                            </div>
                        </div>

                        <!-- Main Content -->
                        <div class="grid grid-cols-3 gap-8 px-8 pb-8">
                            <!-- Left Column -->
                            <div class="col-span-1 space-y-8 bg-blue-100 text-black p-6 rounded font-sans">
                                <!-- Education -->
                                <div>
                                    <h2 class="text-lg font-bold mb-2">Education</h2>
                                    <div id="education-preview-list">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>

                                <!-- Languages -->
                                <div>
                                    <h2 class="text-lg font-bold mb-2">Language</h2>
                                    <ul class="text-sm space-y-1" id="languages-preview">
                                    
                                    </ul>
                                </div>

                                <!-- Skills -->
                                <div>
                                    <h2 class="text-lg font-bold mb-2">Skills</h2>
                                    <ul class="text-sm space-y-1" id="skills-preview">
                                      
                                    </ul>
                                </div>
                            </div>

                        <!-- Right Column -->
                        <div class="col-span-2 space-y-6">
                            <br>
                            <div>
                                <h2 class="text-lg font-bold border-b border-gray-400 mb-4">Experience</h2>
                                <div id="experience-preview">
                                    ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>
                    </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-4'){

                    // Accountant Template 4
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md flex';
                    preview.innerHTML = `
                        <!-- Left Column (50%) -->
                        <div class="w-1/2 p-6 space-y-6">

                            <!-- Black Rounded Image Container -->
                            <div class="bg-black p-6 rounded-tr-[100px] rounded-br-[100px] shadow-md flex justify-end">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-36 h-36 object-cover rounded-full border-4 border-white shadow-md" />
                            </div>

                            <!-- Name and Title -->
                            <div class="text-center mt-4">
                                <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                                <p class="text-sm text-gray-700">Accountant</p>
                            </div>

                            <!-- About -->
                            <div class="px-6">
                                <div class="flex items-center gap-2 mb-2">
                                    <div class="bg-black text-white text-sm px-3 py-1 rounded-full font-semibold">About</div>
                                    <hr class="flex-grow border-t border-gray-400" />
                                </div>
                                <p class="text-sm text-gray-800">
                                ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                        <!-- Skills -->
                        <div class="px-6">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="bg-black text-white text-sm px-3 py-1 rounded-full font-semibold">Skills</div>
                                <hr class="flex-grow border-t border-gray-400" />
                            </div>
                            <ul class="text-sm list-disc list-inside space-y-1 text-gray-800" id="skills-preview">
                              
                            </ul>
                        </div>

                        <!-- Languages -->
                        <div class="px-6">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="bg-black text-white text-sm px-3 py-1 rounded-full font-semibold">Languages</div>
                                <hr class="flex-grow border-t border-gray-400" />
                            </div>
                            <ul class="text-sm list-disc list-inside space-y-1 text-gray-800" id="languages-preview">
                             
                            </ul>
                        </div>

                    </div>

                    <!-- Right Column (50%) -->
                    <div class="w-1/2 p-8 space-y-6">

                    <!-- Experience -->
                    <br><br>
                    <div>
                        <div class="flex items-center gap-2 mb-2">
                            <div class="bg-black text-white text-sm px-3 py-1 rounded-full font-semibold">Experience</div>
                                <hr class="flex-grow border-t border-gray-400" />
                            </div>
                            <div class="space-y-4" id="experience-preview">
                                ${generateExperiencePreview()}
                                
                        </div>
                    </div>

                    <!-- Education -->
                    <div>
                        <div class="flex items-center gap-2 mb-2">
                            <div class="bg-black text-white text-sm px-3 py-1 rounded-full font-semibold">Education</div>
                                <hr class="flex-grow border-t border-gray-400" />
                            </div>
                            <div class="space-y-4" id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                        </div>
                    </div>

                </div>
                    `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-5'){

                    // Accountant Template 5
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                         <!-- Header Section -->
                        <div class="bg-white flex flex-col items-center py-6 space-y-4 border-b border-black">
                            <div class="w-32 h-32 rounded-full overflow-hidden border-4 border-black">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-full h-full object-cover" />
                            </div>
                            <h1 class="text-2xl font-bold uppercase text-black">${document.getElementById('name')?.value}</h1>
                        </div>

                        <!-- Job Title Bar -->
                        <div class="bg-black text-white text-center py-2 font-semibold uppercase text-sm">
                            
                        </div>
                        <!-- Main Content: Two Columns -->
                        <div class="grid grid-cols-2">

                            <!-- Left Column -->
                            <div class="col-span-1 bg-white p-6 border-r border-black">
                                <h2 class="text-lg font-bold mb-4">EXPERIENCES</h2>
                                <div class="space-y-4 text-sm pl-6">
                                    <div>
                                        ${generateExperiencePreview()}
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column -->
                            <div class="col-span-1.5 bg-white p-6 space-y-6">

                                <!-- Education -->
                                <div>
                                    <h2 class="text-lg font-bold mb-4">EDUCATION</h2>
                                    <div id="education-preview-list">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>

                                <!-- Languages -->
                                <div>
                                    <h2 class="text-lg font-bold mb-4">LANGUAGES</h2>
                                    <ul class="list-disc list-inside text-sm pl-6" id="languages-preview">
                                        
                                    </ul>
                                </div>

                                <!-- Skills -->
                                <div>
                                    <h2 class="text-lg font-bold mb-4">SKILLS</h2>
                                    <ul class="text-sm space-y-2 pl-6" id="skills-preview">
                                      
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-6'){

                    // Accountant Template 6
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] w-full font-sans text-black shadow-md flex flex-col overflow-hidden';
                    preview.innerHTML = `
                        <!-- Header -->
                    <div class="flex w-full">
                        <div class="w-1/2 bg-blue-100 px-10 pt-10">
                            <br>
                            <br>
                            <h2 class="text-3xl font-semibold text-gray-800">${document.getElementById('name')?.value}</h2>
                            <hr />
                            <p class="uppercase tracking-widest mt-1 pt-2 w-fit">${document.getElementById('title')?.value}</p>
                        </div>
                        <div class="w-1/2 bg-gray-800 flex items-center justify-center p-10">
                            <img
                            src="${window.profileImage || profileImage}"
                            class="rounded-full w-40 h-40 border-4 border-white object-cover shadow-lg"
                            alt="Profile"
                            />
                        </div>
                    </div>

                    <!-- Main Body -->
                    <div class="flex w-full h-full">
                        <!-- Left Column -->
                        <div class="w-1/2 bg-blue-100 px-10 py-8 space-y-6">

                            <!-- About Me -->
                            <div>
                                <div class="bg-black text-white px-4 py-1 rounded-full font-semibold inline-block mb-2">About Me:</div>
                                <p class="text-sm text-gray-800">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>


                        <!-- Contact -->
                        <div>
                            <div class="bg-black text-white px-4 py-1 rounded-full font-semibold inline-block mb-2">Contact:</div>
                                <ul class="text-sm space-y-1">
                                    <li>${document.getElementById('phone')?.value}</li>
                                    <li>${document.getElementById('email')?.value}</li>
                                    <li>${document.getElementById('address')?.value}</li>
                                </ul>
                            </div>

                        <!-- Education -->
                        <div>
                            <div class="bg-black text-white px-4 py-1 rounded-full font-semibold inline-block mb-2">Education:</div>
                            <div id="education-preview-list">
                                ${generateEducationPreview()}
                            </div>
                        </div>

                        <!-- Skills -->
                        <div>
                            <div class="bg-black text-white px-4 py-1 rounded-full font-semibold inline-block mb-2">Skills:</div>
                            <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                               
                            </ul>
                        </div>

                        <!-- Language -->
                        <div>
                            <div class="bg-black text-white px-4 py-1 rounded-full font-semibold inline-block mb-2">Language:</div>
                            <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                             
                            </ul>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="w-1/2 bg-gray-800 text-white px-10 py-8 space-y-6">
                        <div>
                            <div class="bg-black text-white px-4 py-1 rounded-full font-semibold inline-block mb-4">Work Experience:</div>
                            <div id="experience-preview">
                                ${generateExperiencePreview()}
                            </div>
                        </div>
                    </div>
                </div>
                    `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-7'){

                        // Accountant Template 7
                        const preview = document.createElement('div');
                        preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black shadow-md flex overflow-hidden';
                        preview.innerHTML = `
                            <!-- Left Sidebar -->
                            <div class="w-[35%] bg-white flex flex-col items-center py-10 px-6 relative">
                                <img src="${window.profileImage || profileImage}" class="w-36 h-36 object-cover border-4 border-black shadow-md mb-8" alt="Profile" />

                                <!-- Contact -->
                                <div class="w-full mb-6">
                                    <div class="bg-black text-white text-lg font-semibold px-4 py-2 w-fit pr-10 relative z-10">
                                        Contact
                                    </div>
                                    <div class="mt-2 text-sm space-y-2">
                                        <div>
                                            <p class="font-semibold">Phone</p>
                                            <p>${document.getElementById('phone')?.value}</p>
                                        </div>
                                        <div>
                                            <p class="font-semibold">Email</p>
                                            <p>${document.getElementById('email')?.value}</p>
                                        </div>
                                        <div>
                                            <p class="font-semibold">Address</p>
                                            <p>${document.getElementById('address')?.value}</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Education -->
                                <div class="w-full mb-6">
                                    <div class="bg-black text-white text-lg font-semibold px-4 py-2 w-fit pr-10 relative z-10">
                                        Education
                                    </div>
                                    <div id="education-preview-list">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>


                            <!-- Skills -->
                            <div class="w-full">
                                <div class="bg-black text-white text-lg font-semibold px-4 py-2 w-fit pr-10 relative z-10">
                                    Skills
                                </div>
                                <ul class="mt-4 text-sm list-disc list-inside space-y-2" id="skills-preview">
                                    
                                </ul>
                            </div>
                        </div>

                            <!-- Right Content -->
                            <div class="w-[65%] bg-white px-10 py-10 space-y-8">
                                <!-- Header -->
                                <div>
                                    <h1 class="text-3xl font-extrabold leading-none">${document.getElementById('name')?.value}</h1>
                                    <p class="uppercase tracking-widest text-sm mt-1">${document.getElementById('title')?.value}</p>
                                </div>

                                <!-- About -->
                                <div>
                                    <h2 class="text-xl font-extrabold tracking-wide mb-2">ABOUT</h2>
                                    <hr class="border-black mb-2" />
                                    <p class="text-sm leading-relaxed">
                                        ${document.getElementById('summary')?.value}
                                    </p>
                                </div>

                                <!-- Experience -->
                                <div class="w-full mb-6">
                                    <div class="bg-black text-white text-lg font-semibold px-4 py-2 w-fit pr-10 relative z-10">
                                        Experience
                                    </div>
                                    <div id="experience-preview">
                                        ${generateExperiencePreview()}
                                    </div>
                                </div>
                            </div>

                        `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-8'){

                // Accountant Template 8
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black shadow-md overflow-hidden bg-white';
                preview.innerHTML = `
                    <!-- Header -->
                    <div class="text-center border-b border-black pb-4">
                        <img src="${window.profileImage || profileImage}" class="w-32 h-32 rounded object-cover mx-auto mt-4 border" alt="Profile">
                        <h1 class="text-4xl font-bold mt-2">${document.getElementById('name')?.value}</h1>
                        <p class="uppercase tracking-widest text-sm">${document.getElementById('title')?.value}</p>
                    </div>

                    <!-- Main Section -->
                    <div class="flex divide-x divide-black">
                        <!-- Left Column -->
                        <div class="w-1/2 p-6">
                            <!-- Contact -->
                            <div class="mb-6">
                                <div class="bg-black border-t-4 border-white px-4 py-1">
                                    <h2 class="text-white font-bold text-lg tracking-wide">Contact</h2>
                                </div>
                                <ul class="mt-4 space-y-3 text-sm">
                                    <li class="flex items-start gap-2"><span class="text-lg">☎️</span> <div><span class="font-semibold">Phone</span><br>${document.getElementById('phone')?.value}</div></li>
                                    <li class="flex items-start gap-2"><span class="text-lg">🌐</span> <div><span class="font-semibold">Email</span><br>${document.getElementById('email')?.value}</div></li>
                                    <li class="flex items-start gap-2"><span class="text-lg">📍</span> <div><span class="font-semibold">Address</span><br${document.getElementById('address')?.value}</div></li>
                                </ul>
                            </div>

                            <!-- Education Section -->
                             <div class="mb-4">
                                <br>
                                <div class="bg-black border-t-4 border-white px-4 py-1">
                                    <h2 class="text-white font-bold text-lg tracking-wide">Education</h2>
                                </div>
                                <div id="education-preview-list">
                                    ${generateEducationPreview()}
                                </div>
                            </div>

                          
                           

                            <!-- Skills -->
                            <div class="mb-4">
                                <br>
                                <div class="bg-black border-t-4 border-white px-4 py-1">
                                    <h2 class="text-white font-bold text-lg tracking-wide">Skills</h2>
                                </div>
                                <ul class="list-disc list-inside mt-4 space-y-2 text-sm" id="skills-preview">
                                   
                                </ul>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="w-1/2 p-6">
                            <!-- About -->
                            <div class="mb-10">
                                <div class="bg-black border-t-4 border-white px-4 py-1">
                                    <h2 class="text-white font-bold text-lg tracking-wide">About</h2>
                                </div>
                                <p class="mt-4 text-sm leading-relaxed">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                            <!-- Experience Section -->
                            <div>
                                <div class="bg-black border-t-4 border-white px-4 py-1">
                                    <h2 class="text-white font-bold text-lg tracking-wide">Experience</h2>
                                </div>
                                <div id="experience-preview">
                                    ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>
                    </div>

                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-9'){

                    // Accountant Template 9
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-[#e8ecf2] shadow-md';
                    preview.innerHTML = `
                         <!-- Header -->
                        <div class="flex items-center border-b-2 border-black">
                            <div class="w-1/3 p-6">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-full rounded shadow-md" />
                            </div>
                            <div class="w-2/3 px-6 border-t-2 border-b-2 border-black py-4">
                                <h1 class="text-4xl font-bold">${document.getElementById('name')?.value}</h1>
                                <p class="uppercase text-sm tracking-widest">Accountant</p>
                            </div>
                        </div>

                        <!-- Body -->
                        <div class="grid grid-cols-2 gap-6 p-8">
                            <!-- Left Column -->
                            <div class="space-y-6 pr-6 border-r border-gray-400">
                                <!-- About -->
                                <div>
                                    <h2 class="text-xl font-bold border-b-2 border-black mb-4">ABOUT</h2>
                                <p class="text-sm leading-relaxed">
                                    ${document.getElementById('summary')?.value}
                                </p>
                                </div>

                                <!-- EDUCATION -->
                                <div class="mb-8">
                                    <h2 class="text-xl font-bold border-b-2 border-black mb-4">EDUCATION</h2>
                                    <div id="education-preview-list">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>

                                <!-- Skills -->
                                <div>
                                    <h2 class="text-xl font-bold border-b-2 border-black mb-4">SKILLS</h2>
                                    <ul class="list-disc list-inside text-sm" id="skills-preview">
                                      
                                    </ul>
                                </div>
                            </div>

                            <!-- Right Column -->
                            <div class="space-y-6 pl-6">

                                <!-- EXPERIENCE -->
                                <div>
                                    <h2 class="text-xl font-bold border-b-2 border-black mb-4">EXPERIENCE</h2>
                                    <div id="experience-preview">
                                        ${generateExperiencePreview()}
                                    </div>
                                </div>

                                <!-- Contact -->
                                <div>
                                    <h2 class="text-xl font-bold border-b-2 border-black mb-4">CONTACT</h2>
                                    <p class="text-sm">${document.getElementById('phone')?.value}</p>
                                    <p class="text-sm">${document.getElementById('email')?.value}</p>
                                    <p class="text-sm">${document.getElementById('address')?.value}</p>
                                </div>
                            </div>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'accountant-10'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-gray-100 shadow-md';
                    preview.innerHTML = `
                        <!-- Header -->
                        <div class="bg-black text-white flex items-center">
                            <div class="w-1/4">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-full h-auto object-cover p-4" />
                            </div>
                            <div class="w-3/4 px-8">
                                <h1 class="text-3xl font-bold tracking-wide">${document.getElementById('name')?.value}</h1>
                                <p class="uppercase text-lg tracking-wider mt-2">Accountant</p>
                            </div>
                        </div>

                        <!-- Content -->
                        <div class="grid grid-cols-[40%_60%] gap-8 px-10 py-10">
                        
                            <!-- Left Column (40%) -->
                            <div class="space-y-8">
                                <!-- About -->
                                <div>
                                    <h2 class="text-lg font-bold mb-2">ABOUT ME</h2>
                                    <p class="text-sm leading-relaxed">
                                        ${document.getElementById('summary')?.value}
                                    </p>
                                </div>

                                <!-- Skills -->
                                <div>
                                    <h2 class="text-lg font-bold mb-4">SKILLS</h2>
                                    <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                                    
                                    </ul>
                                </div>

                                <!-- Contact -->
                                <div>
                                    <h2 class="text-lg font-bold mb-4">CONTACT</h2>
                                    <p class="text-sm flex items-center gap-2 mb-2">📞 ${document.getElementById('phone')?.value}</p>
                                    <p class="text-sm flex items-center gap-2 mb-2">✉️ ${document.getElementById('email')?.value}</p>
                                    <p class="text-sm flex items-center gap-2">📍 ${document.getElementById('address')?.value}</p>
                                </div>
                            </div>

                            <!-- Right Column (60%) -->
                            <div class="space-y-8">

                                <!-- Education -->
                                <div>
                                <h2 class="text-lg font-bold mb-4">EDUCATION</h2>
                                    <div id="education-preview-list">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>

                                <!-- Experience -->
                                <div>
                                <h2 class="text-lg font-bold mb-4">EXPERIENCE</h2>
                                    <div id="experience-preview">
                                        ${generateExperiencePreview()}
                                    </div>
                                </div>

                                <!-- Language -->
                                <div>
                                    <h2 class="text-lg font-bold mb-4">LANGUAGE</h2>
                                    <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                                        <li>Filipino</li>
                                        <li>English</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-1'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans shadow-md flex overflow-hidden';
                    preview.innerHTML = `
                        <!-- Left Sidebar -->
                        <div class="w-1/3 pr-6 border-r border-gray-300 pl-4 bg-gray-50">
                            <div class="flex justify-center">
                                <div class="border-[10px] border-white rounded-full w-40 h-40 overflow-hidden">
                                    <img src="${window.profileImage || profileImage}" alt="Profile" class="w-full h-full object-cover" />
                                </div>
                            </div>

                            <!-- Contact -->
                            <div class="mt-6">
                                <h2 class="w-full text-center bg-gray-700 text-white font-bold px-3 py-2">CONTACT</h2>
                                <ul class="mt-2 text-sm space-y-2 text-black">
                                    <li class="flex items-center gap-2">
                                    <span>📞</span> ${document.getElementById('phone')?.value}
                                    </li>
                                    <li class="flex items-center gap-2">
                                    <span>✉️</span> ${document.getElementById('email')?.value}
                                    </li>
                                    <li class="flex items-center gap-2">
                                    <span>📍</span> ${document.getElementById('address')?.value}
                                    </li>
                                </ul>
                            </div>

                            <!-- Skills -->
                            <div class="mt-6">
                                <h2 class="w-full text-center bg-gray-700 text-white font-bold px-3 py-2">SKILLS</h2>
                                <ul class="mt-2 text-sm text-black space-y-2" id="skills-preview">
                                   
                                </ul>
                            </div>

                            <!-- Language -->
                            <div class="mt-6">
                                <h2 class="w-full text-center bg-gray-700 text-white font-bold px-3 py-2">LANGUAGE</h2>
                                <ul class="mt-2 text-sm text-black space-y-1" id="languages-preview">
                                  
                                </ul>
                            </div>
                        </div>

                        <!-- Right Content -->
                        <div class="w-2/3 pl-6 flex flex-col bg-white">
                            <!-- Header -->
                            <div class="text-center mb-6">
                                <div class="bg-gray-700 text-white font-bold py-4 text-2xl leading-tight">
                                    ${document.getElementById('name')?.value}
                                    <div class="text-sm font-normal">${document.getElementById('title')?.value}</div>
                                </div>
                            </div>

                            <!-- Profile Summary -->
                            <div class="text-sm text-black mb-6">
                                <p>
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                            <!-- Experience -->
                            <div class="mb-6">
                                <h2 class="w-full text-center bg-gray-700 text-white font-bold px-3 py-2 mb-2">EXPERIENCE</h2>
                                <div class="mb-4">
                                    ${generateExperiencePreview()}
                                </div>
                            <div>
                              
                            </div>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="w-full text-center bg-gray-700 text-white font-bold px-3 py-2 mb-2">EDUCATION</h2>
                            <div class="text-sm text-black mb-2">
                                ${generateEducationPreview()}
                            </div>
                            <div class="text-sm text-black">
                                
                            </div>
                        </div>
                    </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-2'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-gray-800 bg-white shadow-md';
                    preview.innerHTML = `
                       <!-- Header -->
                    <div class="bg-gradient-to-r from-blue-900 to-blue-600 flex items-center px-8 py-6 ">
                        <!-- Profile Image -->
                        <img src="${window.profileImage || profileImage}" alt="Profile" 
                            class="w-28 h-28 object-cover rounded-full border-4 border-white shadow-md">
                        <!-- Name and Title -->
                        <div class="ml-6 text-white">
                            <h1 class="text-3xl font-extrabold">${document.getElementById('name')?.value}</h1>
                            <p class="text-lg font-medium tracking-wide">${document.getElementById('title')?.value}</p>
                        </div>
                    </div>

                    <div class="flex">
                        <!-- Left Sidebar -->
                        <div class="w-1/3 bg-gray-50 p-6 space-y-8">
                            <!-- Contact -->
                            <div>
                                <h2 class="text-lg font-bold tracking-wide mb-2">CONTACT</h2>
                                <hr class="border-t border-gray-400 mb-3">
                                <p class="text-sm flex items-center"><span class="mr-2">📞</span> ${document.getElementById('phone')?.value}</p>
                                <p class="text-sm flex items-center"><span class="mr-2">✉️</span> ${document.getElementById('email')?.value}</p>
                                <p class="text-sm flex items-center"><span class="mr-2">📍</span> ${document.getElementById('address')?.value}</p>
                            </div>

                            <!-- Education -->
                            <div>
                                <h2 class="text-xl font-bold tracking-wide mb-2">EDUCATION</h2>
                                <hr class="border-t border-gray-400 mb-3">

                                <!-- School 1 -->
                                <div class="mb-4">
                                    ${generateEducationPreview()}
                                </div>

                                <!-- School 2 -->
                                <div class="mb-4">
                                    ${generateEducationPreview()}
                                </div>
                            </div>


                            <!-- Skills -->
                            <div>
                                <h2 class="text-lg font-bold tracking-wide mb-2">SKILLS</h2>
                                <hr class="border-t border-gray-400 mb-3">
                                <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                                   
                                </ul>
                            </div>
                        </div>

                        <!-- Right Content -->
                        <div class="w-2/3 p-8 space-y-8">

                            <!-- Profile -->
                            <div>
                                <h2 class="text-xl font-bold text-blue-900 mb-2">PROFILE</h2>
                                <hr class="border-t border-blue-900 mb-3">
                                ${document.getElementById('summary')?.value}
                            </div>

                            <!-- Work Experience -->
                            <div>
                                <h2 class="text-xl font-bold text-blue-900 mb-2">WORK EXPERIENCE</h2>
                                <hr class="border-t border-blue-900 mb-3">

                                <div class="space-y-6">

                                    <!-- Job 1 -->
                                    <div class="relative pl-8">
                                        <div class="absolute left-0 top-2 bottom-0 border-l-2 border-blue-800"></div>
                                        <span class="absolute left-[-7px] top-2 w-4 h-4 bg-blue-800 rounded-full"></span> 
                                            ${generateExperiencePreview()}      
                                    </div>
                                    
                                </div>
                            </div>

                            <!-- Language -->
                                <div>
                                <h2 class="text-xl font-bold text-blue-900 mb-2">LANGUAGE</h2>
                                <hr class="border-t border-blue-900 mb-3">
                                <ul class="text-sm font-semibold" id="languages-preview">
                                  
                                </ul>
                            </div>

                        </div>
                    </div>
                    <div class="w-full h-3 bg-blue-800"></div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-3'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md flex';
                    preview.innerHTML = `
                   <!-- Left Column -->
                    <div class="w-1/3 bg-gray-800 text-white p-8 space-y-8">
                        <!-- Profile Image -->
                        <div class="flex justify-center">
                            <img src="${window.profileImage || profileImage}" alt="Profile" class="w-40 h-40 object-cover rounded-lg shadow-md" />
                        </div>

                        <!-- Title -->
                        <div class="text-center">
                            <hr class="border-t border-gray-500 mb-3">
                            <h2 class="text-lg font-bold tracking-wide">${document.getElementById('title')?.value}</h2>
                            <hr class="border-t border-gray-500 mt-3">
                            <p class="text-sm mt-2 text-gray-300">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Contact -->
                        <div>
                            <h3 class="text-base font-bold border-b border-gray-600 pb-1 mb-3">CONTACT</h3>
                            <p class="flex items-center gap-2 text-sm"><span>📞</span> ${document.getElementById('phone')?.value}</p>
                            <p class="flex items-center gap-2 text-sm"><span>📧</span> ${document.getElementById('email')?.value}</p>
                            <p class="flex items-center gap-2 text-sm"><span>📍</span> ${document.getElementById('address')?.value}</p>
                        </div>

                        <!-- Skills -->
                        <div>
                            <h3 class="text-base font-bold border-b border-gray-600 pb-1 mb-3">SKILLS</h3>
                            <ul class="list-disc list-inside text-sm text-gray-300 space-y-1" id="skills-preview">
                               
                            </ul>
                        </div>

                        <!-- Language -->
                        <div>
                            <h3 class="text-base font-bold border-b border-gray-600 pb-1 mb-3">LANGUAGE</h3>
                            <ul class="text-sm" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="w-2/3 bg-white p-10 space-y-8">
                        <!-- Header -->
                        <div class="text-center">
                            <h1 class="text-3xl font-bold text-gray-800 tracking-wide">${document.getElementById('name')?.value}</h1>
                        </div>
                        <!-- Education -->
                        <div>
                            <h2 class="text-xl font-bold text-gray-800 mb-2">EDUCATION</h2>
                            <hr class="border-t border-gray-400 mb-4">

                            <div class="mb-4">
                                ${generateEducationPreview()}
                            </div>
                            
                       
                        </div>

                        <!-- Experience -->
                        <div>
                            <h2 class="text-xl font-bold text-gray-800 mb-2">EXPERIENCE</h2>
                            <hr class="border-t border-gray-400 mb-4">

                            <!-- Job 1 -->
                            <div class="mb-6">
                                <div class="flex justify-between items-center">
                                    ${generateExperiencePreview()}
                                </div>
                               
                            </div>
                        </div>
                    </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-4'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                    <div class="grid grid-cols-3">
                        <!-- Left Column -->
                        <div class="col-span-1 bg-[#20B2AA] text-white p-6 flex flex-col items-center">
                            <!-- Profile Image -->
                            <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-32 h-32 object-cover rounded-lg border-4 border-white mb-6">
                            <!-- Profile -->
                            <div class="text-center mb-8">
                                <h2 class="text-lg font-bold tracking-wide">PROFILE</h2>
                                <hr class="border-t border-white/60 my-2">
                                <p class="text-sm leading-relaxed">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                            <!-- Contact -->
                            <div class="w-full">
                                <h2 class="text-lg font-bold tracking-wide mb-2">CONTACT ME</h2>
                                <hr class="border-t border-white/60 mb-3">
                                <p class="flex items-center text-sm mb-2">
                                    <span class="mr-2">📞</span> ${document.getElementById('phone')?.value}
                                </p>
                                <p class="flex items-center text-sm mb-2">
                                    <span class="mr-2">✉️</span> ${document.getElementById('email')?.value}
                                </p>
                                <p class="flex items-center text-sm">
                                    <span class="mr-2">📍</span> ${document.getElementById('address')?.value}
                                </p>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="col-span-2 bg-gray-50 p-8">
                            <!-- Header -->
                            <div class="text-center mb-8">
                                <h1 class="text-2xl font-bold text-gray-800 tracking-wide">${document.getElementById('name')?.value}</h1>
                                <p class="text-lg italic text-gray-600">${document.getElementById('title')?.value}</p>
                                <hr class="border-t-2 border-[#20B2AA] mt-4">
                            </div>

                            <!-- Education -->
                            <div class="mb-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-2">EDUCATION</h2>
                                <hr class="border-t border-[#20B2AA] mb-3">
                                <div class="mb-4">
                                    ${generateEducationPreview()}
                                </div>
                               
                            </div>

                            <!-- Languages -->
                            <div class="mb-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-2">LANGUAGE</h2>
                                <hr class="border-t border-[#20B2AA] mb-3">
                                <ul class="list-none text-sm space-y-1" id="languages-preview">
                                    <li class="relative pl-5 before:content-['•'] before:absolute before:left-0 before:text-[#20B2AA]">
                                   
                                    </li>
                                   
                                </ul>
                            </div>

                            <!-- Skills -->
                            <div class="mb-6">
                                <h2 class="text-xl font-bold text-gray-800 mb-2">SKILLS</h2>
                                <hr class="border-t border-[#20B2AA] mb-3">
                                <ul class="list-none text-sm space-y-1" id="skills-preview">
                                    <li class="relative pl-5 before:content-['•'] before:absolute before:left-0 before:text-[#20B2AA]">
                                   
                                    </li>
                                   
                                </ul>
                            </div>

                            <!-- Work Experience -->
                            <div>
                                <h2 class="text-xl font-bold text-gray-800 mb-2">WORK EXPERIENCE</h2>
                                <hr class="border-t border-[#20B2AA] mb-3">
                                <div>
                                    ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>
                    </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-5'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                     <!-- Header -->
                    <div class="bg-gray-200 p-6 flex items-center space-x-6">
                        <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-32 h-32 object-cover border border-black" />
                        <div  class="text-sm text-gray-700">
                            <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                            <p class="text-lg text-gray-700">${document.getElementById('title')?.value}</p>
                            <p>${document.getElementById('address')?.value}</p>
                            <p>${document.getElementById('email')?.value}</p>
                            <p>${document.getElementById('phone')?.value}</p>
                        </div>
                    </div>

                    <!-- Main Body -->
                    <div class="grid grid-cols-[30%_70%] gap-6 p-6">
                    
                        <!-- Left Column -->
                        <div class="space-y-6">
                            <div>
                                <h2 class="text-lg font-semibold">Profile</h2>
                                <p class="text-sm text-gray-700 mt-1">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                            <hr class="border-gray-300" />

                            <div>
                                <h2 class="text-lg font-semibold">Skills</h2>
                                <ul class="list-disc list-inside text-sm text-gray-700 mt-1" id="skills-preview">
                                 
                                </ul>
                            </div>
                            <hr class="border-gray-300" />
                            <div>
                                <h2 class="text-lg font-semibold">Languages</h2>
                                <ul class="list-disc list-inside text-sm text-gray-700 mt-1" id="languages-preview">
                                   
                                </ul>
                            </div>
                            <hr class="border-gray-300" />
                            <div>
                                <h2 class="text-lg font-semibold">Hobbies</h2>
                                <ul class="list-disc list-inside text-sm text-gray-700 mt-1" id="hobbies-preview">
                                   
                                </ul>
                            </div>
                        </div>

                        <!-- Right Column -->
                            <div class="space-y-6">
                            <!-- Education Section -->
                                <div>
                                    <h2 class="text-xl font-bold">Education</h2> 
                                    <div class="mt-2">
                                    ${generateEducationPreview()}
                                </div>
                               
                            </div>
                        <hr class="border-gray-300" />

                        <!-- Work Experience Section -->
                        <div>
                            <h2 class="text-xl font-bold">Work Experience</h2>

                            <div class="mt-2">
                                ${generateExperiencePreview()}
                            </div>
                        </div>
                    </div>
                </div>  
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'business-6'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md p-8 flex gap-6';
                    preview.innerHTML = `
                    <!-- Left Column -->
                    <div class="w-2/3 space-y-6">
                    
                        <!-- Profile -->
                        <div class="flex flex-col items-center text-center">
                            <img src="${window.profileImage || profileImage}" class="border-2 border-black w-32 h-32 object-cover" alt="Profile image">
                            <h1 class="text-2xl font-semibold mt-4">${document.getElementById('name')?.value}</h1>
                            <p class="text-gray-500">Business Administration</p>
                            <h2 class="inline-flex items-center gap-2 border border-gray-400 rounded-full px-4 py-1 text-sm font-semibold mt-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.5 20.25a8.25 8.25 0 0115 0"/></svg>
                            MY PROFILE
                            </h2>
                            <p class="mt-2 text-sm text-gray-700">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="inline-flex items-center gap-2 border border-gray-400 rounded-full px-4 py-1 text-sm font-semibold">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M12 14l9-5-9-5-9 5 9 5zm0 0v6"/></svg>
                                EDUCATION
                            </h2>

                            <div class="mt-4 space-y-4">
                                <div class="bg-gray-100 p-4 rounded-xl w-full">
                                    ${generateEducationPreview()}
                                </div>
                            </div>
                        </div>


                        <!-- Experience -->
                        <div>
                            <h2 class="inline-flex items-center gap-2 border border-gray-400 rounded-full px-4 py-1 text-sm font-semibold">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M3 7h18M3 12h18M3 17h18"/></svg>
                                EXPERIENCE
                            </h2>
                        <div class="mt-4 space-y-4">
                            <!-- Job 1 -->
                            <div class="bg-gray-100 p-4 rounded-xl w-full">
                                ${generateExperiencePreview()}
                            </div>  
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="md:w-1/3 mt-8 md:mt-0">
                    <div class="bg-gray-100 rounded-xl p-6 space-y-6 h-full">
                        <!-- Skills (List Style) -->
                        <div>
                            <h2 class="inline-flex items-center gap-2 border border-gray-400 rounded-full px-4 py-1 text-sm font-semibold mb-4">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M12 6v6l4 2"/></svg>
                                SKILLS
                            </h2>
                            <ul class="list-disc list-inside space-y-1 text-sm text-gray-700" id="skills-preview">
                             
                            </ul>
                        </div>
                        <br><br>
                        <!-- Contact -->
                        <div class="space-y-2">
                            <h2 class="inline-flex items-center gap-2 border border-gray-400 rounded-full px-4 py-1 text-sm font-semibold">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M2 8l10 6 10-6"/></svg>
                                CONTACT
                            </h2>
                            <p class="text-sm">${document.getElementById('phone')?.value}</p>
                            <p class="text-sm">${document.getElementById('email')?.value}</p>
                            <p class="text-sm">${document.getElementById('address')?.value}</p>
                        </div>
                    </div>
                </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-7'){

                    // BSBA Template 7
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                     <!-- Header -->
                    <div class="flex justify-center items-center gap-6 px-6 py-6 border-b border-gray-300">
                         <img src="${window.profileImage || profileImage}" class="w-40 h-40  object-cover" alt="Profile" />
                        <div class="text-center">
                            <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                            <p class="text-sm text-gray-600">${document.getElementById('title')?.value}</p>
                        </div>
                    </div>

                    <!-- Body -->
                    <div class="flex">
                        <!-- Left Column (5%) white -->
                        <div class="w-[5%] bg-white"></div>

                        <!-- Middle Column (35%) - Sidebar, colored -->
                        <div class="w-[35%] p-6 space-y-6 bg-[#c7986b] text-white">

                            <!-- About -->
                            <div>
                                <h2 class="text-sm font-bold uppercase mb-1">About Me</h2>
                                <p class="text-sm">
                                ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                            <!-- Education -->
                            <div>
                                <h2 class="text-sm font-bold uppercase mb-1">Education</h2>
                                <div class="text-sm space-y-2">
                                    <div>
                                        ${generateEducationPreview()}
                                    </div>
                                </div>
                            </div>

                            <!-- Skills -->
                            <div>
                                <h2 class="text-sm font-bold uppercase mb-1">Skill</h2>
                                <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                                
                                </ul>
                            </div>
                        </div>

                        <!-- Right Column (60%) -->
                        <div class="w-[60%] p-6 space-y-6">

                        <!-- Experience -->
                        <div>
                            <h2 class="text-sm font-bold uppercase mb-2 bg-[#c7986b] text-white inline-block px-3 py-1 rounded">
                                Experience
                            </h2>
                            <div class="text-sm text-gray-700 space-y-4">
                                <!-- Job 1 -->
                                <div>
                                  ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>


                        <!-- Contact -->
                        <div>
                            <h2 class="text-sm font-bold uppercase mb-2 bg-[#c7986b] text-white inline-block px-3 py-1 rounded">
                                Contact
                            </h2>
                            <div class="text-sm text-gray-700 space-y-1">
                                <p>📞 ${document.getElementById('phone')?.value}</p>
                                <p>✉️ ${document.getElementById('email')?.value}</p>
                                <p>📍 ${document.getElementById('address')?.value}</p>
                            </div>
                        </div>
                    </div>
                </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-8'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                    <!-- Header -->
                    <div class="flex items-center bg-black text-white p-6">
                        <img src="${window.profileImage || profileImage}" alt="Profile" class="w-32 h-32 rounded-full object-cover mr-6" />
                        <div>
                            <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                            <p class="text-sm">${document.getElementById('title')?.value}</p>
                        </div>
                    </div>
                
                    <!-- About Me -->
                    <div class="p-4">
                        <div class="bg-gray-200 p-4">
                            <h2 class="text-lg font-bold uppercase mb-2">About Me</h2>
                            <p class="text-sm leading-relaxed">
                            ${document.getElementById('summary')?.value}
                            </p>
                        </div>
                    </div>
                
                
                    <!-- Content Columns -->
                    <div class="flex">
                
                        <!-- Left Column -->
                        <div class="w-1/2 p-4 space-y-6">
                    
                            <!-- Skill -->
                            <div class="bg-gray-200 p-4">
                                <h2 class="text-lg font-bold uppercase mb-2">Skill</h2>
                                <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                                   
                                </ul>
                            </div>
                    
                            <!-- Education -->
                            <div class="bg-gray-200 p-4">
                                <h2 class="text-lg font-bold uppercase mb-2">Education</h2>
                                <div class="text-sm space-y-4">
                                    <div>
                                        ${generateEducationPreview()}
                                    </div>
                                </div>
                            </div>
                    
                            <!-- Language -->
                            <div class="bg-gray-200 p-4">
                                <h2 class="text-lg font-bold uppercase mb-2">Language</h2>
                                <ul class="text-sm space-y-1" id="languages-preview">
                                   
                                </ul>
                            </div>
                        </div>
                
                        <!-- Right Column -->
                        <div class="w-1/2 p-4 space-y-6">
                            <!-- Experience -->
                            <div class="bg-gray-200 p-4">
                                <h2 class="text-lg font-bold uppercase mb-2">Experience</h2>
                                <div class="space-y-4 text-sm">
                                    <div>
                                        ${generateExperiencePreview()}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-9'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-white bg-white shadow-md';
                    preview.innerHTML = `
                    <!-- Header Section -->
                    <div class="bg-[#0a2149] text-white text-center py-8 px-4">
                        <img src="${window.profileImage || profileImage}" alt="Profile" class="w-40 h-40 mx-auto rounded-full border-4 border-white mb-4">
                        <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-lg">${document.getElementById('title')?.value}</p>
                    </div>

                    <!-- Summary -->
                    <div class="text-[#0a2149] px-6 py-4">
                        <p class="text-sm text-center text-black">
                            ${document.getElementById('summary')?.value}
                        </p>
                    </div>

                    <div class="grid grid-cols-2 gap-6 px-6 py-6">

                        <!-- Left Column -->
                        <div class="space-y-6">

                            <!-- Contact -->
                            <div>
                                <h2 class="text-white text-lg font-bold bg-[#0a2149] px-4 py-2 rounded">Contact</h2>
                                <ul class="mt-2 space-y-1 text-black text-sm">
                                    <li>${document.getElementById('phone')?.value}</li>
                                    <li>${document.getElementById('email')?.value}</li>
                                    <li>${document.getElementById('address')?.value}</li>
                                </ul>
                            </div>

                            <!-- Skills -->
                            <div>
                                <h2 class="text-white text-lg font-bold bg-[#0a2149] px-4 py-2 rounded">Skill</h2>
                                <ul class="mt-2 list-disc list-inside text-black text-sm" id="skills-preview">
                                   
                                </ul>
                            </div>

                            <!-- Language -->
                            <div>
                                <h2 class="text-white text-lg font-bold bg-[#0a2149] px-4 py-2 rounded">Language</h2>
                                <ul class="mt-2 text-black text-sm" id="languages-preview">
                                   
                                </ul>
                            </div>
                        </div>
                    <!-- Right Column -->
                    <div class="space-y-6">

                        <!-- Education -->
                        <div>
                            <h2 class="text-white text-lg font-bold bg-[#0a2149] px-4 py-2 rounded">Education</h2>
                            <div class="text-black mt-2 text-sm space-y-2">
                                ${generateEducationPreview()}
                            </div>
                        </div>

                        <!-- Experience -->
                        <div>
                            <h2 class="text-white text-lg font-bold bg-[#0a2149] px-4 py-2 rounded">Experience</h2>
                            <div class="text-black mt-2 text-sm space-y-2 ">
                                ${generateExperiencePreview()}
                            </div>
                        </div>
                    </div>
                </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'business-10'){

                    // Accountant Template 10
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screenw-full font-sans text-black bg-white shadow-md grid grid-cols-[35%_65%]';
                    preview.innerHTML = `
                    <!-- Left Column -->
                    <div class="bg-[#5c4431] text-white p-6 flex flex-col space-y-6">
                        <!-- Profile Image, Name & Title Centered -->
                        <div class="flex flex-col items-center text-center space-y-2">
                            <img src="${window.profileImage || profileImage}" alt="Profile Image" class="w-40 h-40 object-cover border-4 border-white" />

                            <div>
                                <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                                <p class="text-sm mt-1 tracking-wide uppercase">${document.getElementById('title')?.value}</p>
                            </div>
                        </div>
                        <br>

                        <!-- Profile Info -->
                        <div class="text-sm">
                            <h2 class="text-lg font-semibold mb-2 text-[#f5e0c8]">Profile Info</h2>
                            <p class="text-white leading-relaxed">
                            ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Contact Info -->
                        <div class="text-sm">
                            <h2 class="text-lg font-semibold mb-2 text-[#f5e0c8]">Contact</h2>
                            <p class="mb-1">${document.getElementById('phone')?.value}</p>
                            <p class="mb-1">${document.getElementById('email')?.value}</p>
                            <p>${document.getElementById('address')?.value}</p>
                        </div>
                    </div>


                    <!-- Right Column -->
                    <div class="bg-white p-8 space-y-8">

                        <!-- Education -->
                        <div>
                            <h2 class="text-xl font-semibold text-[#5c4431] uppercase mb-4">Education History</h2>
                            
                            <div class="mb-4">
                                ${generateEducationPreview()}
                            </div>
                        </div>

                        <!-- Work Experience -->
                        <div>
                            <h2 class="text-xl font-semibold text-[#5c4431] uppercase mb-4">Work Experience</h2>
                            <div>
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                        <!-- Skills -->
                        <div>
                            <h2 class="text-xl font-semibold text-[#5c4431] uppercase mb-4">Skills</h2>
                            <ul class="list-disc list-inside space-y-1 text-sm text-gray-800" id="skills-preview">
                               
                            </ul>
                        </div>

                        <!-- Language -->
                        <div>
                            <h2 class="text-xl font-semibold text-[#5c4431] uppercase mb-4">Language</h2>
                            <ul class="list-disc list-inside text-sm text-gray-800" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>
                    `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-1'){

                    // Civil Template 1
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen font-sans text-black bg-white shadow-md';
                    preview.innerHTML = `
                    <!-- Header: Name, Title, and Photo -->
                    <div class="flex items-center justify-between px-10 pt-10 mb-8">
                        <div>
                            <h1 class="text-3xl font-semibold text-blue-500">${document.getElementById('name')?.value}</h1>
                            <p class="text-lg text-gray-800">${document.getElementById('title')?.value}</p>
                        </div>
                        <div>
                            <img src="${window.profileImage || profileImage}" alt="Profile" class="w-32 h-32 object-cover border border-black bg-white" />
                        </div>
                    </div>

                    <!-- Body Content -->
                    <div class="flex flex-1 px-10 pb-10">
                        <!-- Left Column -->
                        <div class="w-1/2 pr-4">
                            <div class="space-y-2 text-sm text-gray-700 mb-8">
                                <p>📧 ${document.getElementById('email')?.value}</p>
                                <p>📍 ${document.getElementById('address')?.value}</p>
                                <p>📞 ${document.getElementById('phone')?.value}</p>
                            </div>

                            <div class="mb-8">
                                <h2 class="font-bold text-lg mb-2">STUDIES</h2>
                                <div class="mb-4">
                                    ${generateEducationPreview()}
                                </div>
                            </div>

                            <div>
                                <h2 class="font-bold text-lg mb-2">LANGUAGES</h2>
                                <ul class="list-disc list-inside text-sm text-gray-800" id="languages-preview">
                               
                                </ul>
                            </div>
                        </div>

                        <!-- Right Column -->
                        <div class="w-1/2 pl-4">
                            <div class="mb-8">
                                <h2 class="font-bold text-lg mb-2">PROFILE</h2>
                                <p class="text-sm text-gray-700">
                                    ${document.getElementById('summary')?.value}
                                </p>
                            </div>

                            <div class="mb-8">
                                <h2 class="font-bold text-lg mb-2">EXPERIENCE</h2>
                                ${generateExperiencePreview()}
                            </div>

                            <div>
                                <h2 class="font-bold text-lg mb-2">SKILLS</h2>
                                <ul class="list-disc pl-5 text-sm text-gray-800 space-y-1" id="skills-preview">
                                   
                                </ul>
                            </div>
                        </div>
                    </div>
                    `;
                    previewContainer.appendChild(preview);
                }else if(templateId === 'civil-2'){

                    // Civil Template 2
                    const preview = document.createElement('div');
                    preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen font-sans text-black bg-white shadow-md p-8';
                    preview.innerHTML = `
                        <!-- Header -->
                        <div class="flex items-center gap-6">
                            <!-- Image -->
                            <div class="w-32 h-32 flex-shrink-0">
                                <img src="${window.profileImage || profileImage}" alt="Profile" class="w-full h-full object-cover rounded-full border-[6px] border-[#2A7F8E]" />
                            </div>

                            <!-- Name & Title -->
                            <div class="flex flex-col justify-center">
                                <h1 class="text-3xl font-bold text-[#2A7F8E]">${document.getElementById('name')?.value}</h1>
                                <hr class="border-t-4 border-[#2A7F8E] w-140 my-2" />
                                <p class="text-lg font-semibold text-[#2A7F8E]">${document.getElementById('title')?.value}</p>
                            </div>
                        </div>
                        <br />

                        <!-- Two-Column Content with 40/60 split -->
                        <div class="flex gap-x-6">
                    
                            <!-- LEFT Column - 40% -->
                            <div class="basis-2/5 space-y-10">
                                
                                <!-- Contact -->
                                <div>
                                    <h2 class="text-xl font-semibold text-[#2A7F8E]">Contact</h2>
                                    <hr class="border-t-2 border-[#2A7F8E] w-full my-2" />
                                    <div class="text-sm space-y-1 pl-2">
                                        <p>📧 ${document.getElementById('email')?.value}</p>
                                        <p>📍 ${document.getElementById('address')?.value}</p>
                                        <p>📞 ${document.getElementById('phone')?.value}</p>
                                    </div>
                                </div>

                                <!-- Education -->
                                <div>
                                    <h2 class="text-xl font-semibold text-[#2A7F8E] mb-2">Education</h2>
                                    <hr class="border-t-2 border-[#2A7F8E] w-full my-2" />
                                    <div class="space-y-4 text-sm pl-2">
                                        ${generateEducationPreview()}
                                    </div>
                                </div>

                                <!-- Skills -->
                                <div>
                                    <h2 class="text-xl font-semibold text-[#2A7F8E] mb-2">Skills</h2>
                                    <hr class="border-t-2 border-[#2A7F8E] w-full my-2" />
                                    <ul class="list-disc pl-5 text-sm space-y-1" id="skills-preview">
                                   
                                    </ul>
                                </div>
                            </div>

                            <!-- RIGHT Column - 60% -->
                            <div class="basis-3/5 space-y-10">
                                
                                <!-- Profile -->
                                <div>
                                    <h2 class="text-xl font-semibold text-[#2A7F8E] mb-2">Profile</h2>
                                    <hr class="border-t-2 border-[#2A7F8E] w-full my-2" />
                                    <p class="text-sm text-gray-800 pl-2">
                                        ${document.getElementById('summary')?.value}
                                    </p>
                                </div>

                                <!-- Experience -->
                                <div>
                                    <h2 class="text-xl font-semibold text-[#2A7F8E] mb-2">Experience</h2>
                                    <hr class="border-t-2 border-[#2A7F8E] w-full my-2" />
                                    ${generateExperiencePreview()}
                                </div>

                                <!-- Language -->
                                <div>
                                    <h2 class="text-xl font-semibold text-[#2A7F8E] mb-2">Language</h2>
                                    <hr class="border-t-2 border-[#2A7F8E] w-full my-2" />
                                    <ul class="list-disc pl-5 text-sm space-y-1" id="languages-preview">
                                       
                                    </ul>
                                </div>
                            </div>
                        </div>
                   
                    `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-3'){

                // Civil Template 3
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen font-sans text-black shadow-md grid grid-cols-[30%_70%]';
                preview.innerHTML = `
                <!-- Left Column -->
                <div class="bg-[#1C6F6A] text-white p-6 space-y-8">
                    <!-- Profile Image -->
                    <div class="flex justify-center">
                        <img src="${window.profileImage || profileImage}" alt="Profile" class="w-40 h-40 object-cover rounded shadow-lg border-4 border-white" />
                    </div>

                    <!-- Contact -->
                    <div>
                        <h2 class="text-xl font-bold uppercase mb-2">Contact</h2>
                        <div class="text-sm space-y-2">
                        <p>${document.getElementById('phone')?.value}</p>
                        <p>${document.getElementById('email')?.value}</p>
                        <p>${document.getElementById('address')?.value}</p>
                        </div>
                    </div>

                    <!-- Skills -->
                    <div>
                        <h2 class="text-xl font-bold uppercase mb-2">Skills</h2>
                        <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                       
                        </ul>
                    </div>

                    <!-- Language -->
                    <div>
                        <h2 class="text-xl font-bold uppercase mb-2">Language</h2>
                        <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                       
                        </ul>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="bg-white p-6 space-y-8">
                    <!-- Header -->
                    <br>
                    <div class="text-center">
                        <br>
                        <h1 class="text-3xl font-bold text-[#1C6F6A]">${document.getElementById('name')?.value}</h1>
                        <p class="text-lg font-semibold text-[#1C6F6A] tracking-widest">${document.getElementById('title')?.value}</p>
                        <br>
                    </div>

                    <!-- About Me -->
                    <div>
                        <h2 class="text-xl font-bold uppercase text-[#1C6F6A] mb-2">About Me</h2>
                        <p class="text-sm text-gray-700">
                        ${document.getElementById('summary')?.value}
                        </p>
                    </div>

                    <!-- Education -->
                    <div>
                        <h2 class="text-xl font-bold uppercase text-[#1C6F6A] mb-2">Education</h2>
                        <div class="text-sm space-y-3">
                            <div>
                                ${generateEducationPreview()}
                            </div>
                        </div>
                    </div>

                    <!-- Experience -->
                    <div>
                        <h2 class="text-xl font-bold uppercase text-[#1C6F6A] mb-2">Experience</h2>
                        <div class="text-sm space-y-3">
                            <div>
                                ${generateExperiencePreview()}
                            </div>
                        </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-4'){

                // Civil Template 4
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black shadow-md flex overflow-hidden';
                preview.innerHTML = `
                <!-- LEFT COLUMN (30%) -->
                <div class="w-[30%] bg-[#7c9d7c] text-white flex flex-col items-center p-4 space-y-6">
                
                    <!-- Profile Image -->
                    <div class="w-full flex justify-center">
                        <img src="${window.profileImage || profileImage}" alt="Profile" class="w-40 h-40 object-cover rounded-xl border-4 border-white" />
                    </div>

                    <!-- Contact -->
                    <div class="w-full bg-white text-black px-4 py-2 font-bold text-center rounded-full">
                        CONTACT
                    </div>
                    
                    <div class="text-sm space-y-2 text-black" >
                        <ul class="text-sm list-disc list-inside space-y-1 text-left w-full px-4">
                            <li>${document.getElementById('phone')?.value}</li>
                            <li>${document.getElementById('email')?.value}</li>
                            <li>${document.getElementById('address')?.value}</li>
                        </ul>
                    </div>

                    <!-- Skills -->
                    <div class="w-full bg-white text-black px-4 py-2 font-bold text-center rounded-full">
                        SKILLS
                    </div>
                    <ul class="text-black text-sm list-disc list-inside space-y-1 text-left w-full px-4" id="skills-preview">
                      
                    </ul>

                    <!-- Languages -->
                    <div class="w-full bg-white text-black px-4 py-2 font-bold text-center rounded-full">
                        LANGUAGE
                    </div>
                    <ul class="text-sm list-disc list-inside space-y-1 text-left w-full px-4 text-black" id="languages-preview">
                       
                    </ul>
                </div>

                <!-- RIGHT COLUMN (70%) -->
                <div class="w-[70%] p-8 space-y-8">
                    <br>
                    <!-- Name & Title -->
                    <div>
                        <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-xl font-semibold text-gray-700 tracking-wide">${document.getElementById('title')?.value}</p>
                    </div>

                    <!-- About Me -->
                    <div>
                        <p class="text-sm text-gray-800 leading-relaxed">
                        ${document.getElementById('summary')?.value}
                        </p>
                    </div>

                    <!-- Education -->
                    <div>
                        <div class="bg-[#7c9d7c] text-white font-bold text-center px-6 py-2 w-max mb-4 rounded-full">EDUCATION</div>
                        <div class="space-y-3 text-sm">
                        <div>
                            ${generateEducationPreview()}
                        </div>
                    </div>

                    <!-- Experience -->
                    <div>
                        <div class="bg-[#7c9d7c] text-white font-bold text-center px-6 py-2 w-max mb-4 rounded-full">EXPERIENCE</div>
                        <div class="space-y-4 text-sm">
                            <div>
                                ${generateExperiencePreview()}
                            </div>
                        </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-5'){

                // Civil Template 5
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black shadow-md bg-[#a8c6df]';
                preview.innerHTML = `
                <!-- HEADER -->
                <div class="bg-[#2b608a] px-8 py-6 flex items-center text-white">
                    <div class="w-1/3"></div>
                    <div class="w-1/2 flex flex-col items-center justify-center text-center">
                        <h1 class="text-4xl font-bold uppercase">${document.getElementById('name')?.value}</h1>
                        <p class="text-sm">${document.getElementById('title')?.value}</p>
                    </div>
                    <div class="w-1/3 flex justify-center">
                        <div class="w-32 h-32 rounded-full border-4 border-white overflow-hidden">
                            <img src="${window.profileImage || profileImage}" class="w-full h-full object-cover" />
                        </div>
                    </div>
                </div>

                <!-- CONTACT STRIP -->
                <div class="bg-[#142a4e] text-white text-sm flex flex-wrap justify-center gap-6 px-4 py-3">
                <div class="flex items-center gap-2"><span>📞</span> ${document.getElementById('phone')?.value}</div>
                <div class="flex items-center gap-2"><span>✉️</span> ${document.getElementById('email')?.value}</div>
                <div class="flex items-center gap-2"><span>📍</span> ${document.getElementById('address')?.value}</div>
                </div>

                <!-- MAIN CONTENT -->
                <div class="flex w-full">
                    <!-- LEFT COLUMN (70%) -->
                    <div class="w-[70%] bg-[#2b608a] text-white flex flex-col gap-8 py-8 px-8">
                        <!-- ABOUT ME -->
                        <div>
                            <div class="bg-white text-[#2b608a] font-bold px-6 py-2 rounded-full w-max mb-2">ABOUT ME</div>
                            <p class="text-sm leading-relaxed">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- EXPERIENCE -->
                        <div>
                            <div class="bg-white text-[#2b608a] font-bold px-6 py-2 rounded-full w-max mb-2">EXPERIENCE</div>
                            <div class="space-y-4 text-sm">
                                <div>
                                    ${generateExperiencePreview()}
                                </div>
                               
                            </div>
                        </div>

                        <!-- EDUCATION -->
                        <div>
                            <div class="bg-white text-[#2b608a] font-bold px-6 py-2 rounded-full w-max mb-2">EDUCATION</div>
                            <div class="text-sm space-y-2">
                                <div>
                                    ${generateEducationPreview()}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT COLUMN (30%) -->
                    <div class="w-[30%] flex flex-col justify-start py-8 px-8 space-y-8">
                        <!-- SKILLS -->
                        <div>
                            <div class="bg-[#2b608a] text-white font-bold rounded-full px-6 py-2 w-max mb-2">SKILLS</div>
                            <ul class="list-disc pl-6 text-sm space-y-1" id="skills-preview">
                             
                            </ul>
                        </div>

                        <!-- LANGUAGES -->
                        <div>
                            <div class="bg-[#2b608a] text-white font-bold rounded-full px-6 py-2 w-max mb-2">LANGUAGE</div>
                            <ul class="list-disc pl-6 text-sm space-y-1" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-6'){

                // Civil Template 6
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen font-sans text-black shadow-md';
                preview.innerHTML = `
                 <!-- Header -->
                <div class="relative bg-black text-white p-8 flex items-center">
                    <!-- Profile Image -->
                    <div class="w-40 h-40 rounded-full overflow-hidden border-4 border-gray-400">
                        <img src="${window.profileImage || profileImage}" alt="Profile photo" class="w-full h-full object-cover" />
                    </div>
                    <!-- Name and Title -->
                    <div class="ml-6">
                        <h1 class="text-4xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-lg tracking-wide">${document.getElementById('title')?.value}</p>
                    </div>
                </div>

                <!-- Two Columns -->
                <div class="grid grid-cols-2">
                    <!-- Left Column -->
                    <div class="bg-gray-200 p-8">
                        <!-- Education -->
                        <h2 class="text-lg font-bold border-b-2 border-black mb-4">EDUCATION</h2>
                        <div class="mb-6">
                            ${generateEducationPreview()}
                        </div>

                        <!-- Contact -->
                        <h2 class="text-lg font-bold border-b-2 border-black mb-4">CONTACT</h2>
                        <p class="flex items-center mb-2"><span class="mr-2">📞</span> ${document.getElementById('phone')?.value}</p>
                        <p class="flex items-center mb-2"><span class="mr-2">✉️</span> ${document.getElementById('email')?.value}</p>
                        <p class="flex items-center"><span class="mr-2">📍</span> ${document.getElementById('address')?.value}</p>

                        <!-- Skills -->
                        <h2 class="text-lg font-bold border-b-2 border-black mt-6 mb-4">SKILLS</h2>
                        <ul class="list-disc list-inside text-sm" id="skills-preview">
                          
                        </ul>
                    </div>

                    <!-- Right Column -->
                    <div class="bg-gray-100 p-8">
                        <!-- About -->
                        <h2 class="text-lg font-bold border-b-2 border-black mb-4">ABOUT</h2>
                        <p class="text-sm mb-6">
                            ${document.getElementById('summary')?.value}
                        </p>

                        <!-- Experience -->
                        <h2 class="text-lg font-bold border-b-2 border-black mb-4">EXPERIENCE</h2>
                        <div class="mb-6">
                            ${generateExperiencePreview()}
                        </div>

                        <!-- Language -->
                        <h2 class="text-lg font-bold border-b-2 border-black mt-6 mb-4">LANGUAGE</h2>
                        <ul class="list-disc list-inside text-sm">
                            <li>English</li>
                            <li>Filipino</li>
                            <li>Spanish</li>
                        </ul>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-7'){

                // Civil Template 7
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="text-center pt-0">
                    <div class="pt-6">
                        <div class="border-b-4 border-black mt-6 mx-10"></div>
                    <br>
                    <img src="${window.profileImage || profileImage}" alt="Profile" class="w-28 h-28 mx-auto rounded-full border border-black" />
                    <h1 class="text-3xl font-bold mt-4">${document.getElementById('name')?.value}</h1>
                    <p class="text-lg font-light tracking-wide">${document.getElementById('title')?.value}</p>
                        <div class="border-b-4 border-black mt-6 mx-10"></div>
                    </div>
                </div>

                <!-- Body -->
                <div class="flex divide-x divide-black mt-6 px-8">
                    <!-- Left Column -->
                    <div class="w-1/2 pr-6 space-y-6">
                        <!-- About Me -->
                        <div>
                            <h2 class="uppercase text-lg font-semibold border-b-4 border-black inline-block mb-2">About Me</h2>
                            <p class="text-sm leading-relaxed">
                            ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Contact -->
                        <div>
                            <h2 class="uppercase text-lg font-semibold border-b-4 border-black inline-block mb-2">Contact</h2>
                            <ul class="text-sm space-y-1">
                                <li class="flex items-center gap-2">📧 ${document.getElementById('email')?.value}</li>
                                <li class="flex items-center gap-2">📞 ${document.getElementById('phone')?.value}</li>
                                <li class="flex items-center gap-2">📍 ${document.getElementById('address')?.value}</li>
                                <li class="flex items-center gap-2">🌐 ${document.getElementById('website')?.value}</li>
                            </ul>
                        </div>

                        <!-- Skills -->
                        <div>
                            <h2 class="uppercase text-lg font-semibold border-b-4 border-black inline-block mb-2">Skills</h2>
                            <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                             
                            </ul>
                        </div>

                        <!-- Languages -->
                        <div>
                            <h2 class="uppercase text-lg font-semibold border-b-4 border-black inline-block mb-2">Languages</h2>
                            <div class="text-sm space-y-1">
                                <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                                   
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="w-1/2 pl-6 space-y-6">

                        <!-- Experience -->
                        <div>
                            <h2 class="uppercase text-lg font-semibold border-b-4 border-black inline-block mb-2">Experience</h2>
                            <div class="text-sm space-y-4">
                                <div>
                                    ${generateExperiencePreview()}
                                </div>
                                
                            </div>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="uppercase text-lg font-semibold border-b-4 border-black inline-block mb-2">Education</h2>
                            <div class="text-sm space-y-4">
                                <!-- School 1 -->
                                <div>
                                    ${generateEducationPreview()}
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer Bar -->
                <div class="h-4 bg-black mt-8"></div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-8'){

                // Civil Template 8
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md flex';
                preview.innerHTML = `
                <!-- Sidebar -->
                <div class="w-1/3 bg-purple-100 p-6 flex flex-col items-center">
                    <div class="relative w-34 h-34 mb-4">
                        <img src="${window.profileImage || profileImage}" alt="Profile" class=" w-full h-full object-cover border-2 border-white shadow-md" />
                    </div>

                    <!-- Skills -->
                    <div class="w-full mt-6">
                        <h2 class="text-purple-500 text-lg font-semibold mb-2">Skills</h2>
                        <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                           
                        </ul>
                    </div>

                    <!-- Contact -->
                    <div class="w-full mt-8">
                        <h2 class="text-purple-500 text-lg font-semibold mb-2">Contact</h2>
                        <p class="text-xs font-bold mt-2 uppercase">Address</p>
                        <p class="text-sm">${document.getElementById('address')?.value}</p>
                        <p class="text-xs font-bold mt-2 uppercase">Email</p>
                        <p class="text-sm">${document.getElementById('email')?.value}</p>
                        <p class="text-xs font-bold mt-2 uppercase">Website</p>
                        <p class="text-sm">${document.getElementById('website')?.value}</p>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="w-2/3 p-8">
                    <!-- Name & Title -->
                    <div class="text-right">
                        <br>
                        <h1 class="text-3xl font-bold text-purple-600">${document.getElementById('name')?.value}</h1>
                        <p class="uppercase tracking-wider text-sm font-semibold text-gray-700">${document.getElementById('title')?.value}</p>
                        <br>
                    </div>

                    <!-- Divider -->
                    <div class="border-b border-gray-300 my-4"></div>
                    <!-- Profile -->
                    <div class="mb-6">
                        <h2 class="text-purple-500 text-lg font-semibold mb-2">Profile</h2>
                        <p class="text-sm text-gray-800">
                            ${document.getElementById('summary')?.value}
                        </p>
                    </div>

                    <!-- Education -->
                    <div class="mb-6">
                        <h2 class="text-purple-500 text-lg font-semibold mb-2">Education</h2>
                        <div class="space-y-4 text-sm">
                            <!-- School 1 -->
                            <div>
                                ${generateEducationPreview()}
                            </div>
                            
                        </div>
                    </div>

                    <!-- Work Experience -->
                    <div>
                        <h2 class="text-purple-500 text-lg font-semibold mb-2">Work Experience</h2>
                        <div class="space-y-6 text-sm">
                            <div>
                                ${generateExperiencePreview()}
                            </div>
                            
                            </div>
                            
                        </div>
                    </div>

                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-9'){

                // Civil Template 9
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="flex bg-blue-900 text-white p-6">
                    <div class="w-2/3">
                        <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-lg">${document.getElementById('title')?.value}</p>
                    </div>
                    <div class="w-1/3">
                        <img src="${window.profileImage || profileImage}" alt="Profile" class="w-28 h-28 object-cover  mx-auto" />
                    </div>
                </div>

                <!-- Contact Info -->
                <div class="flex items-center justify-between bg-blue-200 text-blue-900 px-6 py-4 text-sm">
                    <div class="flex items-center gap-2">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M21 8V7l-3 2-2-1-1 2 3 2v-1l3-2z"></path></svg>
                        <span>${document.getElementById('email')?.value}</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M6.62 10.79a15.053 15.053 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.27 11.72 11.72 0 003.69.59 1 1 0 011 1v3.61a1 1 0 01-.76.97A17.09 17.09 0 013 5a1 1 0 01.97-.76H7.58a1 1 0 011 1 11.72 11.72 0 00.59 3.69 1 1 0 01-.27 1.11l-2.28 2.28z"></path></svg>
                        <span>${document.getElementById('phone')?.value}</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5S10.62 6.5 12 6.5 14.5 7.62 14.5 9 13.38 11.5 12 11.5z"></path></svg>
                        <span>${document.getElementById('address')?.value}</span>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="flex">
                    <!-- Left -->
                    <div class="w-1/2 p-6 space-y-6">
                        <!-- About Me -->
                        <div>
                            <h2 class="text-blue-900 text-lg font-semibold mb-2">ABOUT ME</h2>
                            <p class="text-sm text-gray-800">${document.getElementById('summary')?.value}</p>
                        </div>

                        <!-- Experience -->
                        <div>
                            <h2 class="text-blue-900 text-lg font-semibold mb-2">EXPERIENCE</h2>
                            <div class="space-y-4">
                                <div>
                                    ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right -->
                    <div class="w-1/2 bg-blue-100 p-6 space-y-6">
                        <!-- Education -->
                        <div>
                            <h2 class="text-blue-900 text-lg font-semibold mb-2">EDUCATION</h2>
                            <div class="space-y-3">
                                <div>
                                    ${generateEducationPreview()}
                                </div>
                            </div>
                        </div>

                        <!-- Skills -->
                        <div>
                            <h2 class="text-blue-900 text-lg font-semibold mb-2">SKILLS</h2>
                            <ul class="list-disc list-inside text-sm text-gray-800" id="skills-preview">
                             
                            </ul>
                        </div>

                        <!-- Language -->
                        <div>
                            <h2 class="text-blue-900 text-lg font-semibold mb-2">LANGUAGE</h2>
                            <ul class="text-sm text-gray-800 space-y-1" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'civil-10'){

                // Civil Template 10
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans bg-white p-6 shadow-md';
                preview.innerHTML = `
                <!-- Header with Image, Name, Title -->
                <div class="flex flex-col items-center border border-black py-4 mb-6">
                    <img src="${window.profileImage || profileImage}" alt="Profile" class="w-32 h-32 rounded-full object-cover border-2 border-black mb-3">
                    <h1 class="text-2xl font-bold text-blue-900">${document.getElementById('name')?.value}</h1>
                    <p class="text-sm text-gray-700">${document.getElementById('title')?.value}</p>
                </div>

                <!-- Grid Layout: Sidebar and Main Content -->
                <div class="grid grid-cols-[5%_35%_60%]">

                    <!-- Left Spacer -->
                    <div></div>

                    <!-- Sidebar -->
                    <div class="bg-gray-100 p-4 text-sm text-black space-y-6">
                        <!-- Contact -->
                        <div>
                            <h2 class="text-white bg-blue-800 px-2 py-1 text-xs font-bold tracking-widest mb-2">CONTACT</h2>
                            <p>📞 ${document.getElementById('phone')?.value}</p>
                            <p>📍 ${document.getElementById('address')?.value}</p>
                            <p>📧 ${document.getElementById('email')?.value}</p>
                        </div>
                        <br>
                        <!-- Skills -->
                        <div>
                            <h2 class="text-white bg-blue-800 px-2 py-1 text-xs font-bold tracking-widest mb-2">SKILLS</h2>
                            <ul class="list-disc list-inside space-y-1" id="skills-preview">
                                
                            </ul>
                        </div>
                        <br>
                        <!-- Language -->
                        <div>
                            <h2 class="text-white bg-blue-800 px-2 py-1 text-xs font-bold tracking-widest mb-2">LANGUAGE</h2>
                            <ul class="list-disc list-inside" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="p-6 space-y-6">
                        <!-- Profile Summary -->
                        <div>
                            <p class="text-sm text-gray-700 leading-relaxed">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="bg-gray-200 text-center text-sm font-bold tracking-wider py-1">EDUCATION</h2>
                            <div class="mt-2 space-y-2 text-sm text-gray-800">
                                <div>
                                    ${generateEducationPreview()}
                                </div>
                                
                            </div>
                        </div>
                        <br>
                        <!-- Experience -->
                        <div>
                            <h2 class="bg-gray-200 text-center text-sm font-bold tracking-wider py-1">EXPERIENCE</h2>

                            <div class="mt-2 space-y-4 text-sm text-gray-800">
                                <div>
                                    ${generateExperiencePreview()}
                                </div>
                            </div>
                        </div>
                        <br>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-1'){

                // Generic Template 1
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] w-full bg-white shadow-lg p-8 space-y-6';
                preview.innerHTML = `
                <!-- 🔹 Profile Section (Top) -->
                <div class="flex items-center gap-4">
                    <img src="${window.profileImage || profileImage}" alt="Profile"  class="w-20 h-20 object-cover border border-black bg-white">
                    <div>
                        <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-gray-600">${document.getElementById('title')?.value}</p>
                    </div>
                </div>

                <!-- 🔹 Two Column Layout -->
                <div class="flex gap-6">
                
                    <!-- Left Column -->
                    <div class="md:w-2/3 space-y-6">
                        <!-- Profile -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>🧾</span> Profile
                            </h2>
                            <p class="text-sm leading-relaxed">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>
                        <!-- Employment History -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>💼</span> Employment History
                            </h2>
                            <!-- Job 1 -->
                            <div class="mb-4">
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>🎓</span> Education
                            </h2>
                            <p class="text-sm">
                                ${generateEducationPreview()}
                            </p>
                        </div>

                        <!-- Courses -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>📚</span> Courses
                            </h2>
                        </div>
                    </div>

                <!-- Right Column -->
                <div class="w-1/3 space-y-6">
                    <!-- Details -->
                    <div>
                        <h3 class="text-lg font-semibold">Details</h3>
                        <p class="text-sm">${document.getElementById('address')?.value}</p>
                        <p class="text-sm mt-2">${document.getElementById('phone')?.value}<br><a href="#" class="text-blue-500">${document.getElementById('email')?.value}</a></p>
                    </div>

                    <!-- Skills -->
                    <div>
                        <h3 class="text-lg font-semibold">Skills</h3>
                        <ul class="text-sm space-y-1" id="skills-preview">
                           
                        </ul>
                    </div>

                    <!-- Hobbies -->
                    <div>
                        <h3 class="text-lg font-semibold">Hobbies</h3>
                        <ul class="text-sm space-y-1" id="hobbies-preview">
                           
                        </ul>
                    </div>

                    <!-- Languages -->
                    <div>
                        <h3 class="text-lg font-semibold">Languages</h3>
                        <ul class="text-sm space-y-1" id="languages-preview">
                          
                        </ul>
                    </div>
                </div>
            </div>
                `;
                previewContainer.appendChild(preview);
            }else if(templateId === 'generic-2'){

                // Generic Template 2
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen font-sans mx-auto p-10 grid grid-cols-3 gap-10';
                preview.innerHTML = `
                <!-- Left Content (2/3) -->
                <div class="col-span-2 space-y-8">
                    <!-- Header: Image + Name/Contact -->
                    <div class="flex">
                        <div class="w-24 h-24 shrink-0">
                            <img src="${window.profileImage || profileImage}" alt="Profile" class="w-full h-full object-cover" />
                        </div>
                        <div class="ml-6 flex flex-col justify-center">
                            <h1 class="text-4xl font-bold text-blue-600">${document.getElementById('name')?.value}</h1>
                            <h1 class="text-1xl font-bold text-blue-600">${document.getElementById('title')?.value}</h1>
                            <div class="mt-1 text-sm text-gray-700">
                                <p>${document.getElementById('address')?.value}</p>
                                <p>${document.getElementById('email')?.value} &middot; ${document.getElementById('phone')?.value}</p>
                            </div>
                        </div>
                    </div>
            
                    <!-- Profile -->
                    <div>
                        <h2 class="uppercase font-semibold tracking-wider text-sm text-gray-600 mb-2">Profile</h2>
                        <p class="text-sm leading-relaxed">
                            ${document.getElementById('summary')?.value}
                        </p>
                    </div>
            
                    <!-- Employment History -->
                    <div>
                        <h2 class="uppercase font-semibold tracking-wider text-sm text-gray-600 mb-4">Employment History</h2>
                
                        <!-- Job 1 -->
                        <div class="mb-6">
                            ${generateExperiencePreview()}
                        </div>
                
                     
                    </div>
            
                    <!-- Education -->
                    <div>
                        <h2 class="uppercase font-semibold tracking-wider text-sm text-gray-600 mb-4">Education</h2>
                        <div class="mb-4">
                            ${generateEducationPreview()}
                        </div>
                        
                    </div>
                </div>
            
                <!-- Right Sidebar (1/3) -->
                <div class="space-y-8 text-sm text-gray-800">
            
                    <!-- Skills -->
                    <div>
                        <h2 class="uppercase font-semibold tracking-wider text-sm text-gray-600 mb-2">Skills</h2>
                        <ul class="list-disc list-inside space-y-1" id="skills-preview">
                        
                        </ul>
                    </div>
            
                    <!-- Hobbies -->
                    <div>
                        <h2 class="uppercase font-semibold tracking-wider text-sm text-gray-600 mb-2">Hobbies</h2>
                        <ul class="list-disc list-inside space-y-1" id="hobbies-preview">
                          
                        </ul>
                    </div>
            
                    <!-- Languages -->
                    <div>
                        <h2 class="uppercase font-semibold tracking-wider text-sm text-gray-600 mb-2">Languages</h2>
                        <ul class="list-disc list-inside space-y-1" id="languages-preview">
                            
                        </ul>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-3'){

                // Generic Template 3
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen bg-white shadow p-0 text-gray-900 font-sans';
                preview.innerHTML = `
                <!-- Header -->
                <div class="flex  w-full h-52">
                    <!-- Left: Large Profile Image -->
                    <div class="flex items-center justify-center w-1/3 ">
                        <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="h-full w-auto object-cover">
                    </div>
                
                    <!-- Right: Name and Title -->
                    <div class="flex flex-col justify-center w-2/3 px-6">
                        <h1 class="text-5xl font-bold text-black">${document.getElementById('name')?.value}</h1>
                        <p class="text-xl text-black">${document.getElementById('title')?.value}</p>
                    </div>
                </div>
            
                <!-- Details -->
                <div class="px-8 pt-8 pb-4">
                    <div class="bg-black text-white text-xs font-semibold px-2 py-1 inline-block mb-3 uppercase">Details</div>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <p>${document.getElementById('address')?.value}</p>
                                <p class="text-blue-700">${document.getElementById('email')?.value}</p>
                                <p>${document.getElementById('phone')?.value}</p>
                               
                            </div>
                        </div>
                    </div>
            
                    <!-- Profile -->
                    <div class="px-8 pt-4 pb-6">
                        <div class="bg-black text-white text-xs font-semibold px-2 py-1 inline-block mb-2 uppercase">Profile</div>
                        <p class="italic text-sm leading-relaxed">
                            ${document.getElementById('summary')?.value}
                        </p>
                    </div>
                
                    <!-- Employment History -->
                    <div class="px-8 pt-4 pb-6">
                        <div class="bg-black text-white text-xs font-semibold px-2 py-1 inline-block mb-3 uppercase">Employment History</div>
                    
                        <div class="mb-4">
                            ${generateExperiencePreview()}
                        </div>
                

                    </div>
                
                    <!-- Education -->
                    <div class="px-8 pt-4 pb-10">
                        <div class="bg-black text-white text-xs font-semibold px-2 py-1 inline-block mb-3 uppercase">Education</div>
                        <div class="mb-4">
                            ${generateEducationPreview()}
                        </div>
                        
                    </div>

                     <!-- Skills -->
                    <div class="px-8 pt-4 pb-10">
                        <div class="bg-black text-white text-xs font-semibold px-2 py-1 inline-block mb-3 uppercase">Skills</div>
                        <div class="mb-4">
                            <ul class="list-disc list-inside space-y-1" id="skills-preview">
                              
                            </ul>
                        </div>
                        
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-4'){

                // Generic Template 4
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen text-black font-sans space-y-8 bg-white p-8 shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="flex items-start">
                    <!-- Image on the far left -->
                    <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-32 object-cover rounded-md mr-6" />

                    <!-- Right side: Name/Title + Email/Phone + Line + Address -->
                    <div class="flex-1">
                        <!-- Top row: Name + Title and Email + Phone -->
                        <div class="flex justify-between items-start">
                            <div>
                                <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                                <p class="text-sm font-medium">${document.getElementById('title')?.value}</p>
                            </div>
                            <div class="text-sm text-right space-y-1">
                                <p>${document.getElementById('email')?.value}</p>
                                <p>${document.getElementById('phone')?.value}</p>
                            </div>
                        </div>

                        <!-- Horizontal line -->
                        <hr class="my-3 border-black" />

                        <!-- Address details -->
                        <div class="text-sm space-y-1">
                            <p>${document.getElementById('address')?.value}</p>
                        </div>
                    </div>
                </div>

                <!-- Summary -->
                <div>
                    <p class="italic text-[15px] leading-relaxed">
                        ${document.getElementById('summary')?.value}
                    </p>
                </div>

                <!-- Skills -->
                <div>
                    <h2 class="text-md font-semibold mb-2">Skills</h2>
                    <ul class="list-disc pl-5 text-sm flex flex-wrap gap-x-8 gap-y-1" id="skills-preview">
                      
                    </ul>
                </div>

                <!-- Employment History -->
                <div class="space-y-6">
                    <h2 class="text-md font-semibold">Employment History</h2>

                    ${generateExperiencePreview()}
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-5'){

                // Generic Template 5
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen mx-auto p-10 flex flex-col shadow-md rounded-md';
                preview.innerHTML = `
                <!-- Header with Image + Contact Info -->
                <div class="flex items-center justify-between mb-10">
                    <div class="flex items-center space-x-6">
                        <!-- Image -->
                        <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-24 h-24 object-cover rounded-md" />
            
                        <!-- Name and Contact -->
                        <div>
                            <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                            <p class="text-md font-medium mb-2">${document.getElementById('title')?.value}</p>
                            <p class="text-sm">${document.getElementById('phone')?.value}</p>
                            <p class="text-sm">${document.getElementById('email')?.value}</p>
                        </div>
                    </div>
                </div>
            
                <!-- Main Content -->
                <div class="space-y-10">
                    <!-- Role + Summary -->
                    <div class="flex">
                    <!-- Right: Summary -->
                        <p class="italic text-sm leading-relaxed">
                        ${document.getElementById('summary')?.value}
                        </p>
                    </div>
            
                    <!-- Skills and Languages -->
                    <div class="grid grid-cols-2 gap-6 text-sm">
                        <div>
                            <h2 class="font-semibold mb-2">Skills</h2>
                            <ul class="list-disc list-inside space-y-1" id="skills-preview">
                             
                            </ul>
                        </div>
                        <div>
                            <h2 class="font-semibold mb-2">Languages</h2>
                            <ul class="list-disc list-inside space-y-1" id="languages-preview">
                               
                            </ul>
                        </div>
                    </div>
            
                    <!-- Employment History -->
                    <div>
                        <h2 class="font-semibold text-md mb-4">Employment History</h2>
                
                        <!-- Job 1 -->
                        <div class="mb-6">
                            ${generateExperiencePreview()}
                        </div>
                
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-6'){

                // Generic Template 6
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full text-black font-sans space-y-8 bg-white p-8 shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="grid grid-cols-[30%_70%] gap-6 mb-6 text-black p-6 rounded border border-black">
                    
                    <!-- Left: Image -->
                    <div class="flex justify-center items-center">
                        <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-40 h-40 object-cover border-2 border-black">
                    </div>

                    <!-- Right: Name and Contact Info -->
                    <div class="space-y-2 text-left">
                        <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-xl">${document.getElementById('title')?.value}</p>

                        <div class="mt-4 space-y-1">
                        <p class="text-sm">${document.getElementById('address')?.value}</p>
                        </div>
                        <div class="space-y-1">
                        <p class="text-sm">${document.getElementById('phone')?.value}</p>
                        </div>
                        <div class="space-y-1">
                        <p class="text-sm">${document.getElementById('email')?.value}</p>
                        </div>
                    </div>

                </div>


                <!-- Body: 2 Column Layout (30% / 70%) -->
                <div class="grid grid-cols-[30%_70%] gap-6">
                    
                    <!-- Left Column -->
                <div class="space-y-4">

            
                <div>
                    <h2 class="text-lg font-semibold text-gray-800">Languages</h2>
                    <ul class="list-disc list-inside text-sm text-gray-700" id="languages-preview">
                      
                    </ul>
                </div>

                <div>
                <h2 class="text-lg font-semibold text-gray-800">Hobbies</h2>
                <ul class="list-disc list-inside text-sm text-gray-700" id="hobbies-preview">
                   
                </ul>
                </div>

                <div>
                <h2 class="text-lg font-semibold text-gray-800">Skills</h2>
                <ul class="list-disc list-inside text-sm text-gray-700" id="skills-preview">
                 
                </ul>
                </div>
                </div>


                    <!-- Right Column -->
                    <div class="space-y-6">
                    <div>
                        <h2 class="text-xl font-bold text-gray-900 mb-1">Profile</h2>
                        <p class="text-sm text-gray-800 leading-relaxed">
                        ${document.getElementById('summary')?.value}
                        </p>
                    </div>

                    <div>
                        <h2 class="text-xl font-bold text-gray-900 mb-2">Employment History</h2>
                        <div class="mb-4">
                        <p class="font-semibold text-gray-800">${generateExperiencePreview()}</p>
                        <p class="text-sm text-gray-600 italic">May 2022 — May 2022</p>
                        <ul class="list-disc list-inside text-sm text-gray-800 mt-1 space-y-1">
                            <li>${generateExperiencePreview()}</li>
                        </ul>
                        </div>
                        <div>
                        <p class="font-semibold text-gray-800">${generateExperiencePreview()}</p>
                        <p class="text-sm text-gray-600 italic">January 2019 — April 2021</p>
                        <ul class="list-disc list-inside text-sm text-gray-800 mt-1 space-y-1">
                            <li>${generateExperiencePreview()}</li>
                        </ul>
                        </div>
                    </div>

                    <div>
                        <h2 class="text-xl font-bold text-gray-900 mb-1">Education</h2>
                        <p class="text-sm text-gray-800 font-semibold">${generateEducationPreview()}</p>
                       
                    </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-7'){

                // Generic Template 7
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full text-black font-sans space-y-8 bg-white p-8 shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="flex items-start gap-6">
                    <img src="${window.profileImage || profileImage}" alt="Profile" class="w-32 object-cover rounded-md" />
                
                    <div class="flex-1 space-y-1">
                        <!-- Name on full-width line -->
                        <div class="relative">
                        <hr class="border-t-4 border-[#0BA29C]" />
                        <span class="absolute left-0 -top-3 bg-white pr-3 text-xl font-bold text-[#0BA29C]">${document.getElementById('name')?.value}</span>
                        </div>
                        <br>
                        <p class="font-semibold text-sm">${document.getElementById('title')?.value}</p>
                        <p class="text-sm"><span class="font-bold">Phone:</span> ${document.getElementById('phone')?.value}</p>
                        <p class="text-sm"><span class="font-bold">Address:</span> ${document.getElementById('address')?.value}</p>
                        <p class="text-sm"><span class="font-bold">Email:</span> ${document.getElementById('email')?.value}</p>
                    </div>
                </div>


                <p class="text-sm">
                ${document.getElementById('summary')?.value}
                </p>

                <!-- Experience -->
                <div>
                    <div class="relative mb-4">
                        <hr class="border-t-4 border-[#0BA29C]" />
                        <span class="absolute left-0 -top-3 bg-white pr-4 text-lg font-bold text-[#0BA29C] uppercase">
                            Experience
                        </span>
                    </div>
                    <br>

                    <!-- Job 1 -->
                    <div class="mb-4">
                        ${generateExperiencePreview()}
                    </div>

                    
                </div>

                <!-- Education -->
                <div>
                    <div class="relative mb-4">
                        <hr class="border-t-4 border-[#0BA29C]" />
                        <span class="absolute left-0 -top-3 bg-white pr-4 text-lg font-bold text-[#0BA29C] uppercase">
                                Education
                        </span>
                    </div>

                    <ul class="list-disc list-inside text-sm space-y-1">
                        ${generateEducationPreview()}
                    </ul>
                </div>
            `;
            previewContainer.appendChild(preview);
            }else if(templateId === 'generic-8'){

                // Generic Template 8
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen w-full font-sans text-black bg-white p-8 shadow-md space-y-6';
                preview.innerHTML = `
                <!-- Header Row -->
                <div class="flex justify-between items-start gap-6">
                    <!-- Name and Contact Info -->
                    <div class="space-y-1">
                        <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-sm font-medium">${document.getElementById('title')?.value}</p>
                        <div class="text-sm space-y-1 mt-2">
                            <p><span class="font-bold">Phone:</span> ${document.getElementById('phone')?.value}</p>
                            <p><span class="font-bold">Email:</span> ${document.getElementById('email')?.value}</p>
                            <p><span class="font-bold">Address:</span> ${document.getElementById('address')?.value}</p>
                        </div>
                    </div>
                <!-- Profile Image -->
                    <img src="${window.profileImage || profileImage}" alt="Profile" class="w-40 rounded-full object-cover" />
                </div>

                <!-- Main Grid Layout -->
                <div class="grid grid-cols-3 gap-6">
                
                    <!-- Left Column -->
                    <div class="col-span-2 space-y-6">
                        <!-- Professional Experience -->
                        <div>
                            <h2 class="text-[#008080] text-lg font-bold uppercase border-b-2 border-[#008080] mb-2">Professional Experience</h2>

                            <!-- Job 1 -->
                            <div class="mb-4">
                                ${generateExperiencePreview()}
                            </div>

                          
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="col-span-1 space-y-6">
                        <!-- Profile -->
                        <div>
                            <h2 class="text-[#008080] text-lg font-bold uppercase border-b-2 border-[#008080] mb-2">Profile</h2>
                            <p class="text-sm">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="text-[#008080] text-lg font-bold uppercase border-b-2 border-[#008080] mb-2">Education</h2>
                            <ul class="list-disc list-inside text-sm space-y-1">
                                ${generateEducationPreview()}
                            </ul>
                        </div>

                        <!-- Key Skills -->
                        <div>
                            <h2 class="text-[#008080] text-lg font-bold uppercase border-b-2 border-[#008080] mb-2">Key Skills</h2>
                            <ul class="list-disc list-inside text-sm space-y-1" id="skills-preview">
                              
                            </ul>
                        </div>
                    </div>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-9'){

                // Generic Template 9
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen text-black font-sans space-y-8 bg-white p-8 shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="text-center">
                    <hr>
                    <h1 class="text-xl font-bold">${document.getElementById('name')?.value}</h1>
                    <p>${document.getElementById('address')?.value}</p>
                    <p>• ${document.getElementById('phone')?.value} • ${document.getElementById('email')?.value}</p>
                    <hr>
                </div>

                <!-- Top Section: Title + Image + Objective + Skills -->
                <div class="grid grid-cols-2 gap-6 items-start">
                    <!-- Title and Image -->
                    <div class="space-y-4">
                        <h2 class="font-semibold text-center">Human Resources Manager</h2>
                        <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-32 object-cover rounded-md mx-auto" />
                    </div>

                    <!-- Objective and Skills -->
                    <div>
                        <h2 class="font-semibold">OBJECTIVE</h2>
                        <p class="text-sm">
                        ${document.getElementById('summary')?.value}
                        </p>

                        <h2 class="font-semibold mt-3">SKILLS</h2>
                        <ul class="list-disc list-inside text-sm" id="skills-preview">
                         
                        </ul>
                    </div>
                </div>

                <!-- Professional Experience -->
                <div>
                    <hr class="mb-2" />
                    <h2 class="font-semibold uppercase mb-2">Professional Experience</h2>
                    <hr class="mb-4" />

                    <!-- Job 1 -->
                    <div class="mb-6">
                        ${generateExperiencePreview()}
                    </div>
                </div>

                <!-- Certifications -->
                <div>
                    <hr class="mb-2" />
                    <h2 class="font-semibold uppercase mb-2">Certifications</h2>
                    <hr class="mb-4" />

                    <div class="mb-4 text-sm">
                        <p><span class="font-semibold">Human Sciences College</span></p>
                        <p><em>National Institute for Metalworking Skills Certification</em></p>
                        <p>October 2020</p>
                    </div>

                    <div class="text-sm">
                        <p><span class="font-semibold">Forklifter Association of America</span></p>
                        <p><em>Certified Forklift Driver</em></p>
                        <p>January 2014</p>
                    </div>
                </div>

                <!-- Languages -->
                <div>
                    <hr class="mb-2" />
                    <h2 class="font-semibold uppercase mb-2">Languages</h2>
                    <hr class="mb-4" />
                    <ul class="list-disc list-inside text-sm space-y-1" id="languages-preview">
                       
                    </ul>
                </div>
                `;
                previewContainer.appendChild(preview);
                }else if(templateId === 'generic-10'){

                // Generic Template 10
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] min-h-screen text-black font-sans space-y-8 bg-white p-8 shadow-md';
                preview.innerHTML = `
                <!-- Header -->
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-lg font-semibold">${document.getElementById('title')?.value || 'Job Title'}</p>
                    </div>
                    <img src="${window.profileImage || profileImage}" alt="Profile Photo" class="w-20 h-20 object-cover rounded-full" />
                </div>

                <hr />

                <!-- Summary -->
                <div>
                    <h2 class="font-semibold mb-1">Summary</h2>
                    <div class="pl-4 text-sm space-y-1">
                        <p>
                            ${document.getElementById('summary')?.value}
                        </p>
                    </div>
                </div>

                <!-- Education -->
                <div>
                    <h2 class="font-semibold mb-1">Education</h2>
                    <div class="pl-4 text-sm space-y-1">
                        <p>
                            ${generateEducationPreview()}
                        </p>
                        
                    </div>
                </div>

                <!-- Skills -->
                <div>
                    <h2 class="font-semibold mb-1">Skills</h2>
                    <ul class="list-disc list-inside text-sm pl-4 space-y-1" id="skills-preview">
                      
                    </ul>
                </div>

                <!-- Work Experience -->
                <div>
                    <h2 class="font-semibold uppercase mb-1">Work Experience</h2>
                    <br>
                    <!-- Job 1 -->
                    <div class="pl-4 space-y-1">
                        ${generateExperiencePreview()}
                    </div>
                    <br>
                    
                </div>
                `;
                previewContainer.appendChild(preview);
                } else {
                // Default template preview
                const preview = document.createElement('div');
                preview.className = 'min-w-[210mm] max-w-[210mm] w-[210mm] w-full bg-white shadow-lg p-8 space-y-6';
                preview.innerHTML = `
                <!-- 🔹 Profile Section (Top) -->
                <div class="flex items-center gap-4">
                    <img src="${window.profileImage || profileImage}" alt="Profile"  class="w-20 h-20 object-cover border border-black bg-white">
                    <div>
                        <h1 class="text-2xl font-bold">${document.getElementById('name')?.value}</h1>
                        <p class="text-gray-600">${document.getElementById('title')?.value}</p>
                    </div>
                </div>

                <!-- 🔹 Two Column Layout -->
                <div class="flex gap-6">
                
                    <!-- Left Column -->
                    <div class="md:w-2/3 space-y-6">
                        <!-- Profile -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>🧾</span> Profile
                            </h2>
                            <p class="text-sm leading-relaxed">
                                ${document.getElementById('summary')?.value}
                            </p>
                        </div>
                        <!-- Employment History -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>💼</span> Employment History
                            </h2>
                            <!-- Job 1 -->
                            <div class="mb-4">
                                ${generateExperiencePreview()}
                            </div>
                        </div>

                        <!-- Education -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>🎓</span> Education
                            </h2>
                            <p class="text-sm">
                                ${generateEducationPreview()}
                            </p>
                        </div>

                        <!-- Courses -->
                        <div>
                            <h2 class="text-lg font-semibold flex items-center gap-2 mb-2">
                                <span>📚</span> Courses
                            </h2>
                        </div>
                    </div>

                <!-- Right Column -->
                <div class="w-1/3 space-y-6">
                    <!-- Details -->
                    <div>
                        <h3 class="text-lg font-semibold">Details</h3>
                        <p class="text-sm">${document.getElementById('address')?.value}</p>
                        <p class="text-sm mt-2">${document.getElementById('phone')?.value}<br><a href="#" class="text-blue-500">${document.getElementById('email')?.value}</a></p>
                    </div>

                    <!-- Skills -->
                    <div>
                        <h3 class="text-lg font-semibold">Skills</h3>
                        <ul class="text-sm space-y-1" id="skills-preview">
                          
                        </ul>
                    </div>

                    <!-- Hobbies -->
                    <div>
                        <h3 class="text-lg font-semibold">Hobbies</h3>
                        <ul class="text-sm space-y-1" id="hobbies-preview">
                           
                        </ul>
                    </div>

                    <!-- Languages -->
                    <div>
                        <h3 class="text-lg font-semibold">Languages</h3>
                        <ul class="text-sm space-y-1" id="languages-preview">
                          
                        </ul>
                    </div>
                </div>
            </div>
                `;
                previewContainer.appendChild(preview);
            }
            addAIEnhanceButtons();

            // Update skills preview
            const skillsLists = document.querySelectorAll('.skills-list');
            const skillsPreview = previewContainer.querySelector('#skills-preview');
            if (skillsPreview) {
                skillsPreview.innerHTML = '';
                skillsLists.forEach(list => {
                    const skills = Array.from(list.querySelectorAll('.skill-badge'))
                        .map(badge => badge.textContent.replace('×', '').trim());
                    if (skills.length > 0) {
                        const categoryDiv = document.createElement('div');
                        
                        categoryDiv.innerHTML = `
                            <ul class="skill-list">
                                ${skills.map(skill => `<li>${skill}</li>`).join('')}
                            </ul>
                        `;
                        skillsPreview.appendChild(categoryDiv);
                    }
                });
            }

            // Update experience preview
            const experiencePreview = previewContainer.querySelector('#experience-preview');
            if (experiencePreview) {
                experiencePreview.innerHTML = generateExperiencePreview();
            }

            // Update projects preview
            const projectItems = document.querySelectorAll('.project-item');
            const projectsPreview = previewContainer.querySelector('#projects-preview');
            if (projectsPreview) {
                projectsPreview.innerHTML = '';
                projectItems.forEach(item => {
                    const inputs = item.querySelectorAll('input');
                    const textarea = item.querySelector('textarea');
                    
                    if (inputs.length >= 2) {
                        const title = inputs[0].value || 'Project Title';
                        const tech = inputs[1].value || '';
                        const description = textarea ? textarea.value : '';

                        if (title || description) {
                            const projectDiv = document.createElement('div');
                            projectDiv.className = 'project-item';
                            projectDiv.innerHTML = `
                                <div class="project-header">
                                    <div class="project-title font-bold">${title}</div>
                                </div>
                               
                                ${tech ? `
                                    <div class="tech-stack">
                                        <p>Technologies:</p>
                                        ${tech.split(',').map(t => `<span class="tech-badge">${t.trim()},</span>`).join('')}
                                    </div>
                                ` : ''}
                                <p>${description || 'Project Description'}</p>
                            `;
                            projectsPreview.appendChild(projectDiv);
                        }
                    }
                });
            }
        }

        // Add Experience Functionality
        const addExperienceBtn = document.querySelector('.add-experience-btn');
        const experienceContainer = document.getElementById('work-experience-container');

        function addExperience() {
            const experienceItem = document.createElement('div');
            experienceItem.className = 'experience-item';
            experienceItem.innerHTML = `
                        <div class="form-grid">
                            <div class="input-group">
                        <label for="company">Company</label>
                        <input type="text" placeholder="Company Name">
                            </div>
                            <div class="input-group">
                        <label for="position">Position</label>
                        <input type="text" placeholder="Job Title">
                            </div>
                            <div class="input-group">
                        <label for="start-date">Start Date</label>
                        <input type="month">
                            </div>
                            <div class="input-group">
                        <label for="end-date">End Date</label>
                        <input type="month">
                            </div>
                    <div class="input-group full-width">
                        <label for="description">Description</label>
                        <textarea placeholder="Describe your responsibilities and achievements..."></textarea>
                        </div>
                    </div>
                <button class="remove-experience-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
            `;


            experienceContainer.appendChild(experienceItem);

            // Add auto-resize to new textarea
            const newTextarea = experienceItem.querySelector('textarea');
            if (newTextarea) {
                newTextarea.addEventListener('input', () => {
                    autoResizeTextarea(newTextarea);
                    debouncedUpdatePreview();
                });
            }

            // Add remove functionality
            const removeBtn = experienceItem.querySelector('.remove-experience-btn');
            removeBtn.addEventListener('click', () => {
                experienceItem.remove();
                debouncedUpdatePreview();
            });

            // Add AI enhance buttons to new textarea(s)
            addAIEnhanceButtons();

            // Add event listeners to new inputs
            const newInputs = experienceItem.querySelectorAll('input, textarea');
            newInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });
        }

        addExperienceBtn?.addEventListener('click', addExperience);

        // Add Project Functionality
        const addProjectBtn = document.querySelector('.add-project-btn');
        const projectsContainer = document.getElementById('projects-container');

        function addProject() {
            const projectItem = document.createElement('div');
            projectItem.className = 'project-item';
            projectItem.innerHTML = `
                <div class="form-grid">
                    <div class="input-group">
                        <label for="project-title">Project Title</label>
                        <input type="text" placeholder="Project Name">
                    </div>
                    <div class="input-group">
                        <label for="project-tech">Technologies Used</label>
                        <input type="text" placeholder="e.g., React, Node.js, MongoDB">
                    </div>
                    <div class="input-group full-width">
                        <label for="project-desc">Project Description</label>
                        <textarea placeholder="Describe the project and your role..."></textarea>
                    </div>
                </div>
                <button class="remove-project-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
            `;

            projectsContainer.appendChild(projectItem);

            // Add auto-resize to new textarea
            const newTextarea = projectItem.querySelector('textarea');
            if (newTextarea) {
                newTextarea.addEventListener('input', () => {
                    autoResizeTextarea(newTextarea);
                    debouncedUpdatePreview();
                });
            }

            // Add input event listeners to project inputs
            const projectInputs = projectItem.querySelectorAll('input');
            projectInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });

            // Add remove functionality
            const removeBtn = projectItem.querySelector('.remove-project-btn');
            removeBtn.addEventListener('click', () => {
                projectItem.remove();
                debouncedUpdatePreview();
            });

            // Add AI enhance buttons to new textarea(s)
            addAIEnhanceButtons();
        }

        addProjectBtn?.addEventListener('click', addProject);

        // Add Education Functionality
        const addEducationBtn = document.querySelector('.add-education-btn');
        const educationContainer = document.getElementById('education-container');

        function addEducation() {
            const educationItem = document.createElement('div');
            educationItem.className = 'education-item';
            educationItem.innerHTML = `
                <div class="form-grid">
                    <div class="input-group">
                        <label for="education-degree">Degree/Strand</label>
                        <input type="text" placeholder="e.g., Bachelor of Information Technology">
                    </div>
                    <div class="input-group">
                        <label for="education-school">School/University</label>
                        <input type="text" placeholder="e.g., University Name">
                    </div>
                    <div class="input-group">
                        <label for="education-year">Year</label>
                        <input type="text" placeholder="e.g., 2022-2025">
                    </div>
                    <div class="input-group">
                        <label for="education-gpa">GPA (Optional)</label>
                        <input type="text" placeholder="e.g., 3.8/4.0">
                    </div>
                    <div class="input-group full-width">
                        <label for="education-description">Description (Optional)</label>
                        <textarea placeholder="Relevant coursework, achievements, or activities..."></textarea>
                    </div>
                </div>
                <button class="remove-education-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
            `;

            educationContainer.appendChild(educationItem);

            // Add auto-resize to new textarea
            const newTextarea = educationItem.querySelector('textarea');
            if (newTextarea) {
                newTextarea.addEventListener('input', () => {
                    autoResizeTextarea(newTextarea);
                    debouncedUpdatePreview();
                });
            }

            // Add remove functionality
            const removeBtn = educationItem.querySelector('.remove-education-btn');
            removeBtn.addEventListener('click', () => {
                educationItem.remove();
                debouncedUpdatePreview();
            });

            // Add AI enhance buttons to new textarea(s)
            addAIEnhanceButtons();

            // Add event listeners to new inputs
            const newInputs = educationItem.querySelectorAll('input, textarea');
            newInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });
        }

        addEducationBtn?.addEventListener('click', addEducation);

        // Add event listeners to existing education and experience inputs
        function addInputEventListeners() {
            // Education inputs
            const educationInputs = document.querySelectorAll('.education-item input, .education-item textarea');
            educationInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });

            // Experience inputs
            const experienceInputs = document.querySelectorAll('.experience-item input, .experience-item textarea');
            experienceInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });

            // Language inputs
            const languageInputs = document.querySelectorAll('.language-input, .proficiency-select');
            languageInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });

            // Hobby inputs
            const hobbyInputs = document.querySelectorAll('.hobby-input, .hobby-description-input');
            hobbyInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });
        }

        // Initialize event listeners
        addInputEventListeners();

        // Add Skill Functionality
        const addSkillBtns = document.querySelectorAll('.add-skill-btn');

        addSkillBtns.forEach(btn => {
            btn.addEventListener('click', (e) => {
                const container = e.target.closest('.skill-category');
                const input = container.querySelector('.skill-input');
                const skillsList = container.querySelector('.skills-list');
                
                if (input.value.trim()) {
                    const skillBadge = document.createElement('span');
                    skillBadge.className = 'skill-badge';
                    skillBadge.textContent = input.value;
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-skill-btn';
                    removeBtn.textContent = '×';
                    removeBtn.addEventListener('click', () => {
                        skillBadge.style.animation = 'fadeOut 0.2s ease-out';
                        setTimeout(() => {
                            skillBadge.remove();
                            debouncedUpdatePreview();
                        }, 200);
                    });
                    
                    skillBadge.appendChild(removeBtn);
                    skillsList.appendChild(skillBadge);
                    input.value = '';
                    
                    debouncedUpdatePreview();
                }
            });
        });

         

        // Add enter key support for adding skills
        document.querySelectorAll('.skill-input').forEach(input => {
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const addBtn = input.nextElementSibling;
                    addBtn.click();
                }
            });
        });

        // Add Language Functionality
        const addLanguageBtn = document.querySelector('.add-language-btn');
        const languagesContainer = document.getElementById('languages-container');

        function addLanguage() {
            const languageCount = languagesContainer.querySelectorAll('.language-item').length + 1;
            const languageItem = document.createElement('div');
            languageItem.className = 'language-item';
            languageItem.innerHTML = `
                <div class="form-grid">
                    <div class="input-group">
                        <label for="language-${languageCount}">Language</label>
                        <input type="text" class="language-input" id="language-${languageCount}" placeholder="e.g., English">
                    </div>
                    <div class="input-group">
                        <label for="proficiency-${languageCount}">Proficiency Level</label>
                        <select class="proficiency-select" id="proficiency-${languageCount}">
                            <option value="Basic">Basic</option>
                            <option value="Conversational">Conversational</option>
                            <option value="Fluent">Fluent</option>
                            <option value="Native">Native</option>
                        </select>
                    </div>
                </div>
                <button class="remove-language-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
            `;

            languagesContainer.appendChild(languageItem);

            // Add remove functionality
            const removeBtn = languageItem.querySelector('.remove-language-btn');
            removeBtn.addEventListener('click', () => {
                languageItem.remove();
                // Ensure at least one language item remains
                if (languagesContainer.querySelectorAll('.language-item').length === 0) {
                    addLanguage(); // Add a new empty one
                }
                debouncedUpdatePreview();
            });

            // Add event listeners to new inputs
            const newInputs = languageItem.querySelectorAll('input, select');
            newInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });
        }

        addLanguageBtn?.addEventListener('click', addLanguage);

        // Add Hobby Functionality
        const addHobbyBtn = document.querySelector('.add-hobby-btn');
        const hobbiesContainer = document.getElementById('hobbies-container');

        function addHobby() {
            const hobbyCount = hobbiesContainer.querySelectorAll('.hobby-item').length + 1;
            const hobbyItem = document.createElement('div');
            hobbyItem.className = 'hobby-item';
            hobbyItem.innerHTML = `
                <div class="form-grid">
                    <div class="input-group">
                        <label for="hobby-${hobbyCount}">Hobby/Interest</label>
                        <input type="text" class="hobby-input" id="hobby-${hobbyCount}" placeholder="e.g., Reading, Traveling, Photography">
                    </div>
                    <div class="input-group">
                        <label for="hobby-description-${hobbyCount}">Description (Optional)</label>
                        <input type="text" class="hobby-description-input" id="hobby-description-${hobbyCount}" placeholder="Brief description or context">
                    </div>
                </div>
                <button class="remove-hobby-btn" style="margin-top: 1rem; padding: 8px 16px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer;">Remove</button>
            `;

            hobbiesContainer.appendChild(hobbyItem);

            // Add remove functionality
            const removeBtn = hobbyItem.querySelector('.remove-hobby-btn');
            removeBtn.addEventListener('click', () => {
                hobbyItem.remove();
                // Ensure at least one hobby item remains
                if (hobbiesContainer.querySelectorAll('.hobby-item').length === 0) {
                    addHobby(); // Add a new empty one
                }
                debouncedUpdatePreview();
            });

            // Add event listeners to new inputs
            const newInputs = hobbyItem.querySelectorAll('input');
            newInputs.forEach(input => {
                input.addEventListener('input', () => {
                    debouncedUpdatePreview();
                });
            });
        }

        addHobbyBtn?.addEventListener('click', addHobby);

        // Add event listeners for initial remove buttons
        document.addEventListener('DOMContentLoaded', function() {
            // Add remove functionality to initial language item
            const initialLanguageRemoveBtn = document.querySelector('#languages-section .remove-language-btn');
            if (initialLanguageRemoveBtn) {
                initialLanguageRemoveBtn.addEventListener('click', function() {
                    const languageItem = this.closest('.language-item');
                    if (languageItem) {
                        languageItem.remove();
                        // Ensure at least one language item remains
                        if (languagesContainer.querySelectorAll('.language-item').length === 0) {
                            addLanguage(); // Add a new empty one
                        }
                        debouncedUpdatePreview();
                    }
                });
            }

            // Add remove functionality to initial hobby item
            const initialHobbyRemoveBtn = document.querySelector('#hobbies-section .remove-hobby-btn');
            if (initialHobbyRemoveBtn) {
                initialHobbyRemoveBtn.addEventListener('click', function() {
                    const hobbyItem = this.closest('.hobby-item');
                    if (hobbyItem) {
                        hobbyItem.remove();
                        // Ensure at least one hobby item remains
                        if (hobbiesContainer.querySelectorAll('.hobby-item').length === 0) {
                            addHobby(); // Add a new empty one
                        }
                        debouncedUpdatePreview();
                    }
                });
            }

       
            // Force update form for category to ensure sections are shown
            setTimeout(() => {
                if (typeof updateFormForCategory === 'function') {
                    updateFormForCategory();
                }
                const languagesSection = document.getElementById('languages-section');
                const hobbiesSection = document.getElementById('hobbies-section');
                const projectsSection = document.getElementById('projects-section');
                // Manually show language and hobby sections for generic templates
                if (templateId && templateId.startsWith('generic-')) {
                    if (languagesSection) languagesSection.style.display = '';
                    if (hobbiesSection) hobbiesSection.style.display = '';
                    if (projectsSection) projectsSection.style.display = 'none';
                    if(templateId === 'generic-3'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = 'none';
                    }
                    else if(templateId === 'generic-4'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = 'none';
                    }
                    else if(templateId === 'generic-5'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = '';
                    }
                    else if(templateId === 'generic-6'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = '';
                        if (languagesSection) languagesSection.style.display = '';
                    }
                    else if(templateId === 'generic-7'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = 'none';
                    }
                    else if(templateId === 'generic-8'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = 'none';
                    }
                    else if(templateId === 'generic-9'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = '';
                    }
                    else if(templateId === 'generic-10'){
                        if (projectsSection) projectsSection.style.display = 'none';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (languagesSection) languagesSection.style.display = 'none';
                    }
                    
                }else if(templateId && templateId.startsWith('accountant-')){
                    if (languagesSection) languagesSection.style.display = '';
                    if (hobbiesSection) hobbiesSection.style.display = 'none';
                    if (projectsSection) projectsSection.style.display = 'none';
                }else if(templateId && templateId.startsWith('business-')){
                    if (languagesSection) languagesSection.style.display = '';
                    if (hobbiesSection) hobbiesSection.style.display = 'none';
                    if (projectsSection) projectsSection.style.display = 'none';
                }else if(templateId && templateId.startsWith('civil-')){
                    if (languagesSection) languagesSection.style.display = '';
                    if (hobbiesSection) hobbiesSection.style.display = 'none';
                    if (projectsSection) projectsSection.style.display = 'none';
                }else if(templateId && templateId.startsWith('it-')){
                    if(templateId === 'it-1'){
                        if (languagesSection) languagesSection.style.display = 'none';
                    }else{
                        if (languagesSection) languagesSection.style.display = '';
                        if (hobbiesSection) hobbiesSection.style.display = 'none';
                        if (projectsSection) projectsSection.style.display = '';
                    }
                }
            }, 100);
        });

        // Add event listeners
        previewToggle.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            togglePreview();
        });

        // Add touch event listener for mobile
        previewToggle.addEventListener('touchend', (e) => {
            e.preventDefault();
            e.stopPropagation();
            togglePreview();
        });


       
        // Auto-resize textareas
        function autoResizeTextarea(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 300) + 'px';
        }

        // Add auto-resize to all textareas
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.addEventListener('input', () => {
                autoResizeTextarea(textarea);
                // updatePreview() is now handled by the general input event handler below
            });
        });

        // Close preview when clicking outside on mobile
        document.addEventListener('click', (e) => {
            // Prevent the event from triggering if the click is on the preview toggle button
            if (e.target.closest('.preview-toggle') || e.target.id === 'previewToggle') {
                return;
            }
            
            // Only close preview on mobile if clicking outside the right panel
            if (window.innerWidth <= 768 && 
                isPreviewActive && 
                !rightPanel.contains(e.target)) {
                togglePreview();
            }
        });

        // Add touch event handling for mobile to prevent unwanted preview toggles
        document.addEventListener('touchstart', (e) => {
            // Prevent touch events on the preview toggle button from bubbling
            if (e.target.closest('.preview-toggle') || e.target.id === 'previewToggle') {
                e.stopPropagation();
            }
        }, { passive: false });

        // Debounced preview update to prevent excessive calls
        let previewUpdateTimer;
        function debouncedUpdatePreview(source = 'unknown') {
            clearTimeout(previewUpdateTimer);
            previewUpdateTimer = setTimeout(() => {
                updatePreview();
                // Update language and hobby previews
                updateLanguagesInPreview();
                updateHobbiesInPreview();
            }, 300); // Wait 300ms after last input change
        }

        // Update preview when form inputs change (only on actual input, not on focus/click)
        document.querySelectorAll('.input-group input, .input-group textarea').forEach(input => {
            input.addEventListener('input', () => {
                debouncedUpdatePreview();
            });
            
            // Prevent preview update on focus/click events
            input.addEventListener('focus', (e) => {
                e.stopPropagation();
            });
            
            input.addEventListener('click', (e) => {
                e.stopPropagation();
            });
        });

        // Handle window resize
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                if (window.innerWidth > 768 && isPreviewActive) {
                    rightPanel.classList.remove('active');
                    previewToggle.classList.remove('active');
                    previewToggle.textContent = 'Preview Resume';
                    isPreviewActive = false;
                }
            }, 250);
        });

        // Initialize preview state
        if (window.innerWidth <= 768) {
            previewToggle.style.display = 'block';
        }

        // Show preview immediately when page loads
    

      // Initialize user menu
        Auth.updateUserMenu();
        Auth.initUserMenu();

        // Profile Picture Upload Functionality
        const profileUpload = document.getElementById('profile-upload');
        const profilePreview = document.querySelector('.profile-preview');
        const removePhoto = document.querySelector('.remove-photo');
        let profileImage = '';

        // New canvas-based profile editor functionality will be handled by the new implementation

        // File upload handler will be handled by the new canvas-based implementation

        // Initialize profile preview to be empty
        document.addEventListener('DOMContentLoaded', function() {
            const profilePreview = document.querySelector('.profile-preview');
            if (profilePreview) {
                profilePreview.innerHTML = '<div class="placeholder">👤</div>';
            }
        });

        // Modal functions - updated for new implementation
        function openModal() {
            document.getElementById('profileEditorModal').classList.remove('hidden');
            document.getElementById('previewToggle').style.display = 'none'; // hide preview btn
            if (typeof resetModal === 'function') {
                resetModal();
            }
        }

        function closeModal() {
            const modal = document.getElementById('profileEditorModal');
            if (modal) {
                modal.classList.add('hidden');
            }
            document.getElementById('previewToggle').style.display = 'block'; // show preview btn again
            if (typeof stopCamera === 'function') {
                stopCamera();
            }
        }

        // Success Modal Functions
        function showSuccessModal(message = 'Resume saved successfully!', redirectUrl = null) {
            window.isResumeDirty = false;
            document.getElementById('successMessage').textContent = message;
            document.getElementById('successModal').style.display = 'block';
            
            // Reset animation by removing and re-adding classes
            const checkCircle = document.querySelector('.check-circle');
            const checkMark = document.querySelector('.check-mark');
            
            if (checkCircle && checkMark) {
                checkCircle.style.animation = 'none';
                checkMark.style.animation = 'none';
                
                setTimeout(() => {
                    checkCircle.style.animation = 'scaleIn 0.5s ease-out';
                    checkMark.style.animation = 'checkDraw 0.5s ease-out 0.3s both';
                }, 10);
            }
            
            // Store redirect URL for later use
            window.successRedirectUrl = redirectUrl;
        }

        function closeSuccessModal() {
            document.getElementById('successModal').style.display = 'none';
            
            // Handle redirect if specified
            if (window.successRedirectUrl) {
                window.isResumeDirty = false;
                window.location.href = window.successRedirectUrl;
                window.successRedirectUrl = null;
            }
        }

        // ... existing code ...

    // --- New Profile Editor Logic with Canvas ---
    document.addEventListener('DOMContentLoaded', () => {
        // Background color buttons
    document.querySelectorAll('.color-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            window.selectedBgColor = btn.dataset.color;
            drawPreview();
        });
    });

    // Custom color input
    document.getElementById('customBgColor').addEventListener('input', (e) => {
        window.selectedBgColor = e.target.value;
        drawPreview();
    });

    // Canvas setup
    const canvas = document.getElementById("previewCanvas");
    const ctx = canvas.getContext("2d");
    let img = null;
    let overlayImg = null;
    let imgPos = { x: 150, y: 150, scale: 1, baseScale: 1 }; // Center initially
    let overlayScale = 1;
    let originalImageData = null; // Store original image data for background removal

    // Element queries
    const autoBgCheckbox = document.getElementById('autoBgCheckbox');
    const suitCheckbox = document.getElementById('suitCheckbox');
    const modal = document.getElementById('profileEditorModal');
    const uploadInput = document.getElementById('uploadInput');
    const triggerUploadBtn = document.getElementById('triggerUploadBtn');
    const startCameraBtn = document.getElementById('startCameraBtn');
    const captureBtn = document.getElementById('captureBtn');
    const cameraFeed = document.getElementById('cameraFeed');
    const cameraWrapper = document.getElementById('cameraWrapper');
    const zoomSlider = document.getElementById('zoomSlider');
    const zoomOutBtn = document.getElementById('zoomOutBtn');
    const zoomInBtn = document.getElementById('zoomInBtn');
    const suitOptions = document.querySelectorAll('.suit-option');
    const suitSizerWrapper = document.getElementById('suitSizerWrapper');
    const suitZoomSlider = document.getElementById('suitZoomSlider');
    const suitZoomOut = document.getElementById('suitZoomOut');
    const suitZoomIn = document.getElementById('suitZoomIn');
    const downloadImageBtn = document.getElementById("downloadImageBtn");
    const applyToResumeBtn = document.getElementById("applyToResumeBtn");
   

    // State
    let stream = null;
    let selectedSuit = null;

    window.selectedBgColor = "#ffffff";

    // Canvas functions
    let overlayPos = { x: 0, y: 0 }; // Add overlay position tracking

    function loadMainImage(src) {
        console.log('Loading main image from:', src.substring(0, 100) + '...');
        img = new Image();
        img.src = src;
        originalImageData = src; // Store original image data
        img.onload = () => {
            console.log('Image loaded successfully. Dimensions:', img.width, 'x', img.height);
            
            // Calculate the "fit to canvas" scale as our baseline (this becomes 100%)
            const fitScale = Math.min(canvas.width / img.width, canvas.height / img.height);
            console.log('Fit scale calculated:', fitScale);
            
            // Set this fitted scale as our "original" scale (100% on slider)
            imgPos.baseScale = fitScale; // Store the base scale
            imgPos.scale = fitScale; // Start at the fitted size
            imgPos.x = (canvas.width - img.width * fitScale) / 2;
            imgPos.y = (canvas.height - img.height * fitScale) / 2;
            console.log('Image position set to:', imgPos);
            
            zoomSlider.value = 100; // Slider starts at middle (100%)
            drawPreview();
            console.log('Preview drawn after image load');
            downloadImageBtn.style.display = "inline-block";
        };
        img.onerror = (error) => {
            console.error('Error loading image:', error);
        };
    }

    function loadSuitOverlay(src) {
        overlayImg = new Image();
        overlayImg.src = src;
        overlayImg.onload = () => {
            // Start scale so it roughly fills the preview
            const targetSize = canvas.width * 0.9; // suit fills 90% of width
            overlayScale = targetSize / overlayImg.width; 

            overlayPos = {
                x: (canvas.width - overlayImg.width * overlayScale) / 2,
                y: (canvas.height - overlayImg.height * overlayScale) / 2
            };

            drawPreview();
        };
    }

    function clearSuitOverlay() {
        overlayImg = null;
        overlayPos = { x: 0, y: 0 };
        drawPreview();
    }

    function drawPreview() {
    console.log('Drawing preview.');
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // 1. Draw background color
    if (window.selectedBgColor) {
        ctx.fillStyle = window.selectedBgColor;
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        console.log('Background color drawn:', window.selectedBgColor);
    }

    // 2. Draw uploaded photo
    if (img) {
        console.log('Drawing main image at position:', imgPos);
        ctx.save();
        ctx.translate(imgPos.x + img.width * imgPos.scale / 2, imgPos.y + img.height * imgPos.scale / 2);
        ctx.scale(imgPos.scale, imgPos.scale);
        ctx.drawImage(img, -img.width / 2, -img.height / 2);
        ctx.restore();
        console.log('Main image drawn');
    } else {
        console.log('No main image to draw');
    }

    // 3. Draw suit overlay
    if (overlayImg && suitCheckbox.checked) {
        console.log('Drawing suit overlay at position:', overlayPos, 'scale:', overlayScale);
        ctx.save();
        ctx.translate(
            overlayPos.x + (overlayImg.width * overlayScale) / 2,
            overlayPos.y + (overlayImg.height * overlayScale) / 2
        );
        ctx.scale(overlayScale, overlayScale);
        ctx.drawImage(overlayImg, -overlayImg.width / 2, -overlayImg.height / 2);
        ctx.restore();
        console.log('Suit overlay drawn');
    } else {
        console.log('No suit overlay to draw or checkbox not checked');
    }

    console.log('Preview drawing complete');
}

    // Helper: robustly set the label text for autoBgCheckbox
    function setAutoBgLabelText(text) {
        const label = autoBgCheckbox.closest('label');
        if (!label) return;
        Array.from(label.childNodes).forEach(node => {
            if (node === autoBgCheckbox) return;
            label.removeChild(node);
        });
        label.appendChild(document.createTextNode(text));
    }

    // Reset editor state
    function resetModal() {
        img = null;
        overlayImg = null;
        selectedSuit = null;
        originalImageData = null; // Reset original image data
        imgPos = { x: 150, y: 150, scale: 1, baseScale: 1 }; // Add baseScale
        overlayPos = { x: 0, y: 0 }; // Reset overlay position
        overlayScale = 1;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        zoomSlider.value = 100;
        suitZoomSlider.value = 100;
        
        autoBgCheckbox.checked = false;
        autoBgCheckbox.disabled = true;
        setAutoBgLabelText('Automatic background removal');
        
        suitCheckbox.checked = false;
        suitCheckbox.disabled = true;
        
        setSuitInteractivity(false);
        downloadImageBtn.style.display = "none";
    }

      // Apply to resume
      applyToResumeBtn.addEventListener("click", () => {
        console.log('Apply to Resume clicked');
        
        if (img) {
            // First draw the current state to ensure everything is rendered
            drawPreview();
            console.log('Preview drawn');
            
            // Get the canvas data as image
            const dataURL = canvas.toDataURL("image/png");
          
            // Find the profile preview element in the resume
            const profilePreview = document.querySelector('.profile-preview');
            console.log('Profile preview element found:', !!profilePreview);
            
            if (profilePreview) {
                // Clear any existing content first
                profilePreview.innerHTML = '';
                
                // Create and add the new image
                const profileImg = document.createElement('img');
                profileImg.src = dataURL;
                profileImg.alt = 'Profile Picture';
                profileImg.className = 'w-full h-full object-contain';
                
                profilePreview.appendChild(profileImg);
                console.log('Profile preview updated with image');
                
                // IMPORTANT: Update the global profileImage variable for the resume template
                window.profileImage = dataURL;
                console.log('Global profileImage updated:', window.profileImage);
                
                // Update the resume preview on the right side
                if (typeof updatePreview === 'function') {
                    updatePreview();
                    console.log('Resume preview updated');
                } else {
                    console.log('updatePreview function not found');
                }
            } else {
                console.error('Profile preview element not found');
                alert('Profile preview element not found');
            }
            
            // Close the modal
            closeModal();
        } else {
            console.error('No image loaded. Please upload an image first.');
            alert('Please upload an image first');
        }
    });


    // Upload trigger
    triggerUploadBtn.addEventListener('click', () => {
        uploadInput.click();
    });

    // File input handler
    uploadInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (e) => {
            loadMainImage(e.target.result);
            
            // Enable checkboxes now that image exists
            autoBgCheckbox.disabled = false;
            suitCheckbox.disabled = false;

            // Run BG removal only if user actually enabled it
            if (autoBgCheckbox.checked) {
                runBackgroundRemoval();
            }
        };
        reader.readAsDataURL(file);
    });

    // Camera / Selfie
    startCameraBtn.addEventListener('click', async () => {
        try {
            stream = await navigator.mediaDevices.getUserMedia({ video: true });
            cameraFeed.srcObject = stream;
            cameraWrapper.style.display = "flex";
        } catch (err) {
            alert('Camera access denied or not available.');
            console.error(err);
        }
    });

    function stopCamera() {
        if (stream) {
            stream.getTracks().forEach(track => track.stop());
            stream = null;
            cameraWrapper.style.display = "none";
        }
    }

    captureBtn.addEventListener('click', () => {
        const captureCanvas = document.createElement('canvas');
        captureCanvas.width = cameraFeed.videoWidth;
        captureCanvas.height = cameraFeed.videoHeight;
        const captureCtx = captureCanvas.getContext('2d');
        captureCtx.drawImage(cameraFeed, 0, 0, captureCanvas.width, captureCanvas.height);
        const imageData = captureCanvas.toDataURL('image/png');

        loadMainImage(imageData);
        
        // Enable checkboxes now that image exists
        autoBgCheckbox.disabled = false;
        suitCheckbox.disabled = false;

        stopCamera();

        if (autoBgCheckbox.checked) {
            runBackgroundRemoval();
        }
    });

    // Canvas interaction - Zoom with mouse wheel (center-based scaling using baseScale)
    canvas.addEventListener("wheel", (e) => {
        e.preventDefault();
        const delta = e.deltaY * -0.001;
        const oldScale = imgPos.scale;
        const newScale = Math.max(imgPos.baseScale * 0.5, Math.min(imgPos.scale + delta, imgPos.baseScale * 3));
        
        // Calculate the center point for scaling
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        
        // Adjust position to scale from center
        const scaleRatio = newScale / oldScale;
        imgPos.x = centerX - (centerX - imgPos.x) * scaleRatio;
        imgPos.y = centerY - (centerY - imgPos.y) * scaleRatio;
        
        imgPos.scale = newScale;
        // Update slider to reflect current scale relative to base
        zoomSlider.value = Math.round((newScale / imgPos.baseScale) * 100);
        drawPreview();
    });

    // Canvas interaction - Drag
    let isDragging = false;
    let isDraggingSuit = false;
    let dragStart = { x: 0, y: 0 };

    // Helper function to check if click is on suit overlay
    function isClickOnSuit(x, y) {
        if (!overlayImg || !suitCheckbox.checked) return false;
        
        const centerX = overlayPos.x + (overlayImg.width * overlayScale) / 2;
        const centerY = overlayPos.y + (overlayImg.height * overlayScale) / 2;
        const halfWidth = (overlayImg.width * overlayScale) / 2;
        const halfHeight = (overlayImg.height * overlayScale) / 2;
        
        return x >= centerX - halfWidth && x <= centerX + halfWidth && 
               y >= centerY - halfHeight && y <= centerY + halfHeight;
    }

    // Helper function to get coordinates from event (mouse or touch)
    function getEventCoordinates(e) {
        const rect = canvas.getBoundingClientRect();
        if (e.touches && e.touches[0]) {
            // Touch event
            return {
                x: e.touches[0].clientX - rect.left,
                y: e.touches[0].clientY - rect.top
            };
        } else {
            // Mouse event
            return {
                x: e.clientX - rect.left,
                y: e.clientY - rect.top
            };
        }
    }

    // Mouse event handlers
    canvas.addEventListener("mousedown", (e) => {
        const coords = getEventCoordinates(e);
        const x = coords.x;
        const y = coords.y;
        
        // Check if clicking on suit overlay first (higher priority)
        if (isClickOnSuit(x, y)) {
            isDraggingSuit = true;
            dragStart.x = x - overlayPos.x;
            dragStart.y = y - overlayPos.y;
            canvas.style.cursor = 'grabbing';
        } else if (img) {
            isDragging = true;
            dragStart.x = x - imgPos.x;
            dragStart.y = y - imgPos.y;
            canvas.style.cursor = 'grabbing';
        }
    });

    canvas.addEventListener("mousemove", (e) => {
        const coords = getEventCoordinates(e);
        const x = coords.x;
        const y = coords.y;
        
        if (isDraggingSuit) {
            overlayPos.x = x - dragStart.x;
            overlayPos.y = y - dragStart.y;
            drawPreview();
        } else if (isDragging && img) {
            imgPos.x = x - dragStart.x;
            imgPos.y = y - dragStart.y;
            drawPreview();
        } else {
            // Update cursor based on what's under the mouse
            if (isClickOnSuit(x, y)) {
                canvas.style.cursor = 'grab';
            } else if (img) {
                canvas.style.cursor = 'grab';
            } else {
                canvas.style.cursor = 'default';
            }
        }
    });

    canvas.addEventListener("mouseup", () => {
        isDragging = false;
        isDraggingSuit = false;
        canvas.style.cursor = 'grab';
    });

    canvas.addEventListener("mouseleave", () => {
        isDragging = false;
        isDraggingSuit = false;
        canvas.style.cursor = 'grab';
    });

    // Touch event handlers for mobile devices
    canvas.addEventListener("touchstart", (e) => {
        e.preventDefault(); // Prevent default touch behavior
        const coords = getEventCoordinates(e);
        const x = coords.x;
        const y = coords.y;
        
        // Check if touching on suit overlay first (higher priority)
        if (isClickOnSuit(x, y)) {
            isDraggingSuit = true;
            dragStart.x = x - overlayPos.x;
            dragStart.y = y - overlayPos.y;
        } else if (img) {
            isDragging = true;
            dragStart.x = x - imgPos.x;
            dragStart.y = y - imgPos.y;
        }
    }, { passive: false });

    canvas.addEventListener("touchmove", (e) => {
        e.preventDefault(); // Prevent page scrolling during drag
        const coords = getEventCoordinates(e);
        const x = coords.x;
        const y = coords.y;
        
        if (isDraggingSuit) {
            overlayPos.x = x - dragStart.x;
            overlayPos.y = y - dragStart.y;
            drawPreview();
        } else if (isDragging && img) {
            imgPos.x = x - dragStart.x;
            imgPos.y = y - dragStart.y;
            drawPreview();
        }
    }, { passive: false });

    canvas.addEventListener("touchend", (e) => {
        e.preventDefault();
        isDragging = false;
        isDraggingSuit = false;
    }, { passive: false });

    canvas.addEventListener("touchcancel", (e) => {
        e.preventDefault();
        isDragging = false;
        isDraggingSuit = false;
    }, { passive: false });

    // Image zoom controls (center-based scaling using baseScale)
    zoomSlider.addEventListener('input', function () {
        const oldScale = imgPos.scale;
        const sliderPercent = parseInt(this.value, 10) / 100; // 0.5 to 3.0
        const newScale = imgPos.baseScale * sliderPercent; // Scale relative to fitted size
        
        // Calculate center-based scaling
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const scaleRatio = newScale / oldScale;
        
        imgPos.x = centerX - (centerX - imgPos.x) * scaleRatio;
        imgPos.y = centerY - (centerY - imgPos.y) * scaleRatio;
        imgPos.scale = newScale;
        
        drawPreview();
    });

    zoomOutBtn.addEventListener('click', () => {
        zoomSlider.value = Math.max(parseInt(zoomSlider.value, 10) - 10, 10);
        zoomSlider.dispatchEvent(new Event('input'));
    });

    zoomInBtn.addEventListener('click', () => {
        zoomSlider.value = Math.min(parseInt(zoomSlider.value, 10) + 10, 300);
        zoomSlider.dispatchEvent(new Event('input'));
    });

    // Suit overlay handling
    function setSuitInteractivity(enabled) {
        suitOptions.forEach(option => {
            option.style.pointerEvents = enabled ? 'auto' : 'none';
            option.style.opacity = enabled ? '1' : '0.5';
            if (!enabled) option.classList.remove('border-2', 'border-blue-500');
        });
        suitSizerWrapper.style.display = enabled ? 'block' : 'none';

        if (!enabled) {
            clearSuitOverlay();
        }
    }

    // Suit selection
    suitOptions.forEach(option => {
        option.addEventListener('click', () => {
            if (!suitCheckbox.checked) return;
            
            suitOptions.forEach(o => {
                o.style.border = '1px solid #d1d5db';
            });
            option.style.border = '2px solid #3b82f6';
            
            selectedSuit = option.getAttribute('data-suit');
            loadSuitOverlay(selectedSuit);
        });
    });

    // Suit zoom controls (center-based scaling)
    suitZoomSlider.addEventListener('input', function () {
        const oldScale = overlayScale;
        const newScale = parseInt(this.value, 10) / 100;
        
        // Calculate center-based scaling for suit
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const scaleRatio = newScale / oldScale;
        
        overlayPos.x = centerX - (centerX - overlayPos.x) * scaleRatio;
        overlayPos.y = centerY - (centerY - overlayPos.y) * scaleRatio;
        overlayScale = newScale;
        
        drawPreview();
    });

    suitZoomOut.addEventListener('click', () => {
        suitZoomSlider.value = Math.max(parseInt(suitZoomSlider.value, 10) - 10, 50);
        suitZoomSlider.dispatchEvent(new Event('input'));
    });

    suitZoomIn.addEventListener('click', () => {
        suitZoomSlider.value = Math.min(parseInt(suitZoomSlider.value, 10) + 10, 200);
        suitZoomSlider.dispatchEvent(new Event('input'));
    });

    // Suit checkbox handler
    suitCheckbox.addEventListener('change', () => {
        setSuitInteractivity(suitCheckbox.checked);
        drawPreview(); // Redraw to show/hide overlay
    });

    // Background removal
    autoBgCheckbox.addEventListener('change', function () {
        if (this.checked && img) {
            runBackgroundRemoval();
        }
    });

    

    async function runBackgroundRemoval() {
        const API_URL = window.apiConfig ? window.apiConfig.baseURL : 'http://localhost:3000/api';
        const removeBgUrl = `${API_URL}/removebg/removebg`;
        try {
            autoBgCheckbox.disabled = true;
            setAutoBgLabelText('Removing background...');

            // Convert original image to Blob
            const response = await fetch(originalImageData);
            const originalBlob = await response.blob();

            // Send file as 'image_file' to match backend
            const formData = new FormData();
            formData.append('image_file', originalBlob, 'photo.png');

            const apiResponse = await fetch(removeBgUrl, {
                method: 'POST',
                body: formData,
            });

            if (!apiResponse.ok) throw new Error('Failed to remove background');

            const processedBlob = await apiResponse.blob();
            const processedUrl = URL.createObjectURL(processedBlob);

            // Update UI
            originalImageData = processedUrl;
            loadMainImage(processedUrl);

            autoBgCheckbox.checked = true;
            setAutoBgLabelText('Background removed');

        } catch (err) {
            console.error(err);
            alert('Background removal failed. Please try again.');
            autoBgCheckbox.checked = false;
            setAutoBgLabelText('Automatic background removal');
        } finally {
            autoBgCheckbox.disabled = false;
        }
    }

    // Download functionality
    downloadImageBtn.addEventListener("click", () => {
        const link = document.createElement("a");
        link.href = canvas.toDataURL('image/png');
        link.download = "resume-photo.png";
        link.click();
    });

  
    // Initialize
    setSuitInteractivity(false);
    canvas.style.cursor = 'grab';
});


        // AI Enhancement functionality
        let currentTextarea = null;
        let currentPopup = null;
        // TODO: Set up your OpenAI API key in your environment variables

        function addAIEnhanceButtons() {
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(textarea => {
                const container = textarea.parentElement;
                if (!container.querySelector('.ai-enhance-btn')) {
                    // Create button
                    const aiButton = document.createElement('button');
                    aiButton.className = 'ai-enhance-btn';
                    aiButton.innerHTML = 'Get help with AI assistant';
                    aiButton.onclick = (e) => {
                        e.stopPropagation();
                        openAIEnhancePopup(textarea, aiButton);
                    };
                    container.style.position = 'relative';
                    container.appendChild(aiButton);

                    // Create popup
                    const popup = document.createElement('div');
                    popup.className = 'ai-enhance-popup ai-popup';
                    popup.dataset.textarea = textarea;
                    popup.innerHTML = '<div class="ai-loading">Generating suggestions</div>';
                    container.appendChild(popup);
                }
            });
        }

        // Initialize AI enhancement buttons
        document.addEventListener('DOMContentLoaded', function() {
            addAIEnhanceButtons();
        });

        // Add AI enhancement buttons when new sections are added
        addSection = function() {
            addAIEnhanceButtons();
        };

       
        function getSelectedCategory() {
            const params = new URLSearchParams(window.location.search);
            const template = params.get('template');
            if (!template) return 'relevant';
            // Map template codes to categories
            const lower = template.toLowerCase();
            if (lower.startsWith('it-')) return 'IT';
            if (lower.startsWith('accountant-')) return 'Accountancy';
            if (lower.startsWith('business-') || lower.startsWith('ba-') || lower.startsWith('bsba-') || lower.startsWith('business-admin') || lower.startsWith('business-add')) return 'Business Administrator';
            if (lower.startsWith('cv-') || lower.startsWith('civil-') || lower.startsWith('civil-engineer')) return 'Civil Engineering';
            if (lower.startsWith('generic-') || lower.startsWith('generic')) return 'relevant';
            // Default category
            return 'relevant';
        }

        function getCurrentSection(textarea) {
            // Find the closest section container
            let currentElement = textarea;
            while (currentElement && currentElement !== document.body) {
                if (currentElement.id && currentElement.id.includes('-section')) {
                    const sectionId = currentElement.id;
                    if (sectionId.includes('education')) return 'education';
                    if (sectionId.includes('experience') || sectionId.includes('work')) return 'experience';
                    if (sectionId.includes('skills')) return 'skills';
                    if (sectionId.includes('projects')) return 'projects';
                    if (sectionId.includes('summary') || sectionId.includes('objective')) return 'summary';
                    if (sectionId.includes('certification')) return 'certifications';
                    if (sectionId.includes('achievement')) return 'achievements';
                    if (sectionId.includes('language')) return 'languages';
                    if (sectionId.includes('reference')) return 'references';
                }
                // Check if we're in a project item
                if (currentElement.classList && currentElement.classList.contains('project-item')) {
                    return 'projects';
                }
                currentElement = currentElement.parentElement;
            }
            return 'general';
        }

        function getProjectContext(textarea) {
            // Find the project item containing this textarea
            let currentElement = textarea;
            while (currentElement && currentElement !== document.body) {
                if (currentElement.classList && currentElement.classList.contains('project-item')) {
                    const projectInputs = currentElement.querySelectorAll('input');
                    const projectTitle = projectInputs[0]?.value || '';
                    const projectTech = projectInputs[1]?.value || '';
                    
                    return {
                        title: projectTitle,
                        technologies: projectTech,
                        hasTitle: projectTitle.trim().length > 0,
                        hasTech: projectTech.trim().length > 0
                    };
                }
                currentElement = currentElement.parentElement;
            }
            return { title: '', technologies: '', hasTitle: false, hasTech: false };
        }

        function getProjectSpecificContext(projectTitle, technologies) {
            const title = projectTitle.toLowerCase();
            const tech = technologies.toLowerCase();
            
            // Define project type patterns and their specific contexts
            const projectTypes = {
                'web': {
                    keywords: ['web', 'website', 'frontend', 'backend', 'full-stack', 'react', 'vue', 'angular', 'node', 'express'],
                    context: 'web development project',
                    examples: ['Developed responsive user interface', 'Implemented RESTful API', 'Optimized page load times', 'Integrated third-party services', 'Implemented user authentication']
                },
                'mobile': {
                    keywords: ['mobile', 'app', 'ios', 'android', 'flutter', 'react native', 'swift', 'kotlin'],
                    context: 'mobile application development',
                    examples: ['Built cross-platform mobile app', 'Implemented native features', 'Optimized app performance', 'Integrated push notifications', 'Designed intuitive user interface']
                },
                'ai': {
                    keywords: ['ai', 'machine learning', 'ml', 'neural', 'deep learning', 'tensorflow', 'pytorch', 'nlp', 'computer vision'],
                    context: 'artificial intelligence project',
                    examples: ['Trained machine learning model', 'Implemented data preprocessing pipeline', 'Achieved 95% accuracy', 'Deployed model to production', 'Optimized model performance']
                },
                'data': {
                    keywords: ['data', 'analytics', 'visualization', 'database', 'sql', 'python', 'pandas', 'numpy', 'tableau', 'power bi'],
                    context: 'data analysis project',
                    examples: ['Analyzed large datasets', 'Created interactive dashboards', 'Built predictive models', 'Automated data processing', 'Generated actionable insights']
                },
                'game': {
                    keywords: ['game', 'gaming', 'unity', 'unreal', 'c#', 'c++', 'opengl', 'directx'],
                    context: 'game development project',
                    examples: ['Developed engaging gameplay mechanics', 'Implemented physics engine', 'Created multiplayer functionality', 'Optimized game performance', 'Designed level progression system']
                },
                'ecommerce': {
                    keywords: ['ecommerce', 'e-commerce', 'shop', 'store', 'payment', 'cart', 'checkout', 'stripe', 'paypal'],
                    context: 'e-commerce platform development',
                    examples: ['Built secure payment processing', 'Implemented shopping cart functionality', 'Optimized checkout flow', 'Integrated inventory management', 'Enhanced user experience']
                },
                'iot': {
                    keywords: ['iot', 'internet of things', 'sensor', 'arduino', 'raspberry', 'embedded', 'microcontroller'],
                    context: 'IoT device development',
                    examples: ['Designed sensor integration', 'Implemented real-time data collection', 'Built cloud connectivity', 'Created monitoring dashboard', 'Optimized power consumption']
                },
                'blockchain': {
                    keywords: ['blockchain', 'crypto', 'bitcoin', 'ethereum', 'smart contract', 'solidity', 'web3'],
                    context: 'blockchain development project',
                    examples: ['Developed smart contracts', 'Implemented decentralized features', 'Built secure wallet integration', 'Created token economy', 'Optimized gas efficiency']
                }
            };
            
          
            for (const [type, config] of Object.entries(projectTypes)) {
                const titleMatch = config.keywords.some(keyword => title.includes(keyword));
                const techMatch = config.keywords.some(keyword => tech.includes(keyword));
                
                if (titleMatch || techMatch) {
                    return {
                        type: type,
                        context: config.context,
                        examples: config.examples,
                        isSpecific: true
                    };
                }
            }
            
            // Default project context
            return {
                type: 'general',
                context: 'software development project',
                examples: ['Developed innovative solution', 'Implemented core functionality', 'Optimized system performance', 'Collaborated with team members', 'Delivered on time and within budget'],
                isSpecific: false
            };
        }

        function getSectionContext(section) {
            const contexts = {
                'education': {
                    title: 'Education',
                    description: 'Academic background, degrees, institutions, and academic achievements',
                    examples: ['Bachelor of Science in Computer Science', 'Master of Business Administration', 'GPA: 3.8/4.0', 'Dean\'s List', 'Relevant coursework']
                },
                'experience': {
                    title: 'Work Experience',
                    description: 'Professional work history, job responsibilities, and career achievements',
                    examples: ['Led a team of 5 developers', 'Increased sales by 25%', 'Managed $2M budget', 'Implemented new processes', 'Collaborated with cross-functional teams']
                },
                'skills': {
                    title: 'Listed Skills',
                    description: 'Technical abilities, programming languages, tools, and competencies',
                    examples: ['JavaScript, Python, React', 'Project Management', 'Data Analysis', 'Machine Learning', 'Cloud Computing']
                },
                'projects': {
                    title: 'Projects',
                    description: 'Personal or professional projects, achievements, and technical implementations',
                    examples: ['Built a web application', 'Developed a mobile app', 'Led a team project', 'Implemented new features', 'Optimized performance']
                },
                'summary': {
                    title: 'Professional Summary',
                    description: 'Career overview, key strengths, and professional value proposition',
                    examples: ['Experienced software engineer', 'Passionate about innovation', 'Strong leadership skills', 'Proven track record', 'Results-driven professional']
                },
                'certifications': {
                    title: 'Certifications',
                    description: 'Professional certifications, licenses, and specialized training',
                    examples: ['AWS Certified Solutions Architect', 'PMP Certification', 'Google Analytics Certified', 'Microsoft Azure Fundamentals']
                },
                'achievements': {
                    title: 'Achievements',
                    description: 'Notable accomplishments, awards, and recognitions',
                    examples: ['Employee of the Year', 'Published research paper', 'Won coding competition', 'Led successful project', 'Received industry award']
                },
                'languages': {
                    title: 'Languages',
                    description: 'Language proficiencies and communication skills',
                    examples: ['English (Native)', 'Spanish (Fluent)', 'French (Conversational)', 'Mandarin (Basic)', 'German (Intermediate)']
                },
                'references': {
                    title: 'References',
                    description: 'Professional references and recommendations',
                    examples: ['John Smith, Manager at ABC Corp', 'Dr. Jane Doe, Professor', 'Sarah Johnson, Team Lead', 'Available upon request']
                },
                'general': {
                    title: 'Resume Content',
                    description: 'General resume content and professional information',
                    examples: ['Professional experience', 'Skills and qualifications', 'Educational background', 'Career achievements']
                }
            };
            return contexts[section] || contexts['general'];
        }

        function updateFormForCategory() {
            const category = getSelectedCategory();
            const skillsSection = document.getElementById('skills-section');
            const skillsTitle = document.getElementById('skills-section-title');
            const cat1 = document.getElementById('skill-cat-1');
            const cat2 = document.getElementById('skill-cat-2');
            const cat3 = document.getElementById('skill-cat-3');
            const projectsSection = document.getElementById('projects-section');
            const languagesSection = document.getElementById('languages-section');
            const hobbiesSection = document.getElementById('hobbies-section');

            if (!skillsSection || !skillsTitle || !cat1 || !cat2 || !cat3) return;

            // Reset defaults
            skillsSection.style.display = '';
            projectsSection && (projectsSection.style.display = '');
            languagesSection && (languagesSection.style.display = 'none');
            hobbiesSection && (hobbiesSection.style.display = 'none');
            cat1.style.display = '';
            cat2.style.display = '';
            cat3.style.display = '';
           

            switch (category) {
                case 'IT':
                    // Keep all three skill categories and projects visible
                    projectsSection && (projectsSection.style.display = '');
                    // Show languages and hobbies for IT templates
                    if(templateId === 'it-1'){
                        // it-1 template: hide languages and hobbies
                        languagesSection && (languagesSection.style.display = 'none');
                        hobbiesSection && (hobbiesSection.style.display = 'none');
                    } else {
                        // Other IT templates: show languages and hobbies
                        languagesSection && (languagesSection.style.display = '');
                        hobbiesSection && (hobbiesSection.style.display = '');
                    }
                    hobbiesSection && (hobbiesSection.style.display = 'none');
                    break;
                case 'Business Administrator':
                    skillsTitle.textContent = 'Business Skills';
                    cat1.querySelector('h4').textContent = 'Business & Office Tools';
                    cat2.querySelector('h4').textContent = 'Soft Skills';
                    cat3.querySelector('h4').textContent = 'Accounting/Finance Tools';
                    // Hide projects section for business-oriented templates
                    projectsSection && (projectsSection.style.display = 'none');
                    // Show languages and hobbies for business templates
                    languagesSection && (languagesSection.style.display = '');
                    hobbiesSection && (hobbiesSection.style.display = '');
                    break;
                case 'Accountancy':
                    skillsTitle.textContent = 'Accountancy Skills';
                    cat1.querySelector('h4').textContent = 'Accounting Software';
                    cat2.querySelector('h4').textContent = 'Financial/Analytical Skills';
                    cat3.querySelector('h4').textContent = 'Compliance & Reporting';
                    // Projects often not used; hide
                    projectsSection && (projectsSection.style.display = 'none');
                    // Show languages for accountancy (international business)
                    languagesSection && (languagesSection.style.display = '');
                    // Hide hobbies for professional templates
                    hobbiesSection && (hobbiesSection.style.display = 'none');
                    break;
                case 'Civil Engineering':
                    skillsTitle.textContent = 'Engineering Skills';
                    cat1.querySelector('h4').textContent = 'Design/CAD';
                    cat2.querySelector('h4').textContent = 'Analysis/Tools';
                    cat3.querySelector('h4').textContent = 'Construction/Project Skills';
                    // Keep projects visible (for portfolio projects)
                    projectsSection && (projectsSection.style.display = '');
                    // Show languages for international projects
                    languagesSection && (languagesSection.style.display = '');
                    // Hide hobbies for professional templates
                    hobbiesSection && (hobbiesSection.style.display = 'none');
                    break;
                default: // Generic
                    skillsTitle.textContent = 'Skills';
                    cat1.querySelector('h4').textContent = 'Core Skills';
                    cat2.querySelector('h4').textContent = 'Tools & Methods';
                    cat3.querySelector('h4').textContent = 'Other Skills';
                    projectsSection && (projectsSection.style.display = 'none');
                    // Show both languages and hobbies for generic templates
                    languagesSection && (languagesSection.style.display = '');
                    hobbiesSection && (hobbiesSection.style.display = '');
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            try { 
                updateFormForCategory(); 
                // Also update when template changes
                if (templateId) {
                    updateFormForCategory();
                }
            } catch (e) { console.error(e); }
        });
        
        window.apiConfig = {
            baseURL: 'https://api.resumego.cloud/api',
            getFullURL: function (endpoint) {
                return this.baseURL + endpoint;
            }
        };

        async function askAI(promptText, textarea = null) {
          try {
            const category = getSelectedCategory();
            const section = textarea ? getCurrentSection(textarea) : 'general';
            const sectionContext = getSectionContext(section);
            
            // Get project-specific context if we're in the projects section
            let projectContext = null;
            if (section === 'projects' && textarea) {
              const projectInfo = getProjectContext(textarea);
              if (projectInfo.hasTitle || projectInfo.hasTech) {
                projectContext = getProjectSpecificContext(projectInfo.title, projectInfo.technologies);
              }
            }
            
            // Check if the prompt looks like an incomplete sentence
            const isIncomplete = promptText.trim().length > 0 && 
                                !promptText.trim().endsWith('.') && 
                                !promptText.trim().endsWith('!') && 
                                !promptText.trim().endsWith('?') &&
                                !promptText.trim().endsWith(':') &&
                                !promptText.trim().endsWith(';');
            
            const apiUrl = window.apiConfig ? window.apiConfig.getFullURL('/ai-assistant') : 'http://localhost:3000/api/ai-assistant';
            const response = await fetch(apiUrl, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ 
                promptText, 
                category, 
                section,
                sectionContext,
                projectContext,
                isIncomplete
              })
            });

            if (!response.ok) {
              const text = await response.text();
              console.error('AI API HTTP error:', response.status, text);
              return `Error: ${response.status} - ${text}`;
            }

            // Try to parse JSON
            let data;
            try {
              data = await response.json();
            } catch (e) {
              const text = await response.text();
              console.error('AI API invalid JSON:', text);
              return "Error: Invalid JSON from AI backend.";
            }

            console.log('AI API response:', data);

            // Check for error in response
            if (data.error) {
              // Log the full error object for debugging
              console.error('AI API backend error:', JSON.stringify(data, null, 2));

              let details = data.details;
              if (typeof details === 'object') {
                details = JSON.stringify(details, null, 2);
              }
              if (!details) details = '';
              return `Error: ${data.error}${details ? ' (' + details + ')' : ''}`;
            }

            // Return the AI suggestion
            return data?.choices?.[0]?.message?.content || "No response from AI.";
          } catch (err) {
            console.error('AI API fetch failed:', err);
            return "Error: Could not reach AI backend.";
          }
        }

        async function getAISuggestions(text, textarea = null) {
          try {
            const result = await askAI(text, textarea);
            
            const suggestions = result.split(/\n\n|\n[1-3][).:-]?/).filter(s => s.trim());
            return suggestions.length >= 3 ? suggestions : [result];
          } catch (error) {
            console.error('Error getting AI suggestions:', error);
            return [
              "Professional version: " + text + " (enhanced for impact)",
              "Concise version: " + text + " (clear and direct)",
              "Detailed version: " + text + " (with more context)"
            ];
          }
        }

        async function handleAIAssistant(textarea, popup) {
          // Show loading state
          popup.innerHTML = '<div class="ai-loading">Generating suggestions</div>';

          try {
            const suggestionsText = await getAISuggestions(textarea.value, textarea);

            // If getAISuggestions returns an array, show suggestions
            if (Array.isArray(suggestionsText)) {
              popup.innerHTML = `
                ${suggestionsText.map(text => `
                  <div class="ai-suggestion" data-suggestion="${encodeURIComponent(text)}">
                    ${text}
                  </div>
                `).join('')}
                <button class="regenerate-btn" onclick="regenerateSuggestions('${textarea.value.replace(/'/g, "\\'")}', this.closest('.ai-popup').dataset.textarea)">
                  🔄 Regenerate
                </button>
              `;
              // Attach click handler for each suggestion
              popup.querySelectorAll('.ai-suggestion').forEach(el => {
                el.onclick = function() {
                  applyEnhancement(decodeURIComponent(this.getAttribute('data-suggestion')));
                };
              });
            } else {
              // If it's a string (error or single suggestion), show it
              popup.innerHTML = `<div class="ai-suggestion">${suggestionsText}</div>`;
            }
          } catch (error) {
            console.error('Error in AI assistant:', error);
            popup.innerHTML = `<div class="ai-suggestion">Failed to get suggestions. Please try again.</div>`;
          }
        }

        function openAIEnhancePopup(textarea, button) {
          // Close any open popups
          if (currentPopup) {
            currentPopup.style.display = 'none';
          }

          currentTextarea = textarea;
          currentPopup = button.nextElementSibling;

          // Show popup and start generating
          currentPopup.style.display = 'block';

          // Use the improved handler
          handleAIAssistant(textarea, currentPopup);
        }

        function regenerateSuggestions(text, textarea) {
            const regenerateBtn = currentPopup.querySelector('.regenerate-btn');
            regenerateBtn.classList.add('loading');
            regenerateBtn.innerHTML = '�� Regenerating...';
            getAISuggestions(text, textarea).then(suggestions => {
                currentPopup.innerHTML = `${suggestions.map(text => `
                        <div class="ai-suggestion" data-suggestion="${encodeURIComponent(text)}">
                            ${text}
                        </div>
                    `).join('')}
                    <button class="regenerate-btn" onclick="regenerateSuggestions('${text.replace(/'/g, "\\'")}', this.closest('.ai-popup').dataset.textarea)">
                        🔄 Regenerate
                    </button>
                `;
                // Attach click handler for each suggestion
                currentPopup.querySelectorAll('.ai-suggestion').forEach(el => {
                  el.onclick = function() {
                    applyEnhancement(decodeURIComponent(this.getAttribute('data-suggestion')));
                  };
                });
            });
        }

        function applyEnhancement(text) {
            if (currentTextarea) {
                currentTextarea.value = text;
                currentTextarea.dispatchEvent(new Event('input', { bubbles: true }));
                if (currentPopup) {
                    currentPopup.style.display = 'none';
                }
            }
        }

        // Close popup when clicking outside
        document.addEventListener('click', function(e) {
            if (currentPopup && !currentPopup.contains(e.target) && !e.target.classList.contains('ai-enhance-btn')) {
                currentPopup.style.display = 'none';
            }
        });

        // Function to add dynamic form handlers
        function addDynamicFormHandlers(templateId, selectors) {
            // Profile Image Change
            const profileImageInput = document.getElementById('profileImageInput');
            if (profileImageInput) {
                profileImageInput.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const imgElement = document.querySelector(selectors.profileImage);
                            if (imgElement) {
                                imgElement.src = event.target.result;
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            // Name Change
            const nameInput = document.getElementById('nameInput');
            if (nameInput && selectors.nameElement) {
                nameInput.addEventListener('input', function(e) {
                    const nameElements = document.querySelectorAll(selectors.nameElement);
                    nameElements.forEach(el => {
                        el.textContent = e.target.value || 'Charles Andrew Torres';
                    });
                });
            }
            
            // Title/Position Change
            const titleInput = document.getElementById('titleInput');
            if (titleInput && selectors.titleElement) {
                titleInput.addEventListener('input', function(e) {
                    const titleElements = document.querySelectorAll(selectors.titleElement);
                    titleElements.forEach(el => {
                        el.textContent = e.target.value || 'Accountant';
                    });
                });
            }
            
            // Add more dynamic handlers as needed
            addContactHandlers(templateId);
            addSkillsHandlers(templateId);
            addLanguageHandlers(templateId);
            addExperienceHandlers(templateId);
        }

        function addContactHandlers(templateId) {
            const phoneInput = document.getElementById('phoneInput');
            const emailInput = document.getElementById('emailInput');
            const addressInput = document.getElementById('addressInput');
            
            if (phoneInput) {
                phoneInput.addEventListener('input', function(e) {
                    const phoneElements = document.querySelectorAll(`[data-field="phone"]`);
                    phoneElements.forEach(el => {
                        el.textContent = e.target.value || '+123-456-7890';
                    });
                });
            }
            
            if (emailInput) {
                emailInput.addEventListener('input', function(e) {
                    const emailElements = document.querySelectorAll(`[data-field="email"]`);
                    emailElements.forEach(el => {
                        el.textContent = e.target.value || 'CharlesTorres@gmail.com';
                    });
                });
            }
            
            if (addressInput) {
                addressInput.addEventListener('input', function(e) {
                    const addressElements = document.querySelectorAll(`[data-field="address"]`);
                    addressElements.forEach(el => {
                        el.textContent = e.target.value || '123 Anywhere St., Any City';
                    });
                });
            }
        }

        function addSkillsHandlers(templateId) {
            const skillsContainer = document.getElementById('skillsContainer');
            if (skillsContainer) {
                // Listen for skill changes
                skillsContainer.addEventListener('input', function(e) {
                    if (e.target.matches('.skill-input')) {
                        updateSkillsInPreview();
                    }
                });
                
                // Add/Remove skill buttons
                skillsContainer.addEventListener('click', function(e) {
                    if (e.target.matches('.add-skill-btn')) {
                        addSkillInput();
                    } else if (e.target.matches('.remove-skill-btn')) {
                        removeSkillInput(e.target);
                    }
                });
            }
        }

        function updateSkillsInPreview() {
            const skillInputs = document.querySelectorAll('.skill-input');
            const skills = Array.from(skillInputs).map(input => input.value).filter(skill => skill.trim() !== '');
            
            // Update skills in the preview
            const skillsLists = document.querySelectorAll('[data-field="skills-list"]');
            skillsLists.forEach(list => {
                list.innerHTML = skills.map(skill => `<li>${skill}</li>`).join('');
            });
        }

        function addExperienceHandlers(templateId) {
            // Experience handlers can be added here
            // This function can be extended based on your needs
        }

        function addLanguageHandlers(templateId) {
            const languagesContainer = document.getElementById('languages-container');
            if (languagesContainer) {
                // Listen for language changes
                languagesContainer.addEventListener('input', function(e) {
                    if (e.target.matches('.language-input') || e.target.matches('.proficiency-select')) {
                        updateLanguagesInPreview();
                    }
                });
                
                // Add/Remove language buttons
                languagesContainer.addEventListener('click', function(e) {
                    if (e.target.matches('.add-language-btn')) {
                        addLanguageInput();
                    } else if (e.target.matches('.remove-language-btn')) {
                        removeLanguageInput(e.target);
                    }
                });
            }
        }

        function updateLanguagesInPreview() {
            const languageInputs = document.querySelectorAll('.language-input');
            const proficiencySelects = document.querySelectorAll('.proficiency-select');
            const languages = [];
            
            for (let i = 0; i < languageInputs.length; i++) {
                const language = languageInputs[i].value.trim();
                const proficiency = proficiencySelects[i] ? proficiencySelects[i].value : 'Fluent';
                if (language !== '') {
                    languages.push({ language, proficiency });
                }
            }
            
       
            const languageLists = document.querySelectorAll('[data-field="languages-list"], #languages-preview, .languages-preview');
            languageLists.forEach(list => {
                if (list && list.tagName === 'UL') {
                    list.innerHTML = languages.map(lang => `<li class="flex justify-between"><span>${lang.language} - ${lang.proficiency}</span></li>`).join('');
                } else if (list) {
                    const ulElement = list.querySelector('ul');
                    if (ulElement) {
                        ulElement.innerHTML = languages.map(lang => `<li class="flex justify-between"><span>${lang.language} - ${lang.proficiency}</span></li>`).join('');
                    }
                }
            });
        }

        function updateHobbiesInPreview() {
            const hobbyInputs = document.querySelectorAll('.hobby-input');
            const hobbyDescriptionInputs = document.querySelectorAll('.hobby-description-input');
            const hobbies = [];
            
            for (let i = 0; i < hobbyInputs.length; i++) {
                const hobby = hobbyInputs[i].value.trim();
                const description = hobbyDescriptionInputs[i] ? hobbyDescriptionInputs[i].value.trim() : '';
                if (hobby !== '') {
                    hobbies.push({ hobby, description });
                }
            }
            
            // Update hobbies in the preview - target multiple possible selectors
            const hobbyLists = document.querySelectorAll('[data-field="hobbies-list"], #hobbies-preview, .hobbies-preview, [id*="hobbies"], [class*="hobbies"]');
            hobbyLists.forEach(list => {
                if (list.tagName === 'UL') {
                    // If it's a ul element, update the innerHTML directly
                    list.innerHTML = hobbies.map(hobby => {
                        if (hobby.description) {
                            return `<li class="flex justify-between"><span>${hobby.hobby} - ${hobby.description}</span></li>`;
                        } else {
                            return `<li class="flex justify-between"><span>${hobby.hobby}</span></li>`;
                        }
                    }).join('');
                } else {
                    // If it's a container div, look for ul inside it
                    const ulElement = list.querySelector('ul');
                    if (ulElement) {
                        ulElement.innerHTML = hobbies.map(hobby => {
                            if (hobby.description) {
                                return `<li class="flex justify-between"><span>${hobby.hobby} - ${hobby.description}</span></li>`;
                            } else {
                                return `<li class="flex justify-between"><span>${hobby.hobby}</span></li>`;
                            }
                        }).join('');
                    }
                }
            });

            // Also update any hobby sections in the preview with more specific targeting
            const previewHobbySections = document.querySelectorAll('.hobby-preview, [id*="hobby"], [class*="hobby"]');
            previewHobbySections.forEach(section => {
                const hobbyContent = section.querySelector('ul, .hobby-list, [data-field="hobbies"]');
                if (hobbyContent) {
                    hobbyContent.innerHTML = hobbies.map(hobby => {
                        if (hobby.description) {
                            return `<li class="flex justify-between"><span>${hobby.hobby} - ${hobby.description}</span></li>`;
                        } else {
                            return `<li class="flex justify-between"><span>${hobby.hobby}</span></li>`;
                        }
                    }).join('');
                }
            });

       
        }

        function addLanguageInput() {
            const languagesContainer = document.getElementById('languages-container');
            if (languagesContainer) {
                const languageItem = document.createElement('div');
                languageItem.className = 'language-item';
                languageItem.innerHTML = `
                    <input type="text" class="language-input" placeholder="Enter language">
                    <select class="proficiency-select">
                        <option value="Basic">Basic</option>
                        <option value="Conversational">Conversational</option>
                        <option value="Fluent">Fluent</option>
                        <option value="Native">Native</option>
                    </select>
                    <button type="button" class="remove-language-btn">×</button>
                `;
                languagesContainer.appendChild(languageItem);
            }
        }

        function removeLanguageInput(button) {
            const languageItem = button.closest('.language-item');
            if (languageItem) {
                languageItem.remove();
                updateLanguagesInPreview();
            }
        }

        function addSkillInput() {
            const skillsContainer = document.getElementById('skillsContainer');
            if (skillsContainer) {
                const skillItem = document.createElement('div');
                skillItem.className = 'skill-item';
                skillItem.innerHTML = `
                    <input type="text" class="skill-input" placeholder="Enter skill">
                    <button type="button" class="remove-skill-btn">×</button>
                `;
                skillsContainer.appendChild(skillItem);
            }
        }

        function removeSkillInput(button) {
            const skillItem = button.closest('.skill-item');
            if (skillItem) {
                skillItem.remove();
                updateSkillsInPreview();
            }
        }

        // Example HTML structure for your form
        const formHTML = `
        <div id="dynamicForm" class="form-container">
            <div class="form-group">
                <label for="profileImageInput">Profile Image:</label>
                <input type="file" id="profileImageInput" accept="image/*">
            </div>
            
            <div class="form-group">
                <label for="nameInput">Full Name:</label>
                <input type="text" id="nameInput" placeholder="Charles Andrew Torres">
            </div>
            
            <div class="form-group">
                <label for="titleInput">Job Title:</label>
                <input type="text" id="titleInput" placeholder="Accountant">
            </div>
            
            <div class="form-group">
                <label for="phoneInput">Phone:</label>
                <input type="text" id="phoneInput" placeholder="+123-456-7890">
            </div>
            
            <div class="form-group">
                <label for="emailInput">Email:</label>
                <input type="email" id="emailInput" placeholder="CharlesTorres@gmail.com">
            </div>
            
            <div class="form-group">
                <label for="addressInput">Address:</label>
                <input type="text" id="addressInput" placeholder="123 Anywhere St., Any City">
            </div>
            
            <div class="form-group">
                <label>Skills:</label>
                <div id="skillsContainer">
                    <div class="skill-item">
                        <input type="text" class="skill-input" placeholder="Enter skill">
                        <button type="button" class="add-skill-btn">+</button>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>Languages:</label>
                <div id="languagesContainer">
                    <div class="language-item">
                        <input type="text" class="language-input" placeholder="Enter language">
                        <select class="proficiency-select">
                            <option value="Basic">Basic</option>
                            <option value="Conversational">Conversational</option>
                            <option value="Fluent">Fluent</option>
                            <option value="Native">Native</option>
                        </select>
                        <button type="button" class="add-language-btn">+</button>
                    </div>
                </div>
            </div>
        </div>
        `;
    </script>
    <script>
// --- Suit Overlay Logic for Modal ---
    let originalModalImage = null;
    let selectedSuitSrc = '/assets/img/suit-overlay/suit-overlay-1.png'; // Default suit

    // Track selected suit
    function selectSuit(element) {
        document.querySelectorAll('.suit-option').forEach(opt => {
            opt.style.borderColor = 'transparent';
        });
        element.style.borderColor = '#3b82f6';
        selectedSuitSrc = element.querySelector('img').src;
        updateSuitOverlayPreview();
    }

    // When suit overlay checkbox is toggled
    const suitOverlayCheckbox = document.getElementById('suitOverlayCheckbox');
    if (suitOverlayCheckbox) {
        suitOverlayCheckbox.addEventListener('change', updateSuitOverlayPreview);
    }

    // When image changes in modal
    const previewImage = document.getElementById('previewImage');
    if (previewImage) {
        previewImage.addEventListener('load', function() {
            if (!suitOverlayCheckbox || !suitOverlayCheckbox.checked) {
                originalModalImage = previewImage.src;
            }
            updateSuitOverlayPreview();
        });
    }

    // When suit is selected
    const suitOptions = document.querySelectorAll('.suit-option');
    suitOptions.forEach(opt => {
        opt.addEventListener('click', function() {
            selectSuit(this);
        });
    });

    // Main function to update the preview with or without suit overlay
    async function updateSuitOverlayPreview() {
        if (!previewImage) return;
        if (!suitOverlayCheckbox || !suitOverlayCheckbox.checked) {
            // Show original image
            if (originalModalImage) previewImage.src = originalModalImage;
            return;
        }
        // Draw on a canvas
        const img = new window.Image();
        img.crossOrigin = 'anonymous';
        img.src = originalModalImage;
        img.onload = async function() {
            const canvas = document.createElement('canvas');
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            // Load suit image
            const suitImg = new window.Image();
            suitImg.crossOrigin = 'anonymous';
            suitImg.src = selectedSuitSrc;
            suitImg.onload = function() {
                // Draw suit at bottom center, scale to width
                const suitWidth = canvas.width * 0.8;
                const suitHeight = suitImg.height * (suitWidth / suitImg.width);
                const x = (canvas.width - suitWidth) / 2;
                const y = canvas.height - suitHeight;
                ctx.drawImage(suitImg, x, y, suitWidth, suitHeight);
                previewImage.src = canvas.toDataURL('image/png');
            };
        };
    }
</script>

<script>
// --- Grammar Checker Logic using TextGears API ---


class GrammarChecker {
    constructor(textarea) {
        this.textarea = textarea;
        this.container = document.createElement('div');
        this.container.className = 'grammar-checker-container';
        this.container.innerHTML = `
            <div class="grammar-checker-title">
                <span class="grammar-checker-icon">!</span>
                Grammar Check
            </div>
            <ul class="grammar-checker-list"></ul>
        `;
        this.list = this.container.querySelector('.grammar-checker-list');
        textarea.parentElement.appendChild(this.container);
        this.debounceTimer = null;
        this.textarea.addEventListener('input', () => this.debouncedCheckGrammar());
        this.textarea.addEventListener('paste', () => setTimeout(() => this.debouncedCheckGrammar(), 10));
        this.checkGrammar();
    }
    debouncedCheckGrammar() {
        clearTimeout(this.debounceTimer);
        this.showLoading();
        this.debounceTimer = setTimeout(() => this.checkGrammar(), 600);
    }
    async checkGrammar() {
        const text = this.textarea.value;
        if (!text.trim()) {
            this.list.innerHTML = `
                <li class="grammar-checker-no-errors">
                    <span class="grammar-checker-success-icon">✓</span>
                    No grammar issues found.
                </li>
            `;
            return;
        }
        this.showLoading();
        try {
            const API_URL = window.apiConfig.baseURL; 
            // Use full backend URL for grammar check to support dev servers on different ports
            const response = await fetch(`${API_URL}/grammar-check`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text })
            });
            const data = await response.json();
            if (!data || !data.response || !data.response.errors || data.response.errors.length === 0) {
                this.list.innerHTML = `
                    <li class="grammar-checker-no-errors">
                        <span class="grammar-checker-success-icon">✓</span>
                        No grammar issues found.
                    </li>
                `;
                return;
            }
            const errors = data.response.errors;
            this.displayErrors(errors);
        } catch (err) {
            this.list.innerHTML = `<li class='grammar-checker-item'><span class='grammar-checker-type' style='background:#e74c3c'>Error</span><span class='grammar-checker-message'>Failed to check grammar. Please try again.</span></li>`;
        }
    }
    showLoading() {
        this.list.innerHTML = `<li class='grammar-checker-item'><span class='grammar-checker-message'>Checking grammar...</span></li>`;
    }
    displayErrors(errors) {
        const severityColor = {
            'error': '#e74c3c',
            'warning': '#f39c12',
            'suggestion': '#3498db'
        };
        this.list.innerHTML = errors.map(error => {
            const color = severityColor[error.type] || '#e74c3c';
            // Ensure all fields are strings
            let description = '';
            if (typeof error.description === 'string') {
                description = error.description;
            } else if (typeof error.message === 'string') {
                description = error.message;
            } else if (error.type) {
                description = error.type + (error.offset !== undefined ? ` (at ${error.offset})` : '');
            } else {
                description = 'Grammar issue';
            }
            let bad = '';
            if (typeof error.bad === 'string') {
                bad = error.bad;
            } else if (Array.isArray(error.bad)) {
                bad = error.bad.join(', ');
            } else if (error.bad) {
                bad = String(error.bad);
            }
            let suggestions = '';
            if (Array.isArray(error.better)) {
                suggestions = error.better.length > 0 ? `<br><small style=\"color:#2563eb;\">Suggestion: ${error.better.join(', ')}</small>` : '';
            } else if (Array.isArray(error.suggestions)) {
                suggestions = error.suggestions.length > 0 ? `<br><small style=\"color:#2563eb;\">Suggestion: ${error.suggestions.join(', ')}</small>` : '';
            }
            return `
                <li class="grammar-checker-item">
                    <span class="grammar-checker-type" style="background:${color}">${error.type || 'error'}</span>
                    <span class="grammar-checker-message">
                        ${description}
                        ${bad ? `<br><small style=\"color:#666;\">Found: \"${bad}\"</small>` : ''}
                        ${suggestions}
                    </span>
                </li>
            `;
        }).join('');
    }
}
// Function to attach grammar checker to a textarea
function attachGrammarCheckerTo(el) {
    if (el && !el._hasGrammarChecker) {
        new GrammarChecker(el);
        el._hasGrammarChecker = true;
    }
}

// Initial attach for existing textareas
document.querySelectorAll('textarea').forEach(attachGrammarCheckerTo);

// Observe DOM for new textareas
const observer = new MutationObserver(mutations => {
    mutations.forEach(mutation => {
        mutation.addedNodes.forEach(node => {
            if (node.nodeType === 1) { // element
                if (node.matches('textarea')) {
                    attachGrammarCheckerTo(node);
                }
                // If a container with textarea inside was added
                node.querySelectorAll?.('textarea').forEach(attachGrammarCheckerTo);
            }
        });
    });
});

observer.observe(document.body, { childList: true, subtree: true });
</script>
<script src="js/config.js"></script>

</body>
</html>
